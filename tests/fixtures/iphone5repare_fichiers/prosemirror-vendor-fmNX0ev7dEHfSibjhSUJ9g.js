/*
 File: prosemirror-vendor.js */
(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{118:function(e,p,B){function M(e,p){var z={},x;for(x in e)z[x]=e[x];for(var q in p)z[q]=p[q];return z}Object.defineProperty(p,"__esModule",{value:!0});var T=B(119),G=B(38),U={attrs:{order:{default:1}},parseDOM:[{tag:"ol",getAttrs:function(e){return{order:e.hasAttribute("start")?+e.getAttribute("start"):1}}}],toDOM:function(e){return["ol",{start:1==e.attrs.order?null:e.attrs.order},0]}},aa={parseDOM:[{tag:"ul"}],toDOM:function(){return["ul",
0]}},ba={parseDOM:[{tag:"li"}],toDOM:function(){return["li",0]},defining:!0};p.orderedList=U;p.bulletList=aa;p.listItem=ba;p.addListNodes=function(e,p,B){return e.append({ordered_list:M(U,{content:"list_item+",group:B}),bullet_list:M(aa,{content:"list_item+",group:B}),list_item:M(ba,{content:p})})};p.wrapInList=function(e,p){return function(z,x){var q=z.selection,v=q.$from,Q=q.$to;q=v.blockRange(Q);var A=!1,C=q;if(!q)return!1;if(2<=q.depth&&v.node(q.depth-1).type.compatibleContent(e)&&0==q.startIndex){if(0==
v.index(q.depth-1))return!1;A=z.doc.resolve(q.start-2);C=new G.NodeRange(A,A,q.depth);q.endIndex<q.parent.childCount&&(q=new G.NodeRange(v,z.doc.resolve(Q.end(q.depth)),q.depth));A=!0}v=T.findWrapping(C,e,p,q);if(Q=!!v){if(x){z=z.tr;Q=A;A=G.Fragment.empty;for(C=v.length-1;0<=C;C--)A=G.Fragment.from(v[C].type.create(v[C].attrs,A));z.step(new T.ReplaceAroundStep(q.start-(Q?2:0),q.end,q.start,q.end,new G.Slice(A,0,0),v.length,!0));for(C=A=0;C<v.length;C++)v[C].type==e&&(A=C+1);A=v.length-A;v=q.start+
v.length-(Q?2:0);Q=q.parent;C=q.startIndex;q=q.endIndex;for(var ja=!0;C<q;C++,ja=!1)!ja&&T.canSplit(z.doc,v,A)&&z.split(v,A),v+=Q.child(C).nodeSize+(ja?0:2*A);x(z.scrollIntoView())}Q=!0}return Q}};p.splitListItem=function(e){return function(p,z){var x=p.selection,q=x.$from,v=x.$to;if((x=x.node)&&x.isBlock||2>q.depth||!q.sameParent(v))return!1;x=q.node(-1);if(x.type!=e)return!1;if(0==q.parent.content.size){if(2==q.depth||q.node(-3).type!=e||q.index(-2)!=q.node(-2).childCount-1)return!1;if(z){x=G.Fragment.empty;
v=0<q.index(-1);for(var Q=q.depth-(v?1:2);Q>=q.depth-3;Q--)x=G.Fragment.from(q.node(Q).copy(x));x=x.append(G.Fragment.from(e.createAndFill()));x=p.tr.replace(q.before(v?null:-1),q.after(-3),new G.Slice(x,v?3:2,2));x.setSelection(p.selection.constructor.near(x.doc.resolve(q.pos+(v?3:2))));z(x.scrollIntoView())}return!0}x=v.pos==q.end()?x.defaultContentType(0):null;p=p.tr.delete(q.pos,v.pos);v=x&&[null,{type:x}];return!!T.canSplit(p.doc,q.pos,2,v)&&(z&&z(p.split(q.pos,2,v).scrollIntoView()),!0)}};p.liftListItem=
function(e){return function(p,z){var x=p.selection,q=x.$from;x=q.blockRange(x.$to,function(v){return v.childCount&&v.firstChild.type==e});return!!x&&(!z||(q.node(x.depth-1).type==e?function(e,p,q,C){e=e.tr;var v=C.end,y=C.$to.end(C.depth);return v<y&&(e.step(new T.ReplaceAroundStep(v-1,y,v,y,new G.Slice(G.Fragment.from(q.create(null,C.parent.copy())),1,0),1,!0)),C=new G.NodeRange(e.doc.resolveNoCache(C.$from.pos),e.doc.resolveNoCache(y),C.depth)),p(e.lift(C,T.liftTarget(C)).scrollIntoView()),!0}(p,
z,e,x):function(e,p,q){e=e.tr;for(var C=q.parent,v=q.end,y=q.endIndex-1,x=q.startIndex;y>x;y--)v-=C.child(y).nodeSize,e.delete(v-1,v+1);x=e.doc.resolve(q.start);y=x.nodeAfter;v=0==q.startIndex;q=q.endIndex==C.childCount;var A=x.node(-1),z=x.index(-1);if(!A.canReplace(z+(v?0:1),z+1,y.content.append(q?G.Fragment.empty:G.Fragment.from(C))))return!1;x=x.pos;y=x+y.nodeSize;return e.step(new T.ReplaceAroundStep(x-(v?1:0),y+(q?1:0),x+1,y-1,new G.Slice((v?G.Fragment.empty:G.Fragment.from(C.copy(G.Fragment.empty))).append(q?
G.Fragment.empty:G.Fragment.from(C.copy(G.Fragment.empty))),v?0:1,q?0:1),v?0:1)),p(e.scrollIntoView()),!0}(p,z,x)))}};p.sinkListItem=function(e){return function(p,z){var x=p.selection;x=x.$from.blockRange(x.$to,function(v){return v.childCount&&v.firstChild.type==e});if(!x)return!1;var q=x.startIndex;if(0==q)return!1;var v=x.parent;q=v.child(q-1);if(q.type!=e)return!1;if(z){q=q.lastChild&&q.lastChild.type==v.type;var Q=G.Fragment.from(q?e.create():null);v=new G.Slice(G.Fragment.from(e.create(null,
G.Fragment.from(v.copy(Q)))),q?3:1,0);Q=x.start;x=x.end;z(p.tr.step(new T.ReplaceAroundStep(Q-(q?3:1),x,Q,x,v,1,!0)).scrollIntoView())}return!0}}},119:function(e,p,B){function M(b){b=Error.call(this,b);return b.__proto__=M.prototype,b}function T(){throw Error("Override me");}function G(b,f,d){b=b.resolve(f);f=d-f;for(d=b.depth;0<f&&0<d&&b.indexAfter(d)==b.node(d).childCount;)d--,f--;if(0<f)for(b=b.node(d).maybeChild(b.indexAfter(d));0<f;){if(!b||b.isLeaf)return!0;b=b.firstChild;f--}return!1}function U(b){return{type:b,
attrs:null}}function aa(b,f,d){b=b.resolve(f);if(b.parent.canReplaceWith(b.index(),b.index(),d))return f;if(0==b.parentOffset)for(f=b.depth-1;0<=f;f--){var t=b.index(f);if(b.node(f).canReplaceWith(t,t,d))return b.before(f+1);if(0<t)return null}if(b.parentOffset==b.parent.content.size)for(f=b.depth-1;0<=f;f--){t=b.indexAfter(f);if(b.node(f).canReplaceWith(t,t,d))return b.after(f+1);if(t<b.node(f).childCount)return null}}function ba(b,f,d){for(var t=[],g=0;g<b.childCount;g++){var h=b.child(g);h.content.size&&
(h=h.copy(ba(h.content,f,h)));h.isInline&&(h=f(h,d,g));t.push(h)}return y.Fragment.fromArray(t)}function z(b,f,d,g){if(void 0===d&&(d=f),void 0===g&&(g=y.Slice.empty),f==d&&!g.size)return null;var t=b.resolve(f),E=b.resolve(d);if(x(t,E,g))return new r(f,d,g);g=function(b,f){var d=[];if(!f.content.size)return d;for(var t=f.openStart,g=b.depth+1,E=b.depth,h=1;0<=E&&0<=t;E--)if(0!=E||1!=h){var l=b.node(E),I=l.contentMatchAt(b.indexAfter(E)),r=d[E],u=r?r.content:y.Fragment.empty;r=r?r.openEnd:0;for(var e=
t;0<=e;e--){var ka=Q(f.content,e,t==f.openStart?null:t+1);if(1==h){var la=I.fillBefore(ka),F;if(F=!la)a:{F=ka;for(var a=0;a<F.childCount;a++)if(F.child(a).marks.length){F=!0;break a}F=!1}if(F){a:{F=l.type;a=I;for(var c=ka,n=[],K=0;K<c.childCount;K++){var Ha=c.child(K);if(!(a=a.matchType(Ha.type))){F=null;break a}n.push(Ha.mark(F.allowedMarks(Ha.marks)))}F=y.Fragment.from(n)}F&&(ka=F,la=y.Fragment.empty)}if(la&&(ka=la.append(A(ka,t-e)),u=u.append(ka),ka.size&&(r=v(f,e)?f.openEnd-e:0),t=e-1,g=E,q(f.content,
e).type==l.type))break}else if(0!=ka.size&&(la=I.findWrapping(ka.firstChild.type))){F=v(f,e);if(la.length){if(e&&la[la.length-1]==q(f.content,e).type)continue;if(!F){a=la[la.length-1].contentMatch.matchFragment(ka);if(!a)continue;ka=ka.append(a.fillBefore(y.Fragment.empty,!0))}}else if(!I.matchFragment(ka))continue;ka=A(ka,t-e);for(t=la.length-1;0<=t;t--)ka=y.Fragment.from(la[t].create(null,ka));u=u.append(ka);ka.size&&(r=F?la.length+f.openEnd:0);t=e-1}}u.size&&(d[E]={content:u,openEnd:r,depth:E})}else E=
g,h=2;return d}(t,g);g=function(b,f){f=function ra(b,f,d,t){var g=y.Fragment.empty,E=0,h=d[f];b.depth>f&&(d=ra(b,f+1,d,t||h),E=d.openEnd+1,g=y.Fragment.from(b.node(f+1).copy(d.content)));h&&(g=g.append(h.content),E=h.openEnd);t&&(g=g.append(b.node(f).contentMatchAt(b.indexAfter(f)).fillBefore(y.Fragment.empty,!0)),E=0);return{content:g,openEnd:E}}(b,0,f,!1);return new y.Slice(f.content,b.depth,f.openEnd||0)}(t,g);var h=P(t,E,g);if(!h)return null;if(g.size!=h.size&&function(b,f,d){if(!f.parent.isTextblock)return!1;
if(d.openEnd){b=d.content;for(var t=1;t<d.openEnd;t++)b=b.lastChild.content;d=b.lastChild;if(!d.isTextblock)return!1;b=d.contentMatchAt(d.childCount)}else{b=b.node(b.depth-(d.openStart-d.openEnd));if(!b.isTextblock)return!1;b=b.contentMatchAt(b.childCount);d.size&&(b=b.matchFragment(d.content,d.openStart?1:0))}return(b=b.matchFragment(f.parent.content,f.index()))&&b.validEnd}(t,E,g)){for(var l=E.depth,e=E.after(l);1<l&&e==E.end(--l);)++e;if(b=P(t,b.resolve(e),g))return new u(f,e,d,E.end(),b,g.size)}return new r(f,
d,h)}function Y(b,f,d,g,h,l,r){var t=b.childCount;var E=t-(0<r?1:0);E=0>l?f.contentMatchAt(E):1==t&&0<r?d.node(h).contentMatchAt(l?d.index(h):d.indexAfter(h)):d.node(h).contentMatchAt(d.indexAfter(h)).matchFragment(b,0<t&&l?1:0,E);var I=g.node(h);if(0<r&&h<g.depth){var u=I.content.cutByIndex(g.indexAfter(h)).addToStart(b.lastChild);u=E.fillBefore(u,!0);if(u&&u.size&&0<l&&1==t&&(u=null),u){var e=Y(b.lastChild.content,b.lastChild,d,g,h+1,1==t?l-1:-1,r-1);if(e)return g=b.lastChild.copy(e),u.size?b.cutByIndex(0,
t-1).append(u).addToEnd(g):b.replaceChild(t-1,g)}}0<r&&(E=E.matchType((1==t&&0<l?d.node(h+1):b.lastChild).type));u=g.index(h);if(u==I.childCount&&!I.type.compatibleContent(f.type))return null;f=E.fillBefore(I.content,!0,u);if(!f)return null;0<r&&(d=function xa(b,f,d,t,g){var E=b.content,h=E.childCount;var l=0<=g?d.node(t).contentMatchAt(d.indexAfter(t)).matchFragment(E,0<g?1:0,h):b.contentMatchAt(h);0<f&&(f=xa(E.lastChild,f-1,d,t+1,1==h?g-1:-1),E=E.replaceChild(h-1,f));return b.copy(E.append(l.fillBefore(y.Fragment.empty,
!0)))}(b.lastChild,r-1,d,h+1,1==t?l-1:-1),b=b.replaceChild(t-1,d));return b=b.append(f),g.depth>h&&(b=b.addToEnd(function La(b,f){var d=b.node(f),t=d.contentMatchAt(0).fillBefore(d.content,!0,b.index(f));b.depth>f&&(t=t.addToEnd(La(b,f+1)));return d.copy(t)}(g,h+1))),b}function P(b,f,d){if(b=Y(d.content,b.node(0),b,f,0,d.openStart,d.openEnd)){d=d.openStart;for(f=f.depth;0<d&&0<f&&1==b.childCount;)b=b.firstChild.content,d--,f--;f=new y.Slice(b,d,f)}else f=null;return f}function x(b,f,d){return!d.openStart&&
!d.openEnd&&b.start()==f.start()&&b.parent.canReplace(b.index(),f.index(),d.content)}function q(b,f){for(var d=1;d<f;d++)b=b.firstChild.content;return b.firstChild}function v(b,f){var d=0;for(b=b.content;d<f;d++){if(1<b.childCount)return!1;b=b.firstChild.content}return!0}function Q(b,f,d){for(var t=0;t<f;t++)b=b.firstChild.content;return null!=d&&(b=function Ua(b,f){if(1==f)return b.cutByIndex(1,b.childCount);var d=b.firstChild;return b.replaceChild(0,d.copy(Ua(d.content,f-1)))}(b,d-f)),b}function A(b,
f){if(0==f)return b;var d=b.firstChild;f=A(d.content,f-1);if(!f.size)return b.cutByIndex(1,b.childCount);var g=d.type.contentMatch.fillBefore(f);return b.replaceChild(0,d.copy(g.append(f)))}function C(b,f,d,g,h){if(f<d){var t=b.firstChild;b=b.replaceChild(0,t.copy(C(t.content,f+1,d,g,t)))}return f>g&&(b=h.contentMatchAt(0).fillBefore(b).append(b)),b}function ja(b,f){for(var d=[],g=Math.min(b.depth,f.depth);0<=g;g--){var h=b.start(g);if(h<b.pos-(b.depth-g)||f.end(g)>f.pos+(f.depth-g)||b.node(g).type.spec.isolating||
f.node(g).type.spec.isolating)break;h==f.start(g)&&d.push(g)}return d}Object.defineProperty(p,"__esModule",{value:!0});var y=B(38),Z=Math.pow(2,16),O=function(b,f,d){void 0===f&&(f=!1);void 0===d&&(d=null);this.pos=b;this.deleted=f;this.recover=d},N=function(b,f){void 0===f&&(f=!1);this.ranges=b;this.inverted=f};N.prototype.recover=function(b){var f=0,d=b&65535;if(!this.inverted)for(var g=0;g<d;g++)f+=this.ranges[3*g+2]-this.ranges[3*g+1];return this.ranges[3*d]+f+(b-(b&65535))/Z};N.prototype.mapResult=
function(b,f){return void 0===f&&(f=1),this._map(b,f,!1)};N.prototype.map=function(b,f){return void 0===f&&(f=1),this._map(b,f,!0)};N.prototype._map=function(b,f,d){for(var t=0,g=this.inverted?2:1,h=this.inverted?1:2,l=0;l<this.ranges.length;l+=3){var r=this.ranges[l]-(this.inverted?t:0);if(r>b)break;var u=this.ranges[l+g],e=this.ranges[l+h],F=r+u;if(b<=F)return t=r+t+(0>(u?b==r?-1:b==F?1:f:f)?0:e),d?t:new O(t,0>f?b!=r:b!=F,l/3+(b-r)*Z);t+=e-u}return d?b+t:new O(b+t)};N.prototype.touches=function(b,
f){var d=0;f&=65535;for(var g=this.inverted?2:1,h=this.inverted?1:2,l=0;l<this.ranges.length;l+=3){var r=this.ranges[l]-(this.inverted?d:0);if(r>b)break;var u=this.ranges[l+g];if(b<=r+u&&l==3*f)return!0;d+=this.ranges[l+h]-u}return!1};N.prototype.forEach=function(b){for(var f=this.inverted?2:1,d=this.inverted?1:2,g=0,h=0;g<this.ranges.length;g+=3){var l=this.ranges[g],r=l-(this.inverted?h:0);l+=this.inverted?0:h;var u=this.ranges[g+f],e=this.ranges[g+d];b(r,r+u,l,l+e);h+=e-u}};N.prototype.invert=
function(){return new N(this.ranges,!this.inverted)};N.prototype.toString=function(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)};N.offset=function(b){return 0==b?N.empty:new N(0>b?[0,-b,0]:[0,0,b])};N.empty=new N([]);var F=function(b,f,d,g){this.maps=b||[];this.from=d||0;this.to=null==g?this.maps.length:g;this.mirror=f};F.prototype.slice=function(b,f){return void 0===b&&(b=0),void 0===f&&(f=this.maps.length),new F(this.maps,this.mirror,b,f)};F.prototype.copy=function(){return new F(this.maps.slice(),
this.mirror&&this.mirror.slice(),this.from,this.to)};F.prototype.getMirror=function(b){if(this.mirror)for(var f=0;f<this.mirror.length;f++)if(this.mirror[f]==b)return this.mirror[f+(f%2?-1:1)]};F.prototype.setMirror=function(b,f){this.mirror||(this.mirror=[]);this.mirror.push(b,f)};F.prototype.appendMap=function(b,f){this.to=this.maps.push(b);null!=f&&this.setMirror(this.maps.length-1,f)};F.prototype.appendMapping=function(b){for(var f=0,d=this.maps.length;f<b.maps.length;f++){var g=b.getMirror(f);
this.appendMap(b.maps[f],null!=g&&g<f?d+g:null)}};F.prototype.appendMappingInverted=function(b){for(var d=b.maps.length-1,t=this.maps.length+b.maps.length;0<=d;d--){var g=b.getMirror(d);this.appendMap(b.maps[d].invert(),null!=g&&g>d?t-g-1:null)}};F.prototype.invert=function(){var b=new F;return b.appendMappingInverted(this),b};F.prototype.map=function(b,d){if(void 0===d&&(d=1),this.mirror)return this._map(b,d,!0);for(var f=this.from;f<this.to;f++)b=this.maps[f].map(b,d);return b};F.prototype.mapResult=
function(b,d){return void 0===d&&(d=1),this._map(b,d,!1)};F.prototype._map=function(b,d,t){for(var f=!1,g=null,h=this.from;h<this.to;h++){var l=this.maps[h],r=g&&g[h];if(null!=r&&l.touches(b,r))b=l.recover(r);else{b=l.mapResult(b,d);if(null!=b.recover&&(l=this.getMirror(h),null!=l&&l>h&&l<this.to)){if(b.deleted){h=l;b=this.maps[l].recover(b.recover);continue}(g||(g=Object.create(null)))[l]=b.recover}b.deleted&&(f=!0);b=b.pos}}return t?b:new O(b,f)};M.prototype=Object.create(Error.prototype);M.prototype.constructor=
M;M.prototype.name="TransformError";e=function(b){this.doc=b;this.steps=[];this.docs=[];this.mapping=new F};B={before:{},docChanged:{}};B.before.get=function(){return this.docs.length?this.docs[0]:this.doc};e.prototype.step=function(b){b=this.maybeStep(b);if(b.failed)throw new M(b.failed);return this};e.prototype.maybeStep=function(b){var d=b.apply(this.doc);return d.failed||this.addStep(b,d.doc),d};B.docChanged.get=function(){return 0<this.steps.length};e.prototype.addStep=function(b,d){this.docs.push(this.doc);
this.steps.push(b);this.mapping.appendMap(b.getMap());this.doc=d};Object.defineProperties(e.prototype,B);var l=Object.create(null);B=function(){};B.prototype.apply=function(b){return T()};B.prototype.getMap=function(){return N.empty};B.prototype.invert=function(b){return T()};B.prototype.map=function(b){return T()};B.prototype.merge=function(b){return null};B.prototype.toJSON=function(){return T()};B.fromJSON=function(b,d){return l[d.stepType].fromJSON(b,d)};B.jsonID=function(b,d){if(b in l)throw new RangeError("Duplicate use of step JSON ID "+
b);return l[b]=d,d.prototype.jsonID=b,d};var h=function(b,d){this.doc=b;this.failed=d};h.ok=function(b){return new h(b,null)};h.fail=function(b){return new h(null,b)};h.fromReplace=function(b,d,g,l){try{return h.ok(b.replace(d,g,l))}catch(I){if(I instanceof y.ReplaceError)return h.fail(I.message);throw I;}};var r=function(b){function d(d,f,g,h){b.call(this);this.from=d;this.to=f;this.slice=g;this.structure=!!h}return b&&(d.__proto__=b),d.prototype=Object.create(b&&b.prototype),d.prototype.constructor=
d,d.prototype.apply=function(b){return this.structure&&G(b,this.from,this.to)?h.fail("Structure replace would overwrite content"):h.fromReplace(b,this.from,this.to,this.slice)},d.prototype.getMap=function(){return new N([this.from,this.to-this.from,this.slice.size])},d.prototype.invert=function(b){return new d(this.from,this.from+this.slice.size,b.slice(this.from,this.to))},d.prototype.map=function(b){var f=b.mapResult(this.from,1);b=b.mapResult(this.to,-1);return f.deleted&&b.deleted?null:new d(f.pos,
Math.max(f.pos,b.pos),this.slice)},d.prototype.merge=function(b){if(!(b instanceof d)||b.structure!=this.structure)return null;if(this.from+this.slice.size!=b.from||this.slice.openEnd||b.slice.openStart){if(b.to!=this.from||this.slice.openStart||b.slice.openEnd)return null;var f=0==this.slice.size+b.slice.size?y.Slice.empty:new y.Slice(b.slice.content.append(this.slice.content),b.slice.openStart,this.slice.openEnd);return new d(b.from,this.to,f,this.structure)}f=0==this.slice.size+b.slice.size?y.Slice.empty:
new y.Slice(this.slice.content.append(b.slice.content),this.slice.openStart,b.slice.openEnd);return new d(this.from,this.to+(b.to-b.from),f,this.structure)},d.prototype.toJSON=function(){var b={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(b.slice=this.slice.toJSON()),this.structure&&(b.structure=!0),b},d.fromJSON=function(b,f){return new d(f.from,f.to,y.Slice.fromJSON(b,f.slice),!!f.structure)},d}(B);B.jsonID("replace",r);var u=function(b){function d(d,f,g,h,l,r,u){b.call(this);
this.from=d;this.to=f;this.gapFrom=g;this.gapTo=h;this.slice=l;this.insert=r;this.structure=!!u}return b&&(d.__proto__=b),d.prototype=Object.create(b&&b.prototype),d.prototype.constructor=d,d.prototype.apply=function(b){if(this.structure&&(G(b,this.from,this.gapFrom)||G(b,this.gapTo,this.to)))return h.fail("Structure gap-replace would overwrite content");var d=b.slice(this.gapFrom,this.gapTo);return d.openStart||d.openEnd?h.fail("Gap is not a flat range"):(d=this.slice.insertAt(this.insert,d.content))?
h.fromReplace(b,this.from,this.to,d):h.fail("Content does not fit in gap")},d.prototype.getMap=function(){return new N([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])},d.prototype.invert=function(b){var f=this.gapTo-this.gapFrom;return new d(this.from,this.from+this.slice.size+f,this.from+this.insert,this.from+this.insert+f,b.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)},
d.prototype.map=function(b){var f=b.mapResult(this.from,1),g=b.mapResult(this.to,-1),t=b.map(this.gapFrom,-1);b=b.map(this.gapTo,1);return f.deleted&&g.deleted||t<f.pos||b>g.pos?null:new d(f.pos,g.pos,t,b,this.slice,this.insert,this.structure)},d.prototype.toJSON=function(){var b={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(b.slice=this.slice.toJSON()),this.structure&&(b.structure=!0),b},d.fromJSON=function(b,
f){return new d(f.from,f.to,f.gapFrom,f.gapTo,y.Slice.fromJSON(b,f.slice),f.insert,!!f.structure)},d}(B);B.jsonID("replaceAround",u);e.prototype.lift=function(b,d){var f=b.$from,g=b.$to,h=b.depth;b=f.before(h+1);for(var l=g.after(h+1),r=b,e=l,F=y.Fragment.empty,v=0,C=h,q=!1;C>d;C--)q||0<f.index(C)?(q=!0,F=y.Fragment.from(f.node(C).copy(F)),v++):r--;f=y.Fragment.empty;C=0;for(q=!1;h>d;h--)q||g.after(h+1)<g.end(h)?(q=!0,f=y.Fragment.from(g.node(h).copy(f)),C++):e++;return this.step(new u(r,e,b,l,new y.Slice(F.append(f),
v,C),F.size-v,!0))};e.prototype.wrap=function(b,d){for(var f=y.Fragment.empty,g=d.length-1;0<=g;g--)f=y.Fragment.from(d[g].type.create(d[g].attrs,f));g=b.start;b=b.end;return this.step(new u(g,b,g,b,new y.Slice(f,0,0),d.length,!0))};e.prototype.setBlockType=function(b,d,g,h){var f=this;if(void 0===d&&(d=b),!g.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var t=this.steps.length;return this.doc.nodesBetween(b,d,function(b,d){var l;if(l=b.isTextblock&&!b.hasMarkup(g,
h)){l=f.mapping.slice(t).map(d);l=f.doc.resolve(l);var E=l.index();l=l.parent.canReplaceWith(E,E+1,g)}if(l)return f.clearIncompatible(f.mapping.slice(t).map(d,1),g),E=f.mapping.slice(t),l=E.map(d,1),b=E.map(d+b.nodeSize,1),f.step(new u(l,b,l+1,b-1,new y.Slice(y.Fragment.from(g.create(h)),0,0),1,!0)),!1}),this};e.prototype.setNodeMarkup=function(b,d,g,h){var f=this.doc.nodeAt(b);if(!f)throw new RangeError("No node at given position");d||(d=f.type);g=d.create(g,null,h||f.marks);if(f.isLeaf)return this.replaceWith(b,
b+f.nodeSize,g);if(!d.validContent(f.content))throw new RangeError("Invalid content for node type "+d.name);return this.step(new u(b,b+f.nodeSize,b+1,b+f.nodeSize-1,new y.Slice(y.Fragment.from(g),0,0),1,!0))};e.prototype.split=function(b,d,g){void 0===d&&(d=1);for(var f=this.doc.resolve(b),t=y.Fragment.empty,h=y.Fragment.empty,l=f.depth,u=f.depth-d,e=d-1;l>u;l--,e--){t=y.Fragment.from(f.node(l).copy(t));var F=g&&g[e];h=y.Fragment.from(F?F.type.create(F.attrs,h):f.node(l).copy(h))}return this.step(new r(b,
b,new y.Slice(t.append(h),d,d,!0)))};e.prototype.join=function(b,d){void 0===d&&(d=1);b=new r(b-d,b+d,y.Slice.empty,!0);return this.step(b)};var d=function(b){function d(d,f,g){b.call(this);this.from=d;this.to=f;this.mark=g}return b&&(d.__proto__=b),d.prototype=Object.create(b&&b.prototype),d.prototype.constructor=d,d.prototype.apply=function(b){var d=this,f=b.slice(this.from,this.to),g=b.resolve(this.from);g=g.node(g.sharedDepth(this.to));f=new y.Slice(ba(f.content,function(b,f){return f.type.allowsMarkType(d.mark.type)?
b.mark(d.mark.addToSet(b.marks)):b},g),f.openStart,f.openEnd);return h.fromReplace(b,this.from,this.to,f)},d.prototype.invert=function(){return new g(this.from,this.to,this.mark)},d.prototype.map=function(b){var f=b.mapResult(this.from,1);b=b.mapResult(this.to,-1);return f.deleted&&b.deleted||f.pos>=b.pos?null:new d(f.pos,b.pos,this.mark)},d.prototype.merge=function(b){if(b instanceof d&&b.mark.eq(this.mark)&&this.from<=b.to&&this.to>=b.from)return new d(Math.min(this.from,b.from),Math.max(this.to,
b.to),this.mark)},d.prototype.toJSON=function(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},d.fromJSON=function(b,f){return new d(f.from,f.to,b.markFromJSON(f.mark))},d}(B);B.jsonID("addMark",d);var g=function(b){function f(d,f,g){b.call(this);this.from=d;this.to=f;this.mark=g}return b&&(f.__proto__=b),f.prototype=Object.create(b&&b.prototype),f.prototype.constructor=f,f.prototype.apply=function(b){var d=this,f=b.slice(this.from,this.to);f=new y.Slice(ba(f.content,
function(b){return b.mark(d.mark.removeFromSet(b.marks))}),f.openStart,f.openEnd);return h.fromReplace(b,this.from,this.to,f)},f.prototype.invert=function(){return new d(this.from,this.to,this.mark)},f.prototype.map=function(b){var d=b.mapResult(this.from,1);b=b.mapResult(this.to,-1);return d.deleted&&b.deleted||d.pos>=b.pos?null:new f(d.pos,b.pos,this.mark)},f.prototype.merge=function(b){if(b instanceof f&&b.mark.eq(this.mark)&&this.from<=b.to&&this.to>=b.from)return new f(Math.min(this.from,b.from),
Math.max(this.to,b.to),this.mark)},f.prototype.toJSON=function(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},f.fromJSON=function(b,d){return new f(d.from,d.to,b.markFromJSON(d.mark))},f}(B);B.jsonID("removeMark",g);e.prototype.addMark=function(b,f,h){var l=this,t=[],r=[],u=null,e=null;return this.doc.nodesBetween(b,f,function(l,E,I){if(l.isInline){var F=l.marks;if(!h.isInSet(F)&&I.type.allowsMarkType(h.type)){I=Math.max(E,b);l=Math.min(E+l.nodeSize,f);E=h.addToSet(F);
for(var C=0;C<F.length;C++)F[C].isInSet(E)||(u&&u.to==I&&u.mark.eq(F[C])?u.to=l:t.push(u=new g(I,l,F[C])));e&&e.to==I?e.to=l:r.push(e=new d(I,l,h))}}}),t.forEach(function(b){return l.step(b)}),r.forEach(function(b){return l.step(b)}),this};e.prototype.removeMark=function(b,d,h){var f=this;void 0===h&&(h=null);var l=[],t=0;return this.doc.nodesBetween(b,d,function(f,g){if(f.isInline){t++;var E=null;if(h instanceof y.MarkType){var r=h.isInSet(f.marks);r&&(E=[r])}else h?h.isInSet(f.marks)&&(E=[h]):E=
f.marks;if(E&&E.length)for(f=Math.min(g+f.nodeSize,d),r=0;r<E.length;r++){for(var u=E[r],e=void 0,F=0;F<l.length;F++){var I=l[F];I.step==t-1&&u.eq(l[F].style)&&(e=I)}e?(e.to=f,e.step=t):l.push({style:u,from:Math.max(g,b),to:f,step:t})}}}),l.forEach(function(b){return f.step(new g(b.from,b.to,b.style))}),this};e.prototype.clearIncompatible=function(b,d,h){void 0===h&&(h=d.contentMatch);var f=this.doc.nodeAt(b),l=[];b+=1;for(var t=0;t<f.childCount;t++){var u=f.child(t),e=b+u.nodeSize,F=h.matchType(u.type,
u.attrs);if(F)for(h=F,F=0;F<u.marks.length;F++)d.allowsMarkType(u.marks[F].type)||this.step(new g(b,e,u.marks[F]));else l.push(new r(b,e,y.Slice.empty));b=e}h.validEnd||(d=h.fillBefore(y.Fragment.empty,!0),this.replace(b,b,new y.Slice(d,0,0)));for(d=l.length-1;0<=d;d--)this.step(l[d]);return this};e.prototype.replace=function(b,d,g){void 0===d&&(d=b);void 0===g&&(g=y.Slice.empty);b=z(this.doc,b,d,g);return b&&this.step(b),this};e.prototype.replaceWith=function(b,d,g){return this.replace(b,d,new y.Slice(y.Fragment.from(g),
0,0))};e.prototype.delete=function(b,d){return this.replace(b,d,y.Slice.empty)};e.prototype.insert=function(b,d){return this.replaceWith(b,b,d)};e.prototype.replaceRange=function(b,d,g){if(!g.size)return this.deleteRange(b,d);var f=this.doc.resolve(b),h=this.doc.resolve(d);if(x(f,h,g))return this.step(new r(b,d,g));var l=ja(f,this.doc.resolve(d));0==l[l.length-1]&&l.pop();var t=-(f.depth+1);l.unshift(t);for(var u=f.depth,e=f.pos-1;0<u;u--,e--){var F=f.node(u).type.spec;if(F.defining||F.isolating)break;
-1<l.indexOf(u)?t=u:f.before(u)==e&&l.splice(1,0,-u)}u=[];e=g.openStart;var v=g.content;for(F=0;;F++){v=v.firstChild;if(u.push(v),F==g.openStart)break;v=v.content}0<e&&u[e-1].type.spec.defining?--e:2<=e&&u[e-1].isTextblock&&u[e-2].type.spec.defining&&(e-=2);t=l.indexOf(t);for(F=g.openStart;0<=F;F--){v=(F+e+1)%(g.openStart+1);var q=u[v];if(q)for(var p=0;p<l.length;p++){var A=l[(p+t)%l.length],z=!0;0>A&&(z=!1,A=-A);var Q=f.node(A-1),B=f.index(A-1);if(Q.canReplaceWith(B,B,q.type,q.marks))return this.replace(f.before(A),
z?h.after(A):d,new y.Slice(C(g.content,0,g.openStart,v),v,g.openEnd))}}return this.replace(b,d,g)};e.prototype.replaceRangeWith=function(b,d,g){if(!g.isInline&&b==d&&this.doc.resolve(b).parent.content.size){var f=aa(this.doc,b,g.type);null!=f&&(b=d=f)}return this.replaceRange(b,d,new y.Slice(y.Fragment.from(g),0,0))};e.prototype.deleteRange=function(b,d){for(var f=this.doc.resolve(b),g=this.doc.resolve(d),h=ja(f,g),l=0;l<h.length;l++){var u=h[l],r=l==h.length-1;if(r&&0==u||f.node(u).type.contentMatch.validEnd){b=
f.start(u);d=g.end(u);break}if(0<u&&(r||f.node(u-1).canReplace(f.index(u-1),g.indexAfter(u-1)))){b=f.before(u);d=g.after(u);break}}return this.delete(b,d)};p.Transform=e;p.TransformError=M;p.Step=B;p.StepResult=h;p.joinPoint=function(b,d,g){void 0===g&&(g=-1);b=b.resolve(d);for(var f=b.depth;;f--){var h=void 0,l=void 0;if(f==b.depth?(h=b.nodeBefore,l=b.nodeAfter):0<g?(h=b.node(f+1),l=b.node(f).maybeChild(b.index(f)+1)):(h=b.node(f).maybeChild(b.index(f)-1),l=b.node(f+1)),h&&!h.isTextblock&&h&&l&&
!h.isLeaf&&h.canAppend(l))return d;if(0==f)break;d=0>g?b.before(f):b.after(f)}};p.canJoin=function(b,d){b=b.resolve(d);d=b.index();var f=b.nodeBefore,g=b.nodeAfter;return f&&g&&!f.isLeaf&&f.canAppend(g)&&b.parent.canReplace(d,d+1)};p.canSplit=function(b,d,g,h){void 0===g&&(g=1);b=b.resolve(d);d=b.depth-g;var f=h&&h[h.length-1]||b.parent;if(0>d||b.parent.type.spec.isolating||!b.parent.canReplace(b.index(),b.parent.childCount)||!f.type.validContent(b.parent.content.cutByIndex(b.index(),b.parent.childCount)))return!1;
f=b.depth-1;for(g-=2;f>d;f--,g--){var l=b.node(f),t=b.index(f);if(l.type.spec.isolating)return!1;var u=l.content.cutByIndex(t,l.childCount),r=h&&h[g]||l;if(r!=l&&(u=u.replaceChild(0,r.type.create(r.attrs))),!l.canReplace(t+1,l.childCount)||!r.type.validContent(u))return!1}f=b.indexAfter(d);h=h&&h[0];return b.node(d).canReplaceWith(f,f,h?h.type:b.node(d+1).type)};p.insertPoint=aa;p.liftTarget=function(b){for(var d=b.parent.content.cutByIndex(b.startIndex,b.endIndex),g=b.depth;;--g){var h=b.$from.node(g),
l=b.$from.index(g),u=b.$to.indexAfter(g);if(g<b.depth&&h.canReplace(l,u,d))return g;var r;(r=0==g||h.type.spec.isolating)||(r=!((0==l||h.canReplace(l,h.childCount))&&(u==h.childCount||h.canReplace(0,u))));if(r)break}};p.findWrapping=function(b,d,g,h){void 0===h&&(h=b);return(h=(b=function(b,d){var f=b.parent,g=b.startIndex;b=b.endIndex;var h=f.contentMatchAt(g).findWrapping(d);return h?f.canReplaceWith(g,b,h.length?h[0]:d)?h:null:null}(b,d))&&function(b,d){var f=b.parent,g=b.startIndex;b=b.endIndex;
var h=f.child(g);h=d.contentMatch.findWrapping(h.type);if(!h)return null;for(d=(h.length?h[h.length-1]:d).contentMatch;d&&g<b;g++)d=d.matchType(f.child(g).type);return d&&d.validEnd?h:null}(h,d))?b.map(U).concat({type:d,attrs:g}).concat(h.map(U)):null};p.StepMap=N;p.MapResult=O;p.Mapping=F;p.AddMarkStep=d;p.RemoveMarkStep=g;p.ReplaceStep=r;p.ReplaceAroundStep=u;p.replaceStep=z},121:function(e,p,B){function M(e,l){return!e.selection.empty&&(l&&l(e.tr.deleteSelection().scrollIntoView()),!0)}function T(e,
l,h){var r=e.selection.$cursor;if(!r||(h?!h.endOfTextblock("backward",e):0<r.parentOffset))return!1;h=aa(r);if(!h)return h=(r=r.blockRange())&&y.liftTarget(r),null!=h&&(l&&l(e.tr.lift(r,h).scrollIntoView()),!0);var u=h.nodeBefore;return!u.type.spec.isolating&&C(e,h,l)?!0:0==r.parent.content.size&&(G(u,"end")||O.NodeSelection.isSelectable(u))?(l&&(e=e.tr.deleteRange(r.before(),r.after()),e.setSelection(G(u,"end")?O.Selection.findFrom(h,-1):O.NodeSelection.create(e.doc,h.pos-u.nodeSize)),l(e.scrollIntoView())),
!0):!(!u.isAtom||h.depth!=r.depth-1)&&(l&&l(e.tr.delete(h.pos-u.nodeSize,h.pos).scrollIntoView()),!0)}function G(e,l){for(;e;e="start"==l?e.firstChild:e.lastChild)if(e.isTextblock)return!0;return!1}function U(e,l,h){var r=e.selection.$cursor;if(!r||(h?!h.endOfTextblock("backward",e):0<r.parentOffset))return!1;r=(h=aa(r))&&h.nodeBefore;return!(!r||!O.NodeSelection.isSelectable(r))&&(l&&l(e.tr.setSelection(O.NodeSelection.create(e.doc,h.pos-r.nodeSize)).scrollIntoView()),!0)}function aa(e){if(!e.parent.type.spec.isolating)for(var l=
e.depth-1;0<=l;l--){if(0<e.index(l))return e.doc.resolve(e.before(l+1));if(e.node(l).type.spec.isolating)break}return null}function ba(e,l,h){var r=e.selection.$cursor;if(!r||(h?!h.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size))return!1;h=Y(r);if(!h)return!1;var u=h.nodeAfter;return C(e,h,l)?!0:0==r.parent.content.size&&(G(u,"start")||O.NodeSelection.isSelectable(u))?(l&&(e=e.tr.deleteRange(r.before(),r.after()),e.setSelection(G(u,"start")?O.Selection.findFrom(h,1):O.NodeSelection.create(e.doc,
e.mapping.map(h.pos))),l(e.scrollIntoView())),!0):!(!u.isAtom||h.depth!=r.depth-1)&&(l&&l(e.tr.delete(h.pos,h.pos+u.nodeSize).scrollIntoView()),!0)}function z(e,l,h){var r=e.selection.$cursor;if(!r||(h?!h.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size))return!1;r=(h=Y(r))&&h.nodeAfter;return!(!r||!O.NodeSelection.isSelectable(r))&&(l&&l(e.tr.setSelection(O.NodeSelection.create(e.doc,h.pos)).scrollIntoView()),!0)}function Y(e){if(!e.parent.type.spec.isolating)for(var l=e.depth-1;0<=
l;l--){var h=e.node(l);if(e.index(l)+1<h.childCount)return e.doc.resolve(e.after(l+1));if(h.type.spec.isolating)break}return null}function P(e,l){var h=e.selection,r=h.$head;h=h.$anchor;return!(!r.parent.type.spec.code||!r.sameParent(h))&&(l&&l(e.tr.insertText("\n").scrollIntoView()),!0)}function x(e,l){var h=e.selection,r=h.$head;h=h.$anchor;if(!r.parent.type.spec.code||!r.sameParent(h))return!1;var u=r.node(-1),d=r.indexAfter(-1);h=u.defaultContentType(d);if(!u.canReplaceWith(d,d,h))return!1;l&&
(r=r.after(),e=e.tr.replaceWith(r,r,h.createAndFill()),e.setSelection(O.Selection.near(e.doc.resolve(r),1)),l(e.scrollIntoView()));return!0}function q(e,l){var h=e.selection,r=h.$from,u=h.$to;if(r.parent.inlineContent||u.parent.inlineContent)return!1;h=r.parent.defaultContentType(u.indexAfter());if(!h||!h.isTextblock)return!1;l&&(r=(!r.parentOffset&&u.index()<u.parent.childCount?r:u).pos,e=e.tr.insert(r,h.createAndFill()),e.setSelection(O.TextSelection.create(e.doc,r+1)),l(e.scrollIntoView()));return!0}
function v(e,l){var h=e.selection.$cursor;if(!h||h.parent.content.size)return!1;if(1<h.depth&&h.after()!=h.end(-1)){var r=h.before();if(y.canSplit(e.doc,r))return l&&l(e.tr.split(r).scrollIntoView()),!0}r=(h=h.blockRange())&&y.liftTarget(h);return null!=r&&(l&&l(e.tr.lift(h,r).scrollIntoView()),!0)}function Q(e,l){var h=e.selection,r=h.$from;h=h.$to;if(e.selection instanceof O.NodeSelection&&e.selection.node.isBlock)return!(!r.parentOffset||!y.canSplit(e.doc,r.pos))&&(l&&l(e.tr.split(r.pos).scrollIntoView()),
!0);if(l){h=h.parentOffset==h.parent.content.size;var u=e.tr;e.selection instanceof O.TextSelection&&u.deleteSelection();e=0==r.depth?null:r.node(-1).defaultContentType(r.indexAfter(-1));var d=h?[{type:e}]:null,g=y.canSplit(u.doc,r.pos,1,d);d||g||!y.canSplit(u.doc,u.mapping.map(r.pos),1,[{type:e}])||(d=[{type:e}],g=!0);g&&(u.split(u.mapping.map(r.pos),1,d),h||r.parentOffset||r.parent.type==e||!r.node(-1).canReplace(r.index(-1),r.indexAfter(-1),Z.Fragment.from(e.create(),r.parent))||u.setNodeMarkup(u.mapping.map(r.before()),
e));l(u.scrollIntoView())}return!0}function A(e,l){return l&&l(e.tr.setSelection(new O.AllSelection(e.doc))),!0}function C(e,l,h){var r,u,d=l.nodeBefore,g=l.nodeAfter,b=l.nodeBefore,f=l.nodeAfter,t=l.index();if(b&&f&&b.type.compatibleContent(f.type)&&(!b.content.size&&l.parent.canReplace(t-1,t)?(h&&h(e.tr.delete(l.pos-b.nodeSize,l.pos).scrollIntoView()),!0):l.parent.canReplace(t,t+1)&&(f.isTextblock||y.canJoin(e.doc,l.pos))&&(h&&h(e.tr.clearIncompatible(l.pos,b.type,b.contentMatchAt(b.childCount)).join(l.pos).scrollIntoView()),
!0)))return!0;if(l.parent.canReplace(l.index(),l.index()+1)&&(r=(u=d.contentMatchAt(d.childCount)).findWrapping(g.type))&&u.matchType(r[0]||g.type).validEnd){if(h){u=l.pos+g.nodeSize;g=Z.Fragment.empty;for(b=r.length-1;0<=b;b--)g=Z.Fragment.from(r[b].create(null,g));g=Z.Fragment.from(d.copy(g));e=e.tr.step(new y.ReplaceAroundStep(l.pos-1,u,l.pos,u,new Z.Slice(g,1,0),r.length,!0));l=u+2*r.length;y.canJoin(e.doc,l)&&e.join(l);h(e.scrollIntoView())}return!0}d=(r=(r=O.Selection.findFrom(l,1))&&r.$from.blockRange(r.$to))&&
y.liftTarget(r);return null!=d&&d>=l.depth&&(h&&h(e.tr.lift(r,d).scrollIntoView()),!0)}function ja(){for(var e=[],l=arguments.length;l--;)e[l]=arguments[l];return function(h,l,u){for(var d=0;d<e.length;d++)if(e[d](h,l,u))return!0;return!1}}Object.defineProperty(p,"__esModule",{value:!0});var y=B(119),Z=B(38),O=B(30);e=ja(M,T,U);B=ja(M,ba,z);e={Enter:ja(P,q,v,Q),"Mod-Enter":x,Backspace:e,"Mod-Backspace":e,Delete:B,"Mod-Delete":B,"Mod-a":A};B={"Ctrl-h":e.Backspace,"Alt-Backspace":e["Mod-Backspace"],
"Ctrl-d":e.Delete,"Ctrl-Alt-Backspace":e["Mod-Delete"],"Alt-Delete":e["Mod-Delete"],"Alt-d":e["Mod-Delete"]};for(var N in e)B[N]=e[N];N=("undefined"!=typeof navigator?/Mac/.test(navigator.platform):"undefined"!=typeof os&&"darwin"==os.platform())?B:e;p.deleteSelection=M;p.joinBackward=T;p.selectNodeBackward=U;p.joinForward=ba;p.selectNodeForward=z;p.joinUp=function(e,l){var h=e.selection;var r=h instanceof O.NodeSelection;if(r){if(h.node.isTextblock||!y.canJoin(e.doc,h.from))return!1;h=h.from}else if(null==
(h=y.joinPoint(e.doc,h.from,-1)))return!1;if(l){var u=e.tr.join(h);r&&u.setSelection(O.NodeSelection.create(u.doc,h-e.doc.resolve(h).nodeBefore.nodeSize));l(u.scrollIntoView())}return!0};p.joinDown=function(e,l){var h=e.selection;if(h instanceof O.NodeSelection){if(h.node.isTextblock||!y.canJoin(e.doc,h.to))return!1;h=h.to}else if(null==(h=y.joinPoint(e.doc,h.to,1)))return!1;return l&&l(e.tr.join(h).scrollIntoView()),!0};p.lift=function(e,l){var h=e.selection,r=(h=h.$from.blockRange(h.$to))&&y.liftTarget(h);
return null!=r&&(l&&l(e.tr.lift(h,r).scrollIntoView()),!0)};p.newlineInCode=P;p.exitCode=x;p.createParagraphNear=q;p.liftEmptyBlock=v;p.splitBlock=Q;p.splitBlockKeepMarks=function(e,l){return Q(e,l&&function(h){var r=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();r&&h.ensureMarks(r);l(h)})};p.selectParentNode=function(e,l){var h,r=e.selection,u=r.$from;r=u.sharedDepth(r.to);return 0!=r&&(h=u.before(r),l&&l(e.tr.setSelection(O.NodeSelection.create(e.doc,h))),!0)};p.selectAll=
A;p.wrapIn=function(e,l){return function(h,r){var u=h.selection,d=(u=u.$from.blockRange(u.$to))&&y.findWrapping(u,e,l);return!!d&&(r&&r(h.tr.wrap(u,d).scrollIntoView()),!0)}};p.setBlockType=function(e,l){return function(h,r){var u=h.selection,d=u.from;u=u.to;var g=null,b=-1;if(h.doc.nodesBetween(d,u,function(d,f){if(g)return!1;d.isTextblock&&(g=d,b=f)}),!g||g.hasMarkup(e,l))return!1;var f=h.doc.resolve(b),t=f.index();return!!f.parent.canReplaceWith(t,t+1,e)&&(r&&r(h.tr.setBlockType(d,u,e,l).scrollIntoView()),
!0)}};p.toggleMark=function(e,l){return function(h,r){var u=h.selection,d=u.$cursor,g=u.ranges;if(u.empty&&!d||!function(b,d,f){for(var g=function(g){var h=d[g];g=h.$from;h=h.$to;var l=0==g.depth&&b.type.allowsMarkType(f);if(b.nodesBetween(g.pos,h.pos,function(b){if(l)return!1;l=b.inlineContent&&b.type.allowsMarkType(f)}),l)return{v:!0}},h=0;h<d.length;h++){var l=g(h);if(l)return l.v}return!1}(h.doc,g,e))return!1;if(r)if(d)e.isInSet(h.storedMarks||d.marks())?r(h.tr.removeStoredMark(e)):r(h.tr.addStoredMark(e.create(l)));
else{d=!1;u=h.tr;for(var b=0;!d&&b<g.length;b++)d=g[b],d=h.doc.rangeHasMark(d.$from.pos,d.$to.pos,e);for(h=0;h<g.length;h++){var f=g[h];b=f.$from;f=f.$to;d?u.removeMark(b.pos,f.pos,e):u.addMark(b.pos,f.pos,e.create(l))}r(u.scrollIntoView())}return!0}};p.autoJoin=function(e,l){if(Array.isArray(l)){var h=l;l=function(l){return-1<h.indexOf(l.type.name)}}return function(h,u){return e(h,u&&function(d,g){return function(b){if(!b.isGeneric)return d(b);for(var f=[],h=0;h<b.mapping.maps.length;h++){for(var l=
b.mapping.maps[h],e=0;e<f.length;e++)f[e]=l.map(f[e]);l.forEach(function(b,d,g,h){return f.push(g,h)})}h=[];for(l=0;l<f.length;l+=2){e=f[l+1];var u=b.doc.resolve(f[l]),r=u.sharedDepth(e),v=u.node(r),C=u.indexAfter(r);for(u=u.after(r+1);u<=e;++C){r=v.maybeChild(C);if(!r)break;if(C&&-1==h.indexOf(u)){var q=v.child(C-1);q.type==r.type&&g(q,r)&&h.push(u)}u+=r.nodeSize}}h.sort(function(b,d){return b-d});for(l=h.length-1;0<=l;l--)y.canJoin(b.doc,h[l])&&b.join(h[l]);d(b)}}(u,l))}};p.chainCommands=ja;p.pcBaseKeymap=
e;p.macBaseKeymap=B;p.baseKeymap=N},122:function(e,p,B){function M(e,v,q,p){var C=T(v),y=Q.get(v).spec.config,x=(p?e.undone:e.done).popEvent(v,C);if(x){var l=x.selection.resolve(x.transform.doc);e=(p?e.done:e.undone).addTransform(x.transform,v.selection.getBookmark(),y,C);p=new P(p?e:x.remaining,p?x.remaining:e,null,0);q(x.transform.setSelection(l).setMeta(Q,p).scrollIntoView())}}function T(e){e=e.plugins;if(v!=e){q=!1;v=e;for(var C=0;C<e.length;C++)if(e[C].spec.historyPreserveItems){q=!0;break}}return q}
Object.defineProperty(p,"__esModule",{value:!0});var G,U=(G=B(1579))&&"object"==typeof G&&"default"in G?G.default:G,aa=B(119),ba=B(30),z=function(e,v){this.items=e;this.eventCount=v};z.prototype.popEvent=function(e,v){var C=this;if(0==this.eventCount)return null;for(var q,p,x=this.items.length;;x--)if(C.items.get(x-1).selection){--x;break}v&&(q=this.remapping(x,this.items.length),p=q.maps.length);var A,l,h=e.tr,r=[],u=[];return this.items.forEach(function(d,g){if(!d.step)return q||(q=C.remapping(x,
g+1),p=q.maps.length),p--,void u.push(d);if(q){u.push(new Y(d.map));var b;(g=d.step.map(q.slice(p)))&&h.maybeStep(g).doc&&(b=h.mapping.maps[h.mapping.maps.length-1],r.push(new Y(b,null,null,r.length+u.length)));p--;b&&q.appendMap(b,p)}else h.maybeStep(d.step);return d.selection?(A=q?d.selection.map(q.slice(p)):d.selection,l=new z(C.items.slice(0,x).append(u.reverse().concat(r)),C.eventCount-1),!1):void 0},this.items.length,0),{remaining:l,transform:h,selection:A}};z.prototype.addTransform=function(e,
v,q,p){for(var C=[],y=this.eventCount+(v?1:0),A=this.items,l=!p&&A.length?A.get(A.length-1):null,h=0;h<e.steps.length;h++){var r,u=e.steps[h].invert(e.docs[h]);u=new Y(e.mapping.maps[h],u,v);(r=l&&l.merge(u))&&(u=r,h?C.pop():A=A.slice(0,A.length-1));C.push(u);v=null;p||(l=u)}var d,g,b;e=y-q.depth;return e>x&&(g=e,(d=A).forEach(function(d,h){if(d.selection&&0==g--)return b=h,!1}),A=d.slice(b),y-=e),new z(A.append(C),y)};z.prototype.remapping=function(e,v){var q=[],C=[];return this.items.forEach(function(v,
p){null!=v.mirrorOffset&&p-v.mirrorOffset>=e&&C.push(q.length-v.mirrorOffset,q.length);q.push(v.map)},e,v),new aa.Mapping(q,C)};z.prototype.addMaps=function(e){return 0==this.eventCount?this:new z(this.items.append(e.map(function(e){return new Y(e)})),this.eventCount)};z.prototype.rebased=function(e,v){if(!this.eventCount)return this;var q=[],p=Math.max(0,this.items.length-v),C=e.mapping,x=e.steps.length,A=this.eventCount,l=v;this.items.forEach(function(h){var u=C.getMirror(--l);if(null!=u){x=Math.min(x,
u);var d=C.maps[u];if(h.step){var g=e.steps[u].invert(e.docs[u]);h=h.selection&&h.selection.map(C.slice(l,u));q.push(new Y(d,g,h))}else h.selection&&A--,q.push(new Y(d))}},p);for(var h=[];v<x;v++)h.push(new Y(C.maps[v]));p=this.items.slice(0,p).append(h).append(q);p=new z(p,A);return 500<p.emptyItemCount()&&(p=p.compress(this.items.length-q.length)),p};z.prototype.emptyItemCount=function(){var e=0;return this.items.forEach(function(v){v.step||e++}),e};z.prototype.compress=function(e){void 0===e&&
(e=this.items.length);var v=this.remapping(0,e),q=v.maps.length,p=[],C=0;return this.items.forEach(function(y,x){if(x>=e)p.push(y),y.selection&&C++;else if(y.step){var l=(x=y.step.map(v.slice(q)))&&x.getMap();if(q--,l&&v.appendMap(l,q),x){(y=y.selection&&y.selection.map(v.slice(q)))&&C++;var h;y=new Y(l.invert(),x,y);x=p.length-1;(h=p.length&&p[x].merge(y))?p[x]=h:p.push(y)}}else y.map&&q--},this.items.length,0),new z(U.from(p.reverse()),C)};z.empty=new z(U.empty,0);var Y=function(e,v,q,p){this.map=
e;this.step=v;this.selection=q;this.mirrorOffset=p};Y.prototype.merge=function(e){if(this.step&&e.step&&!e.selection&&(e=e.step.merge(this.step)))return new Y(e.getMap().invert(),e,this.selection)};var P=function(e,v,q,p){this.done=e;this.undone=v;this.prevMap=q;this.prevTime=p},x=20,q=!1,v=null,Q=new ba.PluginKey("history"),A=new ba.PluginKey("closeHistory");p.HistoryState=P;p.closeHistory=function(e){return e.setMeta(A,!0)};p.history=function(e){return e={depth:e&&e.depth||100,newGroupDelay:e&&
e.newGroupDelay||500},new ba.Plugin({key:Q,state:{init:function(){return new P(z.empty,z.empty,null,0)},apply:function(v,q,p){return function(e,v,q,l){var h=q.getMeta(Q);if(h)return h;q.getMeta(A)&&(e=new P(e.done,e.undone,null,0));h=q.getMeta("appendedTransaction");if(0==q.steps.length)return e;if(!1!==(h||q).getMeta("addToHistory")){var r=e.prevTime<(q.time||0)-l.newGroupDelay||!h&&!function(h,d,g){if(!d)return!1;h=h.mapping.maps[0];var b=!1;return!h||(h.forEach(function(f,h){g.items.forEach(function(g){if(g.step)return d.forEach(function(d,
g,e,l){f<=l&&h>=e&&(b=!0)}),!1;f=g.map.invert().map(f,-1);h=g.map.invert().map(h,1)},g.items.length,0)}),b)}(q,e.prevMap,e.done);return new P(e.done.addTransform(q,r?v.selection.getBookmark():null,l,T(v)),z.empty,q.mapping.maps[q.steps.length-1],q.time)}return(r=q.getMeta("rebased"))?new P(e.done.rebased(q,r),e.undone.rebased(q,r),e.prevMap&&q.mapping.maps[q.steps.length-1],e.prevTime):new P(e.done.addMaps(q.mapping.maps),e.undone.addMaps(q.mapping.maps),e.prevMap,e.prevTime)}(q,p,v,e)}},config:e})};
p.undo=function(e,v){var q=Q.getState(e);return!(!q||0==q.done.eventCount||(v&&M(q,e,v,!1),0))};p.redo=function(e,v){var q=Q.getState(e);return!(!q||0==q.undone.eventCount||(v&&M(q,e,v,!0),0))};p.undoDepth=function(e){return(e=Q.getState(e))?e.done.eventCount:0};p.redoDepth=function(e){return(e=Q.getState(e))?e.undone.eventCount:0}},1583:function(e,p,B){function M(e,p){var z=e&&e.width||1;return"border-"+p+": "+z+"px solid "+(e&&e.color||"black")+"; margin-"+p+": -"+z+"px"}Object.defineProperty(p,
"__esModule",{value:!0});var T=B(30),G=B(782),U=B(1584),aa="undefined"!=typeof navigator&&/gecko\/\d/i.test(navigator.userAgent),ba="undefined"!=typeof navigator&&/linux/i.test(navigator.platform);p.dropCursor=function(e){function p(e,p){e.dispatch(e.state.tr.setMeta(q,p))}function z(e,z){clearTimeout(x);x=setTimeout(function(){q.getState(e.state)&&p(e,{type:"remove"})},z)}var x=null,q=new T.Plugin({state:{init:function(){return null},apply:function(v,p,x){if(aa&&ba)return null;if(v="drop"==v.getMeta("uiEvent")?
{type:"remove"}:v.getMeta(q))if("set"==v.type){p=v.pos;var C,A,y;v=x.doc.resolve(p);(v.parent.inlineContent||((A=v.nodeBefore)?C=U.Decoration.node(p-A.nodeSize,p,{nodeName:"div",style:M(e,"right")}):(y=v.nodeAfter)&&(C=U.Decoration.node(p,p+y.nodeSize,{nodeName:"div",style:M(e,"left")}))),C)||(C=document.createElement("span"),C.textContent="\u200b",C.style.cssText=M(e,"left")+"; display: inline-block; pointer-events: none",C=U.Decoration.widget(p,C));x={pos:p,deco:U.DecorationSet.create(x.doc,[C])}}else x=
null;else x=p;return x}},props:{handleDOMEvents:{dragover:function(e,x){var v=q.getState(e.state);if(x=e.posAtCoords({left:x.clientX,top:x.clientY})){var C=x.pos;e.dragging&&e.dragging.slice&&null==(C=G.dropPoint(e.state.doc,C,e.dragging.slice))&&(C=x.pos);v&&v.pos==C||p(e,{type:"set",pos:C})}return z(e,5E3),!1},dragend:function(e){return z(e,20),!1},drop:function(e){return z(e,20),!1},dragleave:function(e,q){return q.target!=e.dom&&e.dom.contains(q.relatedTarget)||p(e,{type:"remove"}),!1}},decorations:function(e){return(e=
q.getState(e))&&e.deco}}});return q}},1584:function(e,p,B){function M(a,c,b,d,k){for(;;){if(a==b&&c==d)return!0;if(c==(0>k?0:3==a.nodeType?a.nodeValue.length:a.childNodes.length)||3==a.nodeType&&"\ufeff"==a.nodeValue){var m=a.parentNode;if(1!=m.nodeType||(D=void 0,(D=a.pmViewDesc)&&D.node&&D.node.isBlock)||Hb.test(a.nodeName))return!1;c=hb(a)+(0>k?0:1);a=m}else{if(1!=a.nodeType)return!1;a=a.childNodes[c+(0>k?-1:0)];c=0>k?3==a.nodeType?a.nodeValue.length:a.childNodes.length:0}}var D}function T(a,c){var m=
a.someProp("scrollThreshold")||0,b=a.someProp("scrollMargin"),d=a.dom.ownerDocument,k=d.defaultView;null==b&&(b=5);for(a=a.dom;a;a=Ab(a)){var S=a==d.body||1!=a.nodeType,n=S?{left:0,right:k.innerWidth,top:0,bottom:k.innerHeight}:a.getBoundingClientRect(),w=0,f=0;if(c.top<n.top+m?f=-(n.top-c.top+b):c.bottom>n.bottom-m&&(f=c.bottom-n.bottom+b),c.left<n.left+m?w=-(n.left-c.left+b):c.right>n.right-m&&(w=c.right-n.right+b),(w||f)&&(S?k.scrollBy(w,f):(f&&(a.scrollTop+=f),w&&(a.scrollLeft+=w))),S)break}}
function G(a,c){for(var m,b,d=2E8,k=0,S=c.top,n=c.top,w=a.firstChild,f=0;w;w=w.nextSibling,f++){if(1==w.nodeType)var g=w.getClientRects();else{if(3!=w.nodeType)continue;g=kb(w).getClientRects()}for(var K=0;K<g.length;K++){var J=g[K];if(J.top<=S&&J.bottom>=n){S=Math.max(J.bottom,S);n=Math.min(J.top,n);var L=J.left>c.left?J.left-c.left:J.right<c.left?c.left-J.right:0;if(L<d){m=w;b=(d=L)&&3==m.nodeType?{left:J.right<c.left?J.right:J.left,top:c.top}:c;1==w.nodeType&&L&&(k=f+(c.left>=(J.left+J.right)/
2?1:0));continue}}!m&&(c.left>=J.right&&c.top>=J.top||c.left>=J.left&&c.top>=J.bottom)&&(k=f+1)}}if(m&&3==m.nodeType)a:{a=m;c=a.nodeValue.length;m=document.createRange();for(d=0;d<c;d++)if(m.setEnd(a,d+1),m.setStart(a,d),k=aa(m,1),k.top!=k.bottom&&k.left-1<=b.left&&k.right+1>=b.left&&k.top-1<=b.top&&k.bottom+1>=b.top){b={node:a,offset:d+(b.left>=(k.left+k.right)/2?1:0)};break a}b={node:a,offset:0}}else b=!m||d&&1==m.nodeType?{node:a,offset:k}:G(m,b);return b}function U(a,c){var m=a.root;if(m.caretPositionFromPoint){var b=
m.caretPositionFromPoint(c.left,c.top);if(b){var d=b.offsetNode;var k=b.offset}}!d&&m.caretRangeFromPoint&&(b=m.caretRangeFromPoint(c.left,c.top))&&(d=b.startContainer,k=b.startOffset);var n;m=m.elementFromPoint(c.left,c.top+1);if(!m||(m=function(a,c){var m=a.parentNode;return m&&/^li$/i.test(m.nodeName)&&c.left<a.getBoundingClientRect().left?m:a}(m,c),d&&(d==a.dom&&k==d.childNodes.length-1&&1==d.lastChild.nodeType&&c.top>d.lastChild.getBoundingClientRect().bottom?n=a.state.doc.content.size:0!=k&&
1==d.nodeType&&"BR"==d.childNodes[k-1].nodeName||(n=function(a,c,m,b){for(var d=-1,D=c;D!=a.dom;){D=a.docView.nearestDesc(D,!0);if(!D)return null;if(D.node.isBlock&&D.parent){var k=D.dom.getBoundingClientRect();if(k.left>b.left||k.top>b.top)d=D.posBefore;else{if(!(k.right<b.left||k.bottom<b.top))break;d=D.posAfter}}D=D.dom.parentNode}return-1<d?d:a.docView.posFromDOM(c,m)}(a,d,k,c))),null==n&&null==(n=function(a,c,m){if(!a.dom.contains(1!=c.nodeType?c.parentNode:c))return null;var b=G(c,m);c=b.node;
b=b.offset;var D=-1;1!=c.nodeType||c.firstChild||(D=c.getBoundingClientRect(),D=D.left!=D.right&&m.left>(D.left+D.right)/2?1:-1);return a.docView.posFromDOM(c,b,D)}(a,m,c))))return null;a=a.docView.nearestDesc(m,!0);return{pos:n,inside:a?a.posAtStart-a.border:-1}}function aa(a,c){var m=a.getClientRects();return m.length?m[0>c?0:m.length-1]:a.getBoundingClientRect()}function ba(a,c){var m,b;c=a.docView.domFromPos(c);a=c.node;c=c.offset;3==a.nodeType?(c<a.nodeValue.length&&(b=aa(kb(a,c,c+1),-1),m="left"),
b&&b.left!=b.right||!c||(b=aa(kb(a,c-1,c),1),m="right")):a.firstChild?(c<a.childNodes.length&&(b=a.childNodes[c],b=aa(3==b.nodeType?kb(b):b,-1),m="left"),b&&b.top!=b.bottom||!c||(b=a.childNodes[c-1],b=aa(3==b.nodeType?kb(b):b,1),m="right")):(b=a.getBoundingClientRect(),m="left");m=b[m];return{top:b.top,bottom:b.bottom,left:m,right:m}}function z(a,c,b){var m=a.state,d=a.root.activeElement;m==c&&a.inDOMChange||a.updateState(c);d!=a.dom&&a.focus();try{return b()}finally{m!=c&&a.updateState(m),d!=a.dom&&
d.focus()}}function Y(a,c,b){return Qa==c&&Za==b?Bb:(Qa=c,Za=b,Bb="up"==b||"down"==b?function(a,c,m){var b=c.selection,d="up"==m?b.$anchor.min(b.$head):b.$anchor.max(b.$head);return!!d.depth&&z(a,c,function(){var c=a.docView.domAfterPos(d.before()),b=ba(a,d.pos);for(c=c.firstChild;c;c=c.nextSibling){if(1==c.nodeType)var D=c.getClientRects();else{if(3!=c.nodeType)continue;D=kb(c,0,c.nodeValue.length).getClientRects()}for(var k=0;k<D.length;k++){var n=D[k];if(n.bottom>n.top&&("up"==m?n.bottom<b.top+
1:n.top>b.bottom-1))return!1}}return!0})}(a,c,b):function(a,c,m){var b=c.selection.$head;if(!b.parent.isTextblock||!b.depth)return!1;var d=b.parentOffset,D=!d;d=d==b.parent.content.size;var k=getSelection();return oa.test(b.parent.textContent)&&k.modify?z(a,c,function(){var c=k.getRangeAt(0),d=k.focusNode,D=k.focusOffset;k.modify("move",m,"character");d=!a.docView.domAfterPos(b.before()).contains(1==k.focusNode.nodeType?k.focusNode:k.focusNode.parentNode)||d==k.focusNode&&D==k.focusOffset;return k.removeAllRanges(),
k.addRange(c),d}):"left"==m||"backward"==m?D:d}(a,c,b))}function P(a,c,b,d,k){return v(d,d,$a,q(c,a,1!=d.nodeType)),new Ma(null,a,c,b,d,d,d,k,0)}function x(a){a&&(this.nodeName=a)}function q(a,c,b){if(0==a.length)return $a;for(var m=b?$a[0]:new x,d=[m],k=0;k<a.length;k++){var D=a[k].type.attrs,n=m;if(D)for(var S in D.nodeName&&d.push(n=new x(D.nodeName)),D){var w=D[S];null!=w&&(b&&1==d.length&&d.push(n=m=new x(c.isInline?"span":"div")),"class"==S?n.class=(n.class?n.class+" ":"")+w:"style"==S?n.style=
(n.style?n.style+";":"")+w:"nodeName"!=S&&(n[S]=w))}}return d}function v(a,c,b,d){if(b==$a&&d==$a)return c;for(var m=c,k=0;k<d.length;k++){var D=d[k],n=b[k];if(k){var S=void 0;n&&n.nodeName==D.nodeName&&m!=a&&(S=c.parentNode)&&S.tagName.toLowerCase()==D.nodeName?m=S:((S=document.createElement(D.nodeName)).appendChild(m),m=S)}var za,w=za=void 0;S=m;n=n||$a[0];for(w in n)"class"==w||"style"==w||"nodeName"==w||w in D||S.removeAttribute(w);for(za in D)"class"!=za&&"style"!=za&&"nodeName"!=za&&D[za]!=
n[za]&&S.setAttribute(za,D[za]);if(n.class!=D.class){za=n.class?n.class.split(" "):Na;w=D.class?D.class.split(" "):Na;for(var f=0;f<za.length;f++)-1==w.indexOf(za[f])&&S.classList.remove(za[f]);for(f=0;f<w.length;f++)-1==za.indexOf(w[f])&&S.classList.add(w[f])}if(n.style!=D.style){if(n.style)for(w=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;za=w.exec(n.style);)S.style[za[1].toLowerCase()]="";D.style&&(S.style.cssText+=D.style)}}return m}function Q(a,c){if(a.length!=
c.length)return!1;for(var m=0;m<a.length;m++)if(!a[m].type.eq(c[m].type))return!1;return!0}function A(a){var c=a.nextSibling;return a.parentNode.removeChild(a),c}function C(a,c){return a.type.side-c.type.side}function ja(a){return Va==a._props?ib:(Va=a._props,ib=function(a){var c={};return a.someProp("nodeViews",function(a){for(var m in a)Object.prototype.hasOwnProperty.call(c,m)||(c[m]=a[m])}),c}(a))}function y(a,c){var m=a.selection,b=m.$anchor;m=m.$head;b=0<c?b.max(m):b.min(m);return(a=b.parent.inlineContent?
b.depth?a.doc.resolve(0<c?b.after():b.before()):null:b)&&ca.Selection.findFrom(a,c)}function Z(a,c){return a.dispatch(a.state.tr.setSelection(c).scrollIntoView()),!0}function O(a,c){var m=a.state.selection;if(m instanceof ca.TextSelection){if(m.empty){if(a.endOfTextblock(0<c?"right":"left"))return c=y(a.state,c),!!(c&&c instanceof ca.NodeSelection)&&Z(a,c);var b;m=m.$head;var d=m.textOffset?null:0>c?m.nodeBefore:m.nodeAfter;if(d&&ca.NodeSelection.isSelectable(d)){var k=0>c?m.pos-d.nodeSize:m.pos;
if(d.isAtom||(b=a.docView.descAt(k))&&!b.contentDOM)return Z(a,new ca.NodeSelection(0>c?a.state.doc.resolve(m.pos-d.nodeSize):m))}}return!1}if(m instanceof ca.NodeSelection&&m.node.isInline)return Z(a,new ca.TextSelection(0<c?m.$to:m.$from));c=y(a.state,c);return!!c&&Z(a,c)}function N(a){return 3==a.nodeType?a.nodeValue.length:a.childNodes.length}function F(a){var c=a.pmViewDesc;return c&&0==c.size&&(a.nextSibling||"BR"!=a.nodeName)}function l(a){var c=a.root.getSelection(),b=c.focusNode,d=c.focusOffset;
if(b){var k=!1;for(V.gecko&&1==b.nodeType&&d<N(b)&&F(b.childNodes[d])&&(k=!0);;)if(0<d)if(1!=b.nodeType){if(3!=b.nodeType||"\ufeff"!=b.nodeValue.charAt(d-1))break;V.ie&&11>=V.ie_version&&(k=!0);var n=b;var S=--d}else{var w=b.childNodes[d-1];if(F(w))n=b,S=--d;else{if(3!=w.nodeType)break;d=(b=w).nodeValue.length}}else{if(r(b))break;for(w=b.previousSibling;w&&F(w);)n=b.parentNode,S=hb(w),w=w.previousSibling;if(w)d=N(b=w);else{if((b=b.parentNode)==a.dom)break;d=0}}k?u(a,c,b,d):n&&u(a,c,n,S)}}function h(a){var c=
a.root.getSelection(),b=c.focusNode,d=c.focusOffset;if(b){for(var k,n,S=N(b);;)if(d<S){if(1!=b.nodeType)break;if(!F(b.childNodes[d]))break;k=b;n=++d}else{if(r(b))break;for(S=b.nextSibling;S&&F(S);)k=S.parentNode,n=hb(S)+1,S=S.nextSibling;if(S)d=0,S=N(b=S);else{if((b=b.parentNode)==a.dom)break;d=S=0}}k&&u(a,c,k,n)}}function r(a){return(a=a.pmViewDesc)&&a.node&&a.node.isBlock}function u(a,c,b,d){if(tb(c)){var m=document.createRange();m.setEnd(b,d);m.setStart(b,d);c.removeAllRanges();c.addRange(m)}else c.extend&&
c.extend(b,d);a.selectionReader.storeDOMState(a.selection)}function d(a,c){var m=a.state.selection;if(m instanceof ca.TextSelection&&!m.empty)return!1;var b=m.$from;m=m.$to;if(!b.parent.inlineContent||a.endOfTextblock(0>c?"up":"down")){var d=y(a.state,c);if(d&&d instanceof ca.NodeSelection)return Z(a,d)}return b.parent.inlineContent?!1:(c=ca.Selection.findFrom(0>c?b:m,c),!c||Z(a,c))}function g(a,c){if(!(a.state.selection instanceof ca.TextSelection))return!0;var m=a.state.selection,b=m.$head,d=m.empty;
return b.sameParent(m.$anchor)?d?a.endOfTextblock(0<c?"forward":"backward")?!0:(m=!b.textOffset&&(0>c?b.nodeBefore:b.nodeAfter))&&!m.isText?(d=a.state.tr,0>c?d.delete(b.pos-m.nodeSize,b.pos):d.delete(b.pos,b.pos+m.nodeSize),a.dispatch(d),!0):!1:!1:!0}function b(a,c){var m=a.state.selection;if(function(a,c){c instanceof ca.NodeSelection?(c=a.docView.descAt(c.from),c!=a.lastSelectedViewDesc&&(a.lastSelectedViewDesc&&(a.lastSelectedViewDesc.deselectNode(),a.lastSelectedViewDesc=null),c&&c.selectNode(),
a.lastSelectedViewDesc=c)):a.lastSelectedViewDesc&&(a.lastSelectedViewDesc.deselectNode(),a.lastSelectedViewDesc=null)}(a,m),a.editable&&!a.hasFocus()){if(!c)return;V.gecko&&55>=V.gecko_version&&(a.selectionReader.ignoreUpdates=!0,a.dom.focus(),a.selectionReader.ignoreUpdates=!1)}else if(!a.editable&&!I(a)&&!c)return;c=a.selectionReader;if(!c.lastSelection||!c.lastSelection.eq(m)||c.domChanged()){if(c.ignoreUpdates=!0,a.cursorWrapper)!function(a){var c=a.root.getSelection(),m=document.createRange(),
b=a.cursorWrapper.dom;m.setEnd(b,b.childNodes.length);m.collapse(!1);c.removeAllRanges();c.addRange(m);!a.state.selection.visible&&V.ie&&11>=V.ie_version&&(b.disabled=!0,b.disabled=!1)}(a);else{var b,d,k=m.anchor,n=m.head;!ub||m instanceof ca.TextSelection||(m.$from.parent.inlineContent||(b=f(a,m.from)),m.empty||m.$from.parent.inlineContent||(d=f(a,m.to)));a.docView.setSelection(k,n,a.root);ub&&(b&&(b.contentEditable="false"),d&&(d.contentEditable="false"));m.visible?a.dom.classList.remove("ProseMirror-hideselection"):
k!=n&&(a.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(a){var c=a.dom.ownerDocument;c.removeEventListener("selectionchange",a.hideSelectionGuard);var m=a.root.getSelection(),b=m.anchorNode,d=m.anchorOffset;c.addEventListener("selectionchange",a.hideSelectionGuard=function(){m.anchorNode==b&&m.anchorOffset==d||(c.removeEventListener("selectionchange",a.hideSelectionGuard),a.dom.classList.remove("ProseMirror-hideselection"))})}(a))}c.storeDOMState(m);c.ignoreUpdates=
!1}}function f(a,c){c=a.docView.domFromPos(c);a=c.node;var m=c.offset;c=m<a.childNodes.length?a.childNodes[m]:null;a=m?a.childNodes[m-1]:null;if(!(c&&"false"!=c.contentEditable||a&&"false"!=a.contentEditable)){if(c)return c.contentEditable="true",c;if(a)return a.contentEditable="true",a}}function t(a,c,b,d){return a.someProp("createSelectionBetween",function(m){return m(a,c,b)})||ca.TextSelection.between(c,b,d)}function E(a){return(!a.editable||a.root.activeElement==a.dom)&&I(a)}function I(a){var c=
a.root.getSelection();if(!c.anchorNode)return!1;try{return a.dom.contains(3==c.anchorNode.nodeType?c.anchorNode.parentNode:c.anchorNode)}catch(D){return!1}}function ka(a){return!1===a.type.spec.inclusive}function la(a){var c=a.selection,b=c.$head,d=c.visible;return(c=b.pos!=c.$anchor.pos||d&&!b.parent.inlineContent?null:b)&&(!d||a.storedMarks||0==c.parent.content.length||c.parentOffset&&!c.textOffset&&c.nodeBefore.marks.some(ka))?c:null}function Ua(a,c){return function(b){var m=b.pmViewDesc;if(m)return m.parseRule();
if("BR"==b.nodeName&&b.parentNode){if(V.safari&&/^(ul|ol)$/i.test(b.parentNode.nodeName))return a.matchTag(document.createElement("li"),c);if(b.parentNode.lastChild==b)return{ignore:!0}}}}function Ia(a,c){var b=document.createEvent("Event");return b.initEvent("keydown",!0,!0),b.keyCode=a,b.key=b.code=c,b}function gb(a,c,b,d){return Math.max(d.anchor,d.head)>c.content.size?null:t(a,c.resolve(b.map(d.anchor)),c.resolve(b.map(d.head)))}function H(a,c,b){for(var m=a.depth,d=c?a.end():a.pos;0<m&&(c||a.indexAfter(m)==
a.node(m).childCount);)m--,d++,c=!1;if(b)for(a=a.node(m).maybeChild(a.indexAfter(m));a&&!a.isLeaf;)a=a.firstChild,d++;return d}function Ra(a,c){for(var b=[],m=c.content,d=c.openStart,k=c.openEnd;1<d&&1<k&&1==m.childCount&&1==m.firstChild.childCount;){d--;k--;var n=m.firstChild;b.push(n.type.name,n.type.hasRequiredAttrs()?n.attrs:null);m=n.content}var w=a.someProp("clipboardSerializer")||X.DOMSerializer.fromSchema(a.state.schema);n=document.createElement("div");n.appendChild(w.serializeFragment(m));
var S;for(m=n.firstChild;m&&1==m.nodeType&&(S=Fa[m.nodeName.toLowerCase()]);){for(m=S.length-1;0<=m;m--){for(w=document.createElement(S[m]);n.firstChild;)w.appendChild(n.firstChild);n.appendChild(w)}m=n.firstChild}return m&&1==m.nodeType&&m.setAttribute("data-pm-slice",d+" "+k+" "+JSON.stringify(b)),{dom:n,text:a.someProp("clipboardTextSerializer",function(a){return a(c)})||c.content.textBetween(0,c.content.size,"\n\n")}}function da(a,c,b,d,k){var m,n,D=k.parent.type.spec.code;if(!b&&!c)return null;
if((d||D||!b)&&c){if(a.someProp("transformPastedText",function(a){c=a(c)}),D)return new X.Slice(X.Fragment.from(a.state.schema.text(c)),0,0);(d=a.someProp("clipboardTextParser",function(a){return a(c,k)}))?n=d:(m=document.createElement("div"),c.trim().split(/(?:\r\n?|\n)+/).forEach(function(a){m.appendChild(document.createElement("p")).textContent=a}))}else a.someProp("transformPastedHTML",function(a){return b=a(b)}),m=function(a){var c=/(\s*<meta [^>]*>)*/.exec(a);c&&(a=a.slice(c[0].length));var b;
c=(Ga||(Ga=document.implementation.createHTMLDocument("title"))).createElement("div");var m=/(?:<meta [^>]*>)*<([a-z][^>\s]+)/i.exec(a),d=0;(b=m&&Fa[m[1].toLowerCase()])&&(a=b.map(function(a){return"\x3c"+a+"\x3e"}).join("")+a+b.map(function(a){return"\x3c/"+a+"\x3e"}).reverse().join(""),d=b.length);c.innerHTML=a;for(a=0;a<d;a++)c=c.firstChild;return c}(b);n||(n=(a.someProp("clipboardParser")||a.someProp("domParser")||X.DOMParser.fromSchema(a.state.schema)).parseSlice(m,{preserveWhitespace:!0,context:k}));
d=(d=m&&m.querySelector("[data-pm-slice]"))&&/^(\d+) (\d+) (.*)/.exec(d.getAttribute("data-pm-slice"));return n=d?function(a,c){if(!a.size)return a;var b=a.content.firstChild.type.schema;try{var m=JSON.parse(c)}catch(Rb){return a}c=a.content;var d=a.openStart;a=a.openEnd;for(var k=m.length-2;0<=k;k-=2){var n=b.nodes[m[k]];if(!n||n.hasRequiredAttrs())break;c=X.Fragment.from(n.create(m[k+1],c));d++;a++}return new X.Slice(c,d,a)}(new X.Slice(n.content,Math.min(n.openStart,+d[1]),Math.min(n.openEnd,+d[2])),
d[3]):X.Slice.maxOpen(function(a,c){if(2>a.childCount)return a;for(var b=function(b){var m=c.node(b).contentMatchAt(c.index(b)),d=void 0,k=[];if(a.forEach(function(a){if(k){var c,b=m.findWrapping(a.type);if(!b)return k=null;(c=k.length&&d.length&&function Nb(a,c,b,m,d){if(d<a.length&&d<c.length&&a[d]==c[d]){if(c=Nb(a,c,b,m.lastChild,d+1))return m.copy(m.content.replaceChild(m.childCount-1,c));if(m.contentMatchAt(m.childCount).matchType(d==a.length-1?b.type:a[d+1]))return m.copy(m.content.append(X.Fragment.from(Ea(b,
a,d+1))))}}(b,d,a,k[k.length-1],0))?k[k.length-1]=c:(k.length&&(k[k.length-1]=function Pb(a,c){if(0==c)return a;c=a.content.replaceChild(a.childCount-1,Pb(a.lastChild,c-1));var b=a.contentMatchAt(a.childCount).fillBefore(X.Fragment.empty,!0);return a.copy(c.append(b))}(k[k.length-1],d.length)),a=Ea(a,b),k.push(a),m=m.matchType(a.type,a.attrs),d=b)}}),k)return{v:X.Fragment.from(k)}},m=c.depth;0<=m;m--){var d=b(m);if(d)return d.v}return a}(n.content,k),!1),a.someProp("transformPasted",function(a){n=
a(n)}),n}function Ea(a,c,b){void 0===b&&(b=0);for(var m=c.length-1;m>=b;m--)a=c[m].create(null,X.Fragment.from(a));return a}function W(a){a.someProp("handleDOMEvents",function(c){for(var b in c)a.eventHandlers[b]||a.dom.addEventListener(b,a.eventHandlers[b]=function(c){return La(a,c)})})}function La(a,c){return a.someProp("handleDOMEvents",function(b){b=b[c.type];return!!b&&(b(a,c)||c.defaultPrevented)})}function ra(a,c){var b=c.x-a.clientX;a=c.y-a.clientY;return 100>b*b+a*a}function na(a,c,b,d,k){if(-1==
d)return!1;var m=a.state.doc.resolve(d);d=function(d){if(a.someProp(c,function(c){return d>m.depth?c(a,b,m.nodeAfter,m.before(d),k,!0):c(a,b,m.node(d),m.before(d),k,!1)}))return{v:!0}};for(var n=m.depth+1;0<n;n--){var D=d(n);if(D)return D.v}return!1}function xa(a,c,b){a.focused||a.focus();c=a.state.tr.setSelection(c);"pointer"==b&&c.setMeta("pointer",!0);a.dispatch(c)}function Sa(a,c,b,d,k){return na(a,"handleClickOn",c,b,d)||a.someProp("handleClick",function(b){return b(a,c,d)})||(k?function(a,c){if(-1==
c)return!1;var b,m=a.state.selection;m instanceof ca.NodeSelection&&(b=m.node);c=a.state.doc.resolve(c);for(var d=c.depth+1;0<d;d--){var k=d>c.depth?c.nodeAfter:c.node(d);if(ca.NodeSelection.isSelectable(k)){var n=b&&0<m.$from.depth&&d>=m.$from.depth&&c.before(m.$from.depth+1)==m.$from.pos?c.before(m.$from.depth):c.before(d);break}}return null!=n&&(xa(a,ca.NodeSelection.create(a.state.doc,n),"pointer"),!0)}(a,b):function(a,c){if(-1==c)return!1;c=a.state.doc.resolve(c);var b=c.nodeAfter;return!!(b&&
b.isAtom&&ca.NodeSelection.isSelectable(b))&&(xa(a,new ca.NodeSelection(c),"pointer"),!0)}(a,b))}function Ta(a,c,b,d){return na(a,"handleTripleClickOn",c,b,d)||a.someProp("handleTripleClick",function(b){return b(a,c,d)})||function(a,c){var b=a.state.doc;if(-1==c)return!!b.inlineContent&&(xa(a,ca.TextSelection.create(b,0,b.content.size),"pointer"),!0);c=b.resolve(c);for(var m=c.depth+1;0<m;m--){var d=m>c.depth?c.nodeAfter:c.node(m),k=c.before(m);if(d.inlineContent)xa(a,ca.TextSelection.create(b,k+
1,k+1+d.content.size),"pointer");else{if(!ca.NodeSelection.isSelectable(d))continue;xa(a,ca.NodeSelection.create(b,k),"pointer")}return!0}}(a,b)}function ya(a){return!!a.inDOMChange&&(a.inDOMChange.finish(!0),!0)}function R(a,c,b,d){var m=da(a,c,b,a.shiftKey,a.state.selection.$from);if(!m)return!1;if(a.someProp("handlePaste",function(c){return c(a,d,m)}))return!0;c=(c=0==m.openStart&&0==m.openEnd&&1==m.content.childCount?m.content.firstChild:null)?a.state.tr.replaceSelectionWith(c,a.shiftKey):a.state.tr.replaceSelection(m);
return a.dispatch(c.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function fa(a,c){if(a==c)return!0;for(var b in a)if(a[b]!==c[b])return!1;for(var m in c)if(!(m in a))return!1;return!0}function a(a,c){if(!c||!a.length)return a;for(var b=[],m=0;m<a.length;m++){var d=a[m];b.push(new ha(d.from+c,d.to+c,d.type))}return b}function c(a,c,b){if(c.isLeaf)return null;c=b+c.nodeSize;for(var m=null,d=0,k=void 0;d<a.length;d++)(k=a[d])&&k.from>b&&k.to<c&&((m||(m=[])).push(k),a[d]=null);
return m}function n(a){for(var c=[],b=0;b<a.length;b++)null!=a[b]&&c.push(a[b]);return c}function K(b,m,d,w){var D=[],f=!1;m.forEach(function(a,m){var n=c(b,a,m+d);n&&(f=!0,n=K(n,a,d+m+1,w),n!=k&&D.push(m,m+a.nodeSize,n))});for(var g=a(f?n(b):b,-d).sort(Ha),S=0;S<g.length;S++)g[S].type.valid(m,g[S])||(w.onRemove&&w.onRemove(g[S].spec),g.splice(S--,1));return g.length||D.length?new L(g,D):k}function Ha(a,c){return a.from-c.from||a.to-c.to}function ab(a){for(var c=a,b=0;b<c.length-1;b++){var d=c[b];
if(d.from!=d.to)for(var k=b+1;k<c.length;k++){var n=c[k];if(n.from!=d.from){n.from<d.to&&(c==a&&(c=a.slice()),c[b]=d.copy(d.from,n.from),Ba(c,k,d.copy(n.from,d.to)));break}n.to!=d.to&&(c==a&&(c=a.slice()),c[k]=n.copy(n.from,d.to),Ba(c,k+1,n.copy(d.to,n.to)))}}return c}function Ba(a,c,b){for(;c<a.length&&0<Ha(b,a[c]);)c++;a.splice(c,0,b)}function Ja(a){var c=[];return a.someProp("decorations",function(b){(b=b(a.state))&&b!=k&&c.push(b)}),a.cursorWrapper&&c.push(L.create(a.state.doc,[a.cursorWrapper.deco])),
w.from(c)}function ma(a){var c=Object.create(null);return c.class="ProseMirror"+(a.focused?" ProseMirror-focused":""),c.contenteditable=String(a.editable),a.someProp("attributes",function(b){if("function"==typeof b&&(b=b(a.state)),b)for(var m in b)"class"==m?c.class+=" "+b[m]:c[m]||"contenteditable"==m||"nodeName"==m||(c[m]=String(b[m]))}),[ha.node(0,a.state.doc.content.size,c)]}function ea(a){var c=la(a.state);if(!c||V.ie&&a.mouseDown)a.cursorWrapper=null;else{var b,d=a.state.selection.visible,k=
a.state.storedMarks||c.marks();a.cursorWrapper&&X.Mark.sameSet(a.cursorWrapper.deco.spec.marks,k)&&"\ufeff"==a.cursorWrapper.dom.textContent&&a.cursorWrapper.deco.spec.visible==d?a.cursorWrapper.deco.pos!=c.pos&&(b=a.cursorWrapper.dom):(b=document.createElement("span"),b=(b.textContent="\ufeff",d||(b.style.position="absolute",b.style.left="-100000px"),b));b&&(a.cursorWrapper={dom:b,deco:ha.widget(c.pos,b,{isCursorWrapper:!0,marks:k,raw:!0,visible:d})})}}function qa(a){return!a.someProp("editable",
function(c){return!1===c(a.state)})}Object.defineProperty(p,"__esModule",{value:!0});var X=B(1585),ca=B(30),vb=B(782),V={};if("undefined"!=typeof navigator&&"undefined"!=typeof document){var lb=/Edge\/(\d+)/.exec(navigator.userAgent),bb=/MSIE \d/.test(navigator.userAgent),cb=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);V.mac=/Mac/.test(navigator.platform);var Wa=V.ie=!!(bb||cb||lb);V.ie_version=bb?document.documentMode||6:cb?+cb[1]:lb?+lb[1]:null;V.gecko=!Wa&&/gecko\/(\d+)/i.test(navigator.userAgent);
V.gecko_version=V.gecko&&+(/Firefox\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];var wb=!Wa&&/Chrome\/(\d+)/.exec(navigator.userAgent);V.chrome=!!wb;V.chrome_version=wb&&+wb[1];V.ios=!Wa&&/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent);V.android=/Android \d/.test(navigator.userAgent);V.webkit=!Wa&&"WebkitAppearance"in document.documentElement.style;V.safari=/Apple Computer/.test(navigator.vendor);V.webkit_version=V.webkit&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||
[0,0])[1]}var hb=function(a){for(var c=0;;c++)if(!(a=a.previousSibling))return c},Ab=function(a){return(a=a.parentNode)&&11==a.nodeType?a.host:a},kb=function(a,c,b){var m=document.createRange();return m.setEnd(a,null==b?a.nodeValue.length:b),m.setStart(a,c||0),m},Cb=function(a,c,b,d){return b&&(M(a,c,b,d,-1)||M(a,c,b,d,1))},Hb=/^(img|br|input|textarea|hr)$/i,tb=function(a){var c=a.isCollapsed;return c&&V.chrome&&a.rangeCount&&!a.getRangeAt(0).collapsed&&(c=!1),c},oa=/[\u0590-\u08ac]/,Qa=null,Za=null,
Bb=!1,pa=function(a,c,b,d){this.parent=a;this.children=c;this.dom=b;b.pmViewDesc=this;this.contentDOM=d;this.dirty=0},Oa={beforePosition:{},size:{},border:{},posBefore:{},posAtStart:{},posAfter:{},posAtEnd:{},contentLost:{}};pa.prototype.matchesWidget=function(){return!1};pa.prototype.matchesMark=function(){return!1};pa.prototype.matchesNode=function(){return!1};pa.prototype.matchesHack=function(){return!1};Oa.beforePosition.get=function(){return!1};pa.prototype.parseRule=function(){return null};
pa.prototype.stopEvent=function(){return!1};Oa.size.get=function(){for(var a=0,c=0;c<this.children.length;c++)a+=this.children[c].size;return a};Oa.border.get=function(){return 0};pa.prototype.destroy=function(){this.parent=null;this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=null);for(var a=0;a<this.children.length;a++)this.children[a].destroy()};pa.prototype.posBeforeChild=function(a){for(var c=0,b=this.posAtStart;c<this.children.length;c++){var d=this.children[c];if(d==a)return b;b+=d.size}};Oa.posBefore.get=
function(){return this.parent.posBeforeChild(this)};Oa.posAtStart.get=function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0};Oa.posAfter.get=function(){return this.posBefore+this.size};Oa.posAtEnd.get=function(){return this.posAtStart+this.size-2*this.border};pa.prototype.localPosFromDOM=function(a,c,b){if(this.contentDOM&&this.contentDOM.contains(1==a.nodeType?a:a.parentNode)){if(0>b){var m;if(a==this.contentDOM)b=a.childNodes[c-1];else{for(;a.parentNode!=this.contentDOM;)a=
a.parentNode;b=a.previousSibling}for(;b&&(!(m=b.pmViewDesc)||m.parent!=this);)b=b.previousSibling;return b?this.posBeforeChild(m)+m.size:this.posAtStart}var d;if(a==this.contentDOM)b=a.childNodes[c];else{for(;a.parentNode!=this.contentDOM;)a=a.parentNode;b=a.nextSibling}for(;b&&(!(d=b.pmViewDesc)||d.parent!=this);)b=b.nextSibling;return b?this.posBeforeChild(d):this.posAtEnd}if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))var k=2&a.compareDocumentPosition(this.contentDOM);
else if(this.dom.firstChild){if(0==c)for(m=a;;m=m.parentNode){if(m==this.dom){k=!1;break}if(m.parentNode.firstChild!=m)break}if(null==k&&c==a.childNodes.length)for(;;a=a.parentNode){if(a==this.dom){k=!0;break}if(a.parentNode.lastChild!=a)break}}return(null==k?0<b:k)?this.posAtEnd:this.posAtStart};pa.prototype.nearestDesc=function(a,c){for(var b=!0,m=a;m;m=m.parentNode){var d=this.getDesc(m);if(d&&(!c||d.node)){if(!b||!d.nodeDOM||(1==d.nodeDOM.nodeType?d.nodeDOM.contains(a):d.nodeDOM==a))return d;
b=!1}}};pa.prototype.getDesc=function(a){for(var c=a=a.pmViewDesc;c;c=c.parent)if(c==this)return a};pa.prototype.posFromDOM=function(a,c,b){for(var m=a;;m=m.parentNode){var d=this.getDesc(m);if(d)return d.localPosFromDOM(a,c,b)}};pa.prototype.descAt=function(a){for(var c=0,b=0;c<this.children.length;c++){var d=this.children[c],k=b+d.size;if(b==a&&k!=b){for(;!d.border&&d.children.length;)d=d.children[0];return d}if(a<k)return d.descAt(a-b-d.border);b=k}};pa.prototype.domFromPos=function(a){if(!this.contentDOM)return{node:this.dom,
offset:0};for(var c=0,b=0;;b++){if(c==a){for(;b<this.children.length&&this.children[b].beforePosition;)b++;return{node:this.contentDOM,offset:b}}if(b==this.children.length)throw Error("Invalid position "+a);var d=this.children[b],k=c+d.size;if(a<k)return d.domFromPos(a-c-d.border);c=k}};pa.prototype.parseRange=function(a,c,b){if(void 0===b&&(b=0),0==this.children.length)return{node:this.contentDOM,from:a,to:c,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var m=-1,d=-1,k=0,n=0;;n++){var w=
this.children[n],f=k+w.size;if(-1==m&&a<=f){var D=k+w.border;if(a>=D&&c<=f-w.border&&w.node&&w.contentDOM&&this.contentDOM.contains(w.contentDOM))return w.parseRange(a-D,c-D,b+D);a=b+k;for(k=n;0<k;k--){w=this.children[k-1];if(w.size&&w.dom.parentNode==this.contentDOM&&!w.emptyChildAt(1)){m=hb(w.dom)+1;break}a-=w.size}-1==m&&(m=0)}if(-1<m&&c<=f){c=b+f;for(b=n+1;b<this.children.length;b++){n=this.children[b];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(-1)){d=hb(n.dom);break}c+=n.size}-1==
d&&(d=this.contentDOM.childNodes.length);break}k=f}return{node:this.contentDOM,from:a,to:c,fromOffset:m,toOffset:d}};pa.prototype.emptyChildAt=function(a){if(this.border||!this.contentDOM||!this.children.length)return!1;var c=this.children[0>a?0:this.children.length-1];return 0==c.size||c.emptyChildAt(a)};pa.prototype.domAfterPos=function(a){var c=this.domFromPos(a),b=c.node;c=c.offset;if(1!=b.nodeType||c==b.childNodes.length)throw new RangeError("No node after pos "+a);return b.childNodes[c]};pa.prototype.setSelection=
function(a,c,b){for(var d=Math.min(a,c),m=Math.max(a,c),k=0,n=0;k<this.children.length;k++){var w=this.children[k],f=n+w.size;if(d>n&&m<f)return w.setSelection(a-n-w.border,c-n-w.border,b);n=f}d=this.domFromPos(a);m=this.domFromPos(c);b=b.getSelection();k=document.createRange();Cb(d.node,d.offset,b.anchorNode,b.anchorOffset)&&Cb(m.node,m.offset,b.focusNode,b.focusOffset)||(b.extend?(k.setEnd(d.node,d.offset),k.collapse(!1)):(a>c&&(m=d=m),k.setEnd(m.node,m.offset),k.setStart(d.node,d.offset)),b.removeAllRanges(),
b.addRange(k),b.extend&&b.extend(m.node,m.offset))};pa.prototype.ignoreMutation=function(a){return!this.contentDOM};Oa.contentLost.get=function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)};pa.prototype.markDirty=function(a,c){for(var b=0,d=0;d<this.children.length;d++){var m=this.children[d],k=b+m.size;if(b==k?a<=k&&c>=b:a<k&&c>b){var n=b+m.border,w=k-m.border;if(a>=n&&c<=w)return this.dirty=a==b||c==k?2:1,void(a==n&&c==w&&m.contentLost?m.dirty=3:m.markDirty(a-
n,c-n));m.dirty=3}b=k}this.dirty=2};Object.defineProperties(pa.prototype,Oa);var Na=[],Db=function(a){function c(c,b,d,m){var k=b.type.toDOM;("function"==typeof k&&(k=k(d,function(){return n?n.parent?n.parent.posBeforeChild(n):void 0:m})),b.type.spec.raw)||(1!=k.nodeType&&(d=document.createElement("span"),d.appendChild(k),k=d),k.contentEditable=!1,k.classList.add("ProseMirror-widget"));a.call(this,c,Na,k,null);this.widget=b;var n=this}a&&(c.__proto__=a);c.prototype=Object.create(a&&a.prototype);c.prototype.constructor=
c;var b={beforePosition:{}};return b.beforePosition.get=function(){return 0>this.widget.type.side},c.prototype.matchesWidget=function(a){return 0==this.dirty&&a.type.eq(this.widget.type)},c.prototype.parseRule=function(){return{ignore:!0}},c.prototype.stopEvent=function(a){var c=this.widget.spec.stopEvent;return!!c&&c(a)},Object.defineProperties(c.prototype,b),c}(pa),Jb=function(a){function c(){a.apply(this,arguments)}return a&&(c.__proto__=a),c.prototype=Object.create(a&&a.prototype),c.prototype.constructor=
c,c.prototype.parseRule=function(){for(var c,b=this.dom.firstChild;b;b=b.nextSibling){if(3==b.nodeType){var d=b.nodeValue.replace(/\ufeff/g,"");if(!d)continue;d=document.createTextNode(d)}else{if("\ufeff"==b.textContent)continue;d=b.cloneNode(!0)}c||(c=document.createDocumentFragment());c.appendChild(d)}return c?{skip:c}:a.prototype.parseRule.call(this)},c.prototype.ignoreMutation=function(){return!1},c}(Db),Eb=function(a){function c(c,b,d,m){a.call(this,c,[],d,m);this.mark=b}return a&&(c.__proto__=
a),c.prototype=Object.create(a&&a.prototype),c.prototype.constructor=c,c.create=function(a,b,d,m){var k=ja(m)[b.type.name];m=k&&k(b,m);return m&&m.dom||(m=X.DOMSerializer.renderSpec(document,b.type.spec.toDOM(b,d))),new c(a,b,m.dom,m.contentDOM||m.dom)},c.prototype.parseRule=function(){return{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}},c.prototype.matchesMark=function(a){return 3!=this.dirty&&this.mark.eq(a)},c.prototype.markDirty=function(c,b){if(a.prototype.markDirty.call(this,
c,b),0!=this.dirty){for(c=this.parent;!c.node;)c=c.parent;c.dirty<this.dirty&&(c.dirty=this.dirty);this.dirty=0}},c}(pa),Ma=function(a){function c(c,b,d,m,k,n,w,f,g){a.call(this,c,b.isLeaf?Na:[],k,n);this.nodeDOM=w;this.node=b;this.outerDeco=d;this.innerDeco=m;n&&this.updateChildren(f,g)}a&&(c.__proto__=a);c.prototype=Object.create(a&&a.prototype);c.prototype.constructor=c;var b={size:{},border:{}};return c.create=function(a,b,d,m,k,n){var w,f=ja(k)[b.type.name],g=(f=f&&f(b,k,function(){return w?
w.parent?w.parent.posBeforeChild(w):void 0:n},d))&&f.dom,D=f&&f.contentDOM;if(b.isText)if(g){if(3!=g.nodeType)throw new RangeError("Text must be rendered as a DOM text node");}else g=document.createTextNode(b.text);else g||(g=(D=X.DOMSerializer.renderSpec(document,b.type.spec.toDOM(b))).dom,D=D.contentDOM);D||b.isText||"BR"==g.nodeName||(g.contentEditable=!1,b.type.spec.draggable&&(g.draggable=!0));var K=g;return g=v(g,g,$a,q(d,b,1!=g.nodeType)),f?w=new Xa(a,b,d,m,g,D,K,f,k):b.isText?new Fb(a,b,d,
m,g,K,k):new c(a,b,d,m,g,D,K,k,n+1)},c.prototype.parseRule=function(){var a=this;if(this.node.type.spec.reparseInView)return null;var c={node:this.node.type.name,attrs:this.node.attrs};return this.node.type.spec.code&&(c.preserveWhitespace="full"),this.contentDOM&&!this.contentLost?c.contentElement=this.contentDOM:c.getContent=function(){return a.contentDOM?X.Fragment.empty:a.node.content},c},c.prototype.matchesNode=function(a,c,b){return 0==this.dirty&&a.eq(this.node)&&Q(c,this.outerDeco)&&b.eq(this.innerDeco)},
b.size.get=function(){return this.node.nodeSize},b.border.get=function(){return this.node.isLeaf?0:1},c.prototype.updateChildren=function(a,c){var b=this,d=new Ka(this),m=this.node.inlineContent;!function(a,c,b,d){var m=c.locals(a),k=0;if(0==m.length)for(b=0;b<a.childCount;b++){var n=a.child(b);d(n,m,c.forChild(k,n),b);k+=n.nodeSize}else{n=0;for(var w=[],f=null,g=0;;){if(n<m.length&&m[n].to==k){for(var D=m[n++],K=void 0;n<m.length&&m[n].to==k;)(K||(K=[D])).push(m[n++]);if(K)for(K.sort(C),D=0;D<K.length;D++)b(K[D],
g);else b(D,g)}if(f)K=f,f=null;else{if(!(g<a.childCount))break;K=a.child(g++)}for(D=0;D<w.length;D++)w[D].to<=k&&w.splice(D--,1);for(;n<m.length&&m[n].from==k;)w.push(m[n++]);D=k+K.nodeSize;if(K.isText){var J=D;n<m.length&&m[n].from<J&&(J=m[n].from);for(var L=0;L<w.length;L++)w[L].to<J&&(J=w[L].to);J<D&&(f=K.cut(J-k),K=K.cut(0,J-k),D=J)}d(K,w.length?w.slice():Na,c.forChild(k,K),g-1);k=D}}}(this.node,this.innerDeco,function(k,n){k.spec.marks?d.syncToMarks(k.spec.marks,m,a):0<=k.type.side&&d.syncToMarks(n==
b.node.childCount?X.Mark.none:b.node.child(n).marks,m,a);d.placeWidget(k,a,c)},function(b,k,n,w){d.syncToMarks(b.marks,m,a);d.findNodeMatch(b,k,n,w)||d.updateNextNode(b,k,n,a,w)||d.addNode(b,k,n,a,c);c+=b.nodeSize});d.syncToMarks(Na,m,a);this.node.isTextblock&&d.addTextblockHacks();d.destroyRest();(d.changed||2==this.dirty)&&this.renderChildren()},c.prototype.renderChildren=function(){!function Kb(a,c){for(var b=a.firstChild,d=0;d<c.length;d++){var m=c[d],k=m.dom;if(k.parentNode==a){for(;k!=b;)b=
A(b);b=b.nextSibling}else a.insertBefore(k,b);m instanceof Eb&&(b=b?b.previousSibling:a.lastChild,Kb(m.contentDOM,m.children),b=b?b.nextSibling:a.firstChild)}for(;b;)b=A(b)}(this.contentDOM,this.children,c.is);V.ios&&function(a){if("UL"==a.nodeName||"OL"==a.nodeName){var c=a.style.cssText;a.style.cssText=c+"; list-style: square !important";window.getComputedStyle(a).listStyle;a.style.cssText=c}}(this.dom)},c.prototype.update=function(a,c,b,d){return!(3==this.dirty||!a.sameMarkup(this.node))&&(this.updateInner(a,
c,b,d),!0)},c.prototype.updateInner=function(a,c,b,d){this.updateOuterDeco(c);this.node=a;this.innerDeco=b;this.contentDOM&&this.updateChildren(d,this.posAtStart);this.dirty=0},c.prototype.updateOuterDeco=function(a){if(!Q(a,this.outerDeco)){var c=1!=this.nodeDOM.nodeType,b=this.dom;this.dom=v(this.dom,this.nodeDOM,q(this.outerDeco,this.node,c),q(a,this.node,c));this.dom!=b&&(b.pmViewDesc=null,this.dom.pmViewDesc=this);this.outerDeco=a}},c.prototype.selectNode=function(){this.nodeDOM.classList.add("ProseMirror-selectednode")},
c.prototype.deselectNode=function(){this.nodeDOM.classList.remove("ProseMirror-selectednode")},Object.defineProperties(c.prototype,b),c}(pa),Fb=function(a){function c(c,b,d,m,k,n,w){a.call(this,c,b,d,m,k,null,n,w)}return a&&(c.__proto__=a),c.prototype=Object.create(a&&a.prototype),c.prototype.constructor=c,c.prototype.parseRule=function(){var a=this.nodeDOM.parentNode;return a?{skip:a}:{ignore:!0}},c.prototype.update=function(a,c){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!a.sameMarkup(this.node))&&
(this.updateOuterDeco(c),0==this.dirty&&a.text==this.node.text||a.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=a.text),this.node=a,this.dirty=0,!0)},c.prototype.inParent=function(){for(var a=this.parent.contentDOM,c=this.nodeDOM;c;c=c.parentNode)if(c==a)return!0;return!1},c.prototype.domFromPos=function(a){return{node:this.nodeDOM,offset:a}},c.prototype.localPosFromDOM=function(c,b,d){return c==this.nodeDOM?this.posAtStart+Math.min(b,this.node.text.length):a.prototype.localPosFromDOM.call(this,
c,b,d)},c.prototype.ignoreMutation=function(a){return"characterData"!=a.type},c}(Ma),Ib=function(a){function c(){a.apply(this,arguments)}return a&&(c.__proto__=a),c.prototype=Object.create(a&&a.prototype),c.prototype.constructor=c,c.prototype.parseRule=function(){return{ignore:!0}},c.prototype.matchesHack=function(){return 0==this.dirty},c}(pa),Xa=function(a){function c(c,b,d,m,k,n,w,f,g){a.call(this,c,b,d,m,k,n,w,g);this.spec=f}return a&&(c.__proto__=a),c.prototype=Object.create(a&&a.prototype),
c.prototype.constructor=c,c.prototype.update=function(c,b,d,m){if(3==this.dirty)return!1;if(this.spec.update){var k=this.spec.update(c,b);return k&&this.updateInner(c,b,d,m),k}return!(!this.contentDOM&&!c.isLeaf)&&a.prototype.update.call(this,c,b,d,m)},c.prototype.selectNode=function(){this.spec.selectNode?this.spec.selectNode():a.prototype.selectNode.call(this)},c.prototype.deselectNode=function(){this.spec.deselectNode?this.spec.deselectNode():a.prototype.deselectNode.call(this)},c.prototype.setSelection=
function(c,b,d){this.spec.setSelection?this.spec.setSelection(c,b,d):a.prototype.setSelection.call(this,c,b,d)},c.prototype.destroy=function(){this.spec.destroy&&this.spec.destroy();a.prototype.destroy.call(this)},c.prototype.stopEvent=function(a){return!!this.spec.stopEvent&&this.spec.stopEvent(a)},c.prototype.ignoreMutation=function(c){return this.spec.ignoreMutation?this.spec.ignoreMutation(c):a.prototype.ignoreMutation.call(this,c)},c}(Ma);x.prototype=Object.create(null);var $a=[new x],ib,Va,
Ka=function(a){this.top=a;this.index=0;this.stack=[];this.changed=!1;var c=a.node.content;a=a.children;for(var b=[],d=c.childCount,k=a.length-1;0<d&&0<=k;k--){var n=a[k],w=n.node;if(w){if(w!=c.child(d-1))break;b[--d]=n}}this.preMatched=b};Ka.prototype.destroyBetween=function(a,c){if(a!=c){for(var b=a;b<c;b++)this.top.children[b].destroy();this.top.children.splice(a,c-a);this.changed=!0}};Ka.prototype.destroyRest=function(){this.destroyBetween(this.index,this.top.children.length)};Ka.prototype.syncToMarks=
function(a,c,b){for(var d,m=0,k=this.stack.length>>1,n=Math.min(k,a.length);m<n&&(m==k-1?this.top:this.stack[m+1<<1]).matchesMark(a[m]);)m++;for(;m<k;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),k--;for(;k<a.length;)(this.stack.push(this.top,this.index+1),this.index<this.top.children.length&&(d=this.top.children[this.index]).matchesMark(a[k]))?this.top=d:(m=Eb.create(this.top,a[k],c,b),this.top.children.splice(this.index,0,m),this.top=m,this.changed=!0),
this.index=0,k++};Ka.prototype.findNodeMatch=function(a,c,b,d){for(var m=this.index,k=this.top.children,n=Math.min(k.length,m+5);m<n;m++){var w=k[m],f=void 0;if(w.matchesNode(a,c,b)&&(-1==(f=this.preMatched.indexOf(w))||f==d))return this.destroyBetween(this.index,m),this.index++,!0}return!1};Ka.prototype.updateNextNode=function(a,c,b,d,k){if(this.index==this.top.children.length)return!1;var m=this.top.children[this.index];if(m instanceof Ma){var n=this.preMatched.indexOf(m);if(-1<n&&n!=k)return!1;
k=m.dom;if(m.update(a,c,b,d))return m.dom!=k&&(this.changed=!0),this.index++,!0}return!1};Ka.prototype.addNode=function(a,c,b,d,k){this.top.children.splice(this.index++,0,Ma.create(this.top,a,c,b,d,k));this.changed=!0};Ka.prototype.placeWidget=function(a,c,b){this.index<this.top.children.length&&this.top.children[this.index].matchesWidget(a)?this.index++:(a=new (a.spec.isCursorWrapper?Jb:Db)(this.top,a,c,b),this.top.children.splice(this.index++,0,a),this.changed=!0)};Ka.prototype.addTextblockHacks=
function(){for(var a=this.top.children[this.index-1];a instanceof Eb;)a=a.children[a.children.length-1];a&&a instanceof Fb&&!/\n$/.test(a.node.text)||(this.index<this.top.children.length&&this.top.children[this.index].matchesHack()?this.index++:(a=document.createElement("br"),this.top.children.splice(this.index++,0,new Ib(this.top,Na,a,null)),this.changed=!0))};var mb=function(a,c,b){this.prev=a;this.mapping=c;this.state=b},sa=function(a){this.seen=[new mb(null,null,a)];ca.EditorState.addApplyListener(this.track=
this.track.bind(this))};sa.prototype.destroy=function(){ca.EditorState.removeApplyListener(this.track)};sa.prototype.find=function(a){for(var c=this.seen.length-1;0<=c;c--){var b=this.seen[c];if(b.state==a)return b}};sa.prototype.track=function(a,c,b){(a=200>this.seen.length?this.find(a):null)&&this.seen.push(new mb(a,c.docChanged?c.mapping:null,b))};sa.prototype.getMapping=function(a,c){var b=this.find(a);if(!b)return null;for(a=[];b;b=b.prev)b.mapping&&a.push(b.mapping);c=c||new vb.Mapping;for(b=
a.length-1;0<=b;b--)c.appendMapping(a[b]);return c};var Ya=function(a){var c=this;this.view=a;this.lastAnchorNode=this.lastHeadNode=this.lastAnchorOffset=this.lastHeadOffset=null;this.lastSelection=a.state.selection;this.suppressUpdates=this.ignoreUpdates=!1;this.poller=new ("onselectionchange"in document?nb:ob)(this);a.dom.addEventListener("focus",function(){return c.poller.start(E(c.view))});a.dom.addEventListener("blur",function(){return c.poller.stop()});a.editable||this.poller.start(!1)};Ya.prototype.destroy=
function(){this.poller.stop()};Ya.prototype.poll=function(a){this.poller.poll(a)};Ya.prototype.editableChanged=function(){this.view.editable?E(this.view)||this.poller.stop():this.poller.start()};Ya.prototype.domChanged=function(){var a=this.view.root.getSelection();return a.anchorNode!=this.lastAnchorNode||a.anchorOffset!=this.lastAnchorOffset||a.focusNode!=this.lastHeadNode||a.focusOffset!=this.lastHeadOffset};Ya.prototype.storeDOMState=function(a){var c=this.view.root.getSelection();this.lastAnchorNode=
c.anchorNode;this.lastAnchorOffset=c.anchorOffset;this.lastHeadNode=c.focusNode;this.lastHeadOffset=c.focusOffset;this.lastSelection=a};Ya.prototype.clearDOMState=function(){this.lastAnchorNode=this.lastSelection=null};Ya.prototype.readFromDOM=function(a){if(!this.ignoreUpdates&&this.domChanged()&&E(this.view)){if(this.suppressUpdates)return b(this.view);if(this.view.inDOMChange||this.view.domObserver.flush(),!this.view.inDOMChange){var c=this.view.root.getSelection();var d=this.view.state.doc,k=
this.view.docView.nearestDesc(c.focusNode),n=k&&0==k.size,w=this.view.docView.posFromDOM(c.focusNode,c.focusOffset),f=d.resolve(w);if(tb(c)){for(c=f;k&&!k.node;)k=k.parent;if(k&&k.node.isAtom&&ca.NodeSelection.isSelectable(k.node)&&k.parent){var g=k.posBefore;g=new ca.NodeSelection(w==g?f:d.resolve(g))}}else c=d.resolve(this.view.docView.posFromDOM(c.anchorNode,c.anchorOffset));g||(g=t(this.view,c,f,"pointer"==a||this.view.state.selection.head<f.pos&&!n?1:-1));this.view.state.selection.eq(g)?b(this.view):
(d=this.view.state.tr.setSelection(g),"pointer"==a&&d.setMeta("pointer",!0),this.view.dispatch(d))}}};var nb=function(a){var c=this;this.listening=!1;this.curOrigin=null;this.originTime=0;this.reader=a;this.readFunc=function(){return a.readFromDOM(c.originTime>Date.now()-50?c.curOrigin:null)}};nb.prototype.poll=function(a){this.curOrigin=a;this.originTime=Date.now()};nb.prototype.start=function(a){this.listening||(this.reader.view.dom.ownerDocument.addEventListener("selectionchange",this.readFunc),
this.listening=!0,a&&this.readFunc())};nb.prototype.stop=function(){this.listening&&(this.reader.view.dom.ownerDocument.removeEventListener("selectionchange",this.readFunc),this.listening=!1)};var ob=function(a){this.polling=null;this.reader=a;this.pollFunc=this.doPoll.bind(this,null)};ob.prototype.doPoll=function(a){var c=this.reader.view;c.focused||!c.editable?(this.reader.readFromDOM(a),this.polling=setTimeout(this.pollFunc,100)):this.polling=null};ob.prototype.poll=function(a){clearTimeout(this.polling);
this.polling=setTimeout(a?this.doPoll.bind(this,a):this.pollFunc,0)};ob.prototype.start=function(){null==this.polling&&this.poll()};ob.prototype.stop=function(){clearTimeout(this.polling);this.polling=null};var ub=V.safari||V.chrome&&63>V.chrome_version,ta=function za(a,c){var b=this;this.view=a;this.state=a.state;this.composing=c;this.from=this.to=null;this.typeOver=!1;this.timeout=c?null:setTimeout(function(){return b.finish()},za.commitTimeout);this.trackMappings=new sa(a.state);this.mapping=new vb.Mapping;
this.mappingTo=a.state};ta.prototype.addRange=function(a,c){null==this.from?(this.from=a,this.to=c):(this.from=Math.min(a,this.from),this.to=Math.max(c,this.to))};ta.prototype.changedRange=function(){if(null==this.from){a:{var a=this.state.selection;var c=a.$anchor.min(a.$head);a=a.$anchor.max(a.$head);if(c.sameParent(a)&&c.parent.inlineContent&&c.parentOffset&&a.parentOffset<a.parent.content.size){var b=Math.max(0,c.parentOffset),d=c.parent.content.size;a=Math.min(d,a.parentOffset);if(0<b&&(b=c.parent.childBefore(b).offset),
a<d)a=c.parent.childAfter(a),a=a.offset+a.node.nodeSize;c=c.start();c={from:c+b,to:c+a}}else for(b=0;;b++){b:{d=c;for(var k=b+1||0;k<d.depth;k++)if(0<d.index(0)){d=!1;break b}d=0==d.parentOffset}b:{k=a;for(var n=b+1||0;n<k.depth;n++)if(k.index(n)+1<k.node(n).childCount){var w=!1;break b}w=k.parentOffset==k.parent.content.size}if(d||w||c.index(b)!=a.index(b)||a.node(b).isTextblock){k=c.before(b+1);n=a.after(b+1);c=(d&&0<c.index(b)&&(k-=c.node(b).child(c.index(b)-1).nodeSize),w&&a.index(b)+1<a.node(b).childCount&&
(n+=a.node(b).child(a.index(b)+1).nodeSize),{from:k,to:n});break a}}}return c}c=this.state.doc.resolve(Math.min(this.from,this.state.selection.from));a=this.state.doc.resolve(this.to);b=c.sharedDepth(this.to);return{from:c.before(b+1),to:a.after(b+1)}};ta.prototype.markDirty=function(a){null==this.from?this.view.docView.markDirty((a=a||this.changedRange()).from,a.to):this.view.docView.markDirty(this.from,this.to)};ta.prototype.stateUpdated=function(a){return this.trackMappings.getMapping(a,this.mapping)?
(this.trackMappings.destroy(),this.trackMappings=new sa(a),this.mappingTo=a,!0):(this.markDirty(),this.destroy(),!1)};ta.prototype.finish=function(a){if(clearTimeout(this.timeout),!this.composing||a){this.view.domObserver.flush();a=this.changedRange();this.markDirty(a);this.destroy();var c=this.state.selection;c=this.typeOver&&c instanceof ca.TextSelection&&!c.empty&&c.$head.sameParent(c.$anchor);!function(a,c,b,d,k){var m,n;d=function(a,c,b){var d=a.docView.parseRange(b.from,b.to),k=d.node,m=d.fromOffset,
n=d.toOffset;b=d.from;d=d.to;var w=a.root.getSelection(),f=null,g=w.anchorNode;g&&a.dom.contains(1==g.nodeType?g:g.parentNode)&&(f=[{node:g,offset:w.anchorOffset}],tb(w)||f.push({node:w.focusNode,offset:w.focusOffset}));if(V.chrome&&8===a.lastKeyCode)for(w=n;w>m;w--){g=k.childNodes[w-1];var K=g.pmViewDesc;if("BR"==g.nodeType&&!K){n=w;break}if(!K||K.size)break}c=c.doc;a=a.someProp("domParser")||X.DOMParser.fromSchema(a.state.schema);w=c.resolve(b);c=null;k=a.parse(k,{topNode:w.parent,topMatch:w.parent.contentMatchAt(w.index()),
topOpen:!0,from:m,to:n,preserveWhitespace:!w.parent.type.spec.code||"full",editableContent:!0,findPositions:f,ruleFromNode:Ua(a,w),context:w});f&&null!=f[0].pos&&(m=f[0].pos,f=f[1]&&f[1].pos,null==f&&(f=m),c={anchor:m+b,head:f+b});return{doc:k,sel:c,from:b,to:d}}(a,b,d);var w=b.doc,f=w.slice(d.from,d.to);8===a.lastKeyCode&&Date.now()-100<a.lastKeyCodeTime?(m=b.selection.to,n="end"):(m=b.selection.from,n="start");a.lastKeyCode=null;if(m=function(a,c,b,d,k){var m=a.findDiffStart(c,b);if(null==m)return null;
var n=a.findDiffEnd(c,b+a.size,b+c.size);b=n.a;n=n.b;"end"==k&&(d-=b+Math.max(0,m-Math.min(b,n))-m);b<m&&a.size<c.size?(n=(m-=d<=m&&d>=b?m-d:0)+(n-b),b=m):n<m&&(b=(m-=d<=m&&d>=n?m-d:0)+(b-n),n=m);return{start:m,endA:b,endB:n}}(f.content,d.doc.content,d.from,m,n)){var g;k=d.doc.resolveNoCache(m.start-d.from);n=d.doc.resolveNoCache(m.endB-d.from);if(!(!k.sameParent(n)&&k.pos<d.doc.content.size&&(g=ca.Selection.findFrom(d.doc.resolve(k.pos+1),1,!0))&&g.head==n.pos&&a.someProp("handleKeyDown",function(c){return c(a,
Ia(13,"Enter"))}))){if(b.selection.anchor>m.start&&function(a,c,b,d,k){if(!d.parent.isTextblock||b-c<=k.pos-d.pos||H(d,!0,!1)<k.pos)return!1;c=a.resolve(c);if(c.parentOffset<c.parent.content.size||!c.parent.isTextblock)return!1;a=a.resolve(H(c,!0,!0));return!a.parent.isTextblock||a.pos>b||H(a,!0,!1)<b?!1:d.parent.content.cut(d.parentOffset).eq(a.parent.content)}(w,m.start,m.endA,k,n)&&a.someProp("handleKeyDown",function(c){return c(a,Ia(8,"Backspace"))}))return void(V.android&&V.chrome&&(a.selectionReader.suppressUpdates=
!0,setTimeout(function(){return a.selectionReader.suppressUpdates=!1},50)));var K,J,L=c.map(m.start),e=c.map(m.endA,-1);if(k.sameParent(n)&&k.parent.inlineContent)if(k.pos==n.pos){var D=a.state.tr.delete(L,e);var h=w.resolve(m.start).marksAcross(w.resolve(m.endA))}else if(m.endA==m.endB&&(J=w.resolve(m.start))&&(K=function(a,c){var b=a.firstChild.marks;var d=c.firstChild.marks;var k=b;for(var m=d,n=0;n<d.length;n++)k=d[n].removeFromSet(k);for(d=0;d<b.length;d++)m=b[d].removeFromSet(m);if(1==k.length&&
0==m.length){var w=k[0];b="add";k=function(a){return a.mark(w.addToSet(a.marks))}}else{if(0!=k.length||1!=m.length)return null;w=m[0];b="remove";k=function(a){return a.mark(w.removeFromSet(a.marks))}}m=[];for(d=0;d<c.childCount;d++)m.push(k(c.child(d)));if(X.Fragment.from(m).eq(a))return{mark:w,type:b}}(k.parent.content.cut(k.parentOffset,n.parentOffset),J.parent.content.cut(J.parentOffset,m.endA-J.start()))))D=a.state.tr,"add"==K.type?D.addMark(L,e,K.mark):D.removeMark(L,e,K.mark);else if(k.parent.child(k.index()).isText&&
k.index()==n.index()-(n.textOffset?0:1)){var l=k.parent.textBetween(k.parentOffset,n.parentOffset);if(a.someProp("handleTextInput",function(c){return c(a,L,e,l)}))return;D=a.state.tr.insertText(l,L,e)}D||(D=a.state.tr.replace(L,e,d.doc.slice(m.start-d.from,m.endB-d.from)));d.sel&&(c=gb(a,D.doc,c,d.sel))&&D.setSelection(c);h&&D.ensureMarks(h);a.dispatch(D.scrollIntoView())}}else k?(D=a.state,h=D.selection,a.dispatch(D.tr.replaceSelectionWith(D.schema.text(D.doc.textBetween(h.from,h.to)),!0).scrollIntoView())):
d.sel&&(D=gb(a,a.state.doc,c,d.sel))&&!D.eq(a.state.selection)&&a.dispatch(a.state.tr.setSelection(D))}(this.view,this.mapping,this.state,a,c);this.view.docView.dirty&&this.view.updateState(this.view.state)}};ta.prototype.destroy=function(){clearTimeout(this.timeout);this.trackMappings.destroy();this.view.inDOMChange=null};ta.prototype.compositionEnd=function(){var a=this;this.composing&&(this.composing=!1,this.timeout=setTimeout(function(){return a.finish()},50))};ta.start=function(a,c){return a.inDOMChange?
c&&(clearTimeout(a.inDOMChange.timeout),a.inDOMChange.composing=!0):a.inDOMChange=new ta(a,c),a.inDOMChange};ta.commitTimeout=20;var Fa={thead:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},Ga=null,pb={childList:!0,characterData:!0,attributes:!0,subtree:!0,characterDataOldValue:!0},qb=V.ie&&11>=V.ie_version,jb=function(a){var c=this;this.view=a;this.observer=window.MutationObserver&&new window.MutationObserver(function(a){return c.registerMutations(a)});
qb&&(this.onCharData=function(a){return c.registerMutation({target:a.target,type:"characterData",oldValue:a.prevValue})})};jb.prototype.start=function(){this.observer&&this.observer.observe(this.view.dom,pb);qb&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData)};jb.prototype.stop=function(){this.observer&&(this.flush(),this.observer.disconnect());qb&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData)};jb.prototype.flush=function(){this.observer&&
this.registerMutations(this.observer.takeRecords())};jb.prototype.registerMutations=function(a){for(var c=0;c<a.length;c++)this.registerMutation(a[c])};jb.prototype.registerMutation=function(a){if(this.view.editable){var c=this.view.docView.nearestDesc(a.target);if(("attributes"!=a.type||c!=this.view.docView&&"contenteditable"!=a.attributeName)&&c&&!c.ignoreMutation(a)){if("childList"==a.type){var b=a.previousSibling&&a.previousSibling.parentNode==a.target?hb(a.previousSibling)+1:0;if(-1==b)return;
b=c.localPosFromDOM(a.target,b,-1);var d=a.nextSibling&&a.nextSibling.parentNode==a.target?hb(a.nextSibling):a.target.childNodes.length;if(-1==d)return;d=c.localPosFromDOM(a.target,d,1)}else"attributes"==a.type?(b=c.posAtStart-c.border,d=c.posAtEnd+c.border):(b=c.posAtStart,d=c.posAtEnd,a.target.nodeValue==a.oldValue&&(ta.start(this.view).typeOver=!0));ta.start(this.view).addRange(b,d)}}};var Aa={},wa={keydown:function(a,c){if(a.shiftKey=16==c.keyCode||c.shiftKey,a.inDOMChange){if(a.inDOMChange.composing)return;
a.inDOMChange.finish()}a.lastKeyCode=c.keyCode;a.lastKeyCodeTime=Date.now();a.someProp("handleKeyDown",function(b){return b(a,c)})||function(a,c){var b=c.keyCode,k="";c=(c.ctrlKey&&(k+="c"),c.metaKey&&(k+="m"),c.altKey&&(k+="a"),c.shiftKey&&(k+="s"),k);return 8==b||V.mac&&72==b&&"c"==c?g(a,-1)||l(a):46==b||V.mac&&68==b&&"c"==c?g(a,1)||h(a):13==b||27==b||(37==b?O(a,-1)||l(a):39==b?O(a,1)||h(a):38==b?d(a,-1)||l(a):40==b?d(a,1)||h(a):c==(V.mac?"m":"c")&&(66==b||73==b||89==b||90==b))}(a,c)?c.preventDefault():
a.selectionReader.poll()},keyup:function(a,c){16==c.keyCode&&(a.shiftKey=!1)},keypress:function(a,c){if(!(a.inDOMChange||!c.charCode||c.ctrlKey&&!c.altKey||V.mac&&c.metaKey))if(a.someProp("handleKeyPress",function(b){return b(a,c)}))c.preventDefault();else{var b=a.state.selection;if(!(b instanceof ca.TextSelection&&b.$from.sameParent(b.$to))){var d=String.fromCharCode(c.charCode);a.someProp("handleTextInput",function(c){return c(a,b.$from.pos,b.$to.pos,d)})||a.dispatch(a.state.tr.insertText(d).scrollIntoView());
c.preventDefault()}}}},rb={time:0,x:0,y:0},Gb=rb,xb=V.mac?"metaKey":"ctrlKey";Aa.mousedown=function(a,c){a.shiftKey=c.shiftKey;var b=ya(a),d=Date.now();var k=500<=d-rb.time||!ra(c,rb)||c[xb]?"singleClick":600<=d-Gb.time||!ra(c,Gb)?"doubleClick":"tripleClick";Gb=rb;rb={time:d,x:c.clientX,y:c.clientY};(d=a.posAtCoords({left:c.clientX,top:c.clientY}))&&("singleClick"==k?a.mouseDown=new db(a,d,c,b):("doubleClick"==k?function(a,c,b,d){return na(a,"handleDoubleClickOn",c,b,d)||a.someProp("handleDoubleClick",
function(b){return b(a,c,d)})}:Ta)(a,d.pos,d.inside,c)?c.preventDefault():a.selectionReader.poll("pointer"))};var db=function(a,c,b,d){var k=this;if(this.view=a,this.pos=c,this.event=b,this.flushed=d,this.selectNode=b[xb],this.allowDefault=b.shiftKey,-1<c.inside){var n=a.state.doc.nodeAt(c.inside);c=c.inside}else c=a.state.doc.resolve(c.pos),n=c.parent,c=c.depth?c.before():0;this.mightDrag=null;this.target=d?null:b.target;(n.type.spec.draggable&&!1!==n.type.spec.selectable||a.state.selection instanceof
ca.NodeSelection&&c==a.state.selection.from)&&(this.mightDrag={node:n,pos:c,addAttr:this.target&&!this.target.draggable,setUneditable:this.target&&V.gecko&&!this.target.hasAttribute("contentEditable")});this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(function(){return k.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start());
a.root.addEventListener("mouseup",this.up=this.up.bind(this));a.root.addEventListener("mousemove",this.move=this.move.bind(this));a.selectionReader.poll("pointer")};db.prototype.done=function(){this.view.root.removeEventListener("mouseup",this.up);this.view.root.removeEventListener("mousemove",this.move);this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!1),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start());
this.view.mouseDown=null};db.prototype.up=function(a){this.done();this.view.dom.contains(3==a.target.nodeType?a.target.parentNode:a.target)&&(this.allowDefault?(V.ie&&la(this.view.state)&&this.view.updateState(this.view.state),this.view.selectionReader.poll("pointer")):Sa(this.view,this.pos.pos,this.pos.inside,a,this.selectNode)?a.preventDefault():this.flushed?(xa(this.view,ca.Selection.near(this.view.state.doc.resolve(this.pos.pos)),"pointer"),a.preventDefault()):this.view.selectionReader.poll("pointer"))};
db.prototype.move=function(a){!this.allowDefault&&(4<Math.abs(this.event.x-a.clientX)||4<Math.abs(this.event.y-a.clientY))&&(this.allowDefault=!0);this.view.selectionReader.poll("pointer")};Aa.touchdown=function(a){ya(a);a.selectionReader.poll("pointer")};Aa.contextmenu=function(a){return ya(a)};wa.compositionstart=wa.compositionupdate=function(a){ta.start(a,!0)};wa.compositionend=function(a,c){if(!a.inDOMChange){if(!c.data)return;ta.start(a,!0)}a.inDOMChange.compositionEnd()};wa.input=function(a){a=
ta.start(a);a.composing||a.finish()};var Ca=V.ie&&15>V.ie_version||V.ios&&604>V.webkit_version;Aa.copy=wa.cut=function(a,c){var b=a.state.selection,d="cut"==c.type;if(!b.empty){var k=Ca?null:c.clipboardData,n=Ra(a,b.content());b=n.dom;n=n.text;k?(c.preventDefault(),k.clearData(),k.setData("text/html",b.innerHTML),k.setData("text/plain",n)):function(a,c){var b=c.ownerDocument,d=b.body.appendChild(b.createElement("div"));d.appendChild(c);d.style.cssText="position: fixed; left: -10000px; top: 10px";
var k=getSelection(),n=b.createRange();n.selectNodeContents(c);a.dom.blur();k.removeAllRanges();k.addRange(n);setTimeout(function(){b.body.removeChild(d);a.focus()},50)}(a,b);d&&a.dispatch(a.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}};wa.paste=function(a,c){var b=Ca?null:c.clipboardData;b&&R(a,b.getData("text/plain"),b.getData("text/html"),c)?c.preventDefault():function(a,c){var b=a.dom.ownerDocument,d=a.shiftKey||a.state.selection.$from.parent.type.spec.code,k=b.body.appendChild(b.createElement(d?
"textarea":"div"));d||(k.contentEditable="true");k.style.cssText="position: fixed; left: -10000px; top: 10px";k.focus();setTimeout(function(){a.focus();b.body.removeChild(k);d?R(a,k.value,null,c):R(a,k.textContent,k.innerHTML,c)},50)}(a,c)};var sb=function(a,c){this.slice=a;this.move=c},va=V.mac?"altKey":"ctrlKey",yb;for(yb in Aa.dragstart=function(a,c){var b=a.mouseDown;if(b&&b.done(),c.dataTransfer){var d=a.state.selection,k=d.empty?null:a.posAtCoords({left:c.clientX,top:c.clientY});if(!(k&&k.pos>=
d.from&&k.pos<=(d instanceof ca.NodeSelection?d.to-1:d.to)))if(b&&b.mightDrag)a.dispatch(a.state.tr.setSelection(ca.NodeSelection.create(a.state.doc,b.mightDrag.pos)));else if(c.target&&1==c.target.nodeType){b=a.docView.nearestDesc(c.target,!0);if(!b||!b.node.type.spec.draggable||b==a.docView)return;a.dispatch(a.state.tr.setSelection(ca.NodeSelection.create(a.state.doc,b.posBefore)))}b=a.state.selection.content();k=Ra(a,b);d=k.dom;k=k.text;c.dataTransfer.clearData();c.dataTransfer.setData(Ca?"Text":
"text/html",d.innerHTML);Ca||c.dataTransfer.setData("text/plain",k);a.dragging=new sb(b,!c[va])}},Aa.dragend=function(a){window.setTimeout(function(){return a.dragging=null},50)},wa.dragover=wa.dragenter=function(a,c){return c.preventDefault()},wa.drop=function(a,c){var b=a.dragging;if(a.dragging=null,c.dataTransfer){var d=a.posAtCoords({left:c.clientX,top:c.clientY});if(d){var k=a.state.doc.resolve(d.pos);if(k){var n=b&&b.slice||da(a,c.dataTransfer.getData(Ca?"Text":"text/plain"),Ca?null:c.dataTransfer.getData("text/html"),
!1,k);if(n&&(c.preventDefault(),!a.someProp("handleDrop",function(d){return d(a,c,n,b&&b.move)}))){d=n?vb.dropPoint(a.state.doc,k.pos,n):k.pos;null==d&&(d=k.pos);k=a.state.tr;b&&b.move&&k.deleteSelection();var m=k.mapping.map(d),w=0==n.openStart&&0==n.openEnd&&1==n.content.childCount,f=k.doc;(w?k.replaceRangeWith(m,m,n.content.firstChild):k.replaceRange(m,m,n),k.doc.eq(f))||(m=k.doc.resolve(m),w&&ca.NodeSelection.isSelectable(n.content.firstChild)&&m.nodeAfter&&m.nodeAfter.sameMarkup(n.content.firstChild)?
k.setSelection(new ca.NodeSelection(m)):k.setSelection(t(a,m,k.doc.resolve(k.mapping.map(d)))),a.focus(),a.dispatch(k.setMeta("uiEvent","drop")))}}}}},Aa.focus=function(a){a.focused||(a.dom.classList.add("ProseMirror-focused"),a.focused=!0)},Aa.blur=function(a){a.focused&&(a.dom.classList.remove("ProseMirror-focused"),a.focused=!1)},wa)Aa[yb]=wa[yb];var fb=function(a,c){this.spec=c||eb;this.side=this.spec.side||0;this.toDOM=a};fb.prototype.map=function(a,c,b,d){a=a.mapResult(c.from+d,0>this.side?
-1:1);c=a.pos;return a.deleted?null:new ha(c-b,c-b,this)};fb.prototype.valid=function(){return!0};fb.prototype.eq=function(a){return this==a||a instanceof fb&&(this.spec.key&&this.spec.key==a.spec.key||this.toDOM==a.toDOM&&fa(this.spec,a.spec))};var Da=function(a,c){this.spec=c||eb;this.attrs=a};Da.prototype.map=function(a,c,b,d){var k=a.map(c.from+d,this.spec.inclusiveStart?-1:1)-b;a=a.map(c.to+d,this.spec.inclusiveEnd?1:-1)-b;return k>=a?null:new ha(k,a,this)};Da.prototype.valid=function(a,c){return c.from<
c.to};Da.prototype.eq=function(a){return this==a||a instanceof Da&&fa(this.attrs,a.attrs)&&fa(this.spec,a.spec)};Da.is=function(a){return a.type instanceof Da};var ia=function(a,c){this.spec=c||eb;this.attrs=a};ia.prototype.map=function(a,c,b,d){var k=a.mapResult(c.from+d,1);if(k.deleted)return null;a=a.mapResult(c.to+d,-1);return a.deleted||a.pos<=k.pos?null:new ha(k.pos-b,a.pos-b,this)};ia.prototype.valid=function(a,c){var b=a.content.findIndex(c.from),d=b.index;b=b.offset;return b==c.from&&b+a.child(d).nodeSize==
c.to};ia.prototype.eq=function(a){return this==a||a instanceof ia&&fa(this.attrs,a.attrs)&&fa(this.spec,a.spec)};var ha=function(a,c,b){this.from=a;this.to=c;this.type=b},Pa={spec:{}};ha.prototype.copy=function(a,c){return new ha(a,c,this.type)};ha.prototype.eq=function(a){return this.type.eq(a.type)&&this.from==a.from&&this.to==a.to};ha.prototype.map=function(a,c,b){return this.type.map(a,this,c,b)};ha.widget=function(a,c,b){return new ha(a,a,new fb(c,b))};ha.inline=function(a,c,b,d){return new ha(a,
c,new Da(b,d))};ha.node=function(a,c,b,d){return new ha(a,c,new ia(b,d))};Pa.spec.get=function(){return this.type.spec};Object.defineProperties(ha.prototype,Pa);var ua=[],eb={},L=function(a,c){this.local=a&&a.length?a:ua;this.children=c&&c.length?c:ua};L.create=function(a,c){return c.length?K(c,a,0,eb):k};L.prototype.find=function(a,c,b){var d=[];return this.findInner(null==a?0:a,null==c?1E9:c,d,0,b),d};L.prototype.findInner=function(a,c,b,d,k){for(var n=0;n<this.local.length;n++){var m=this.local[n];
m.from<=c&&m.to>=a&&(!k||k(m.spec))&&b.push(m.copy(m.from+d,m.to+d))}for(n=0;n<this.children.length;n+=3)this.children[n]<c&&this.children[n+1]>a&&(m=this.children[n]+1,this.children[n+2].findInner(a-m,c-m,b,d+m,k))};L.prototype.map=function(a,c,b){return this==k||0==a.maps.length?this:this.mapInner(a,c,0,0,b||eb)};L.prototype.mapInner=function(c,b,d,n,w){for(var m,f=0;f<this.local.length;f++){var g=this.local[f].map(c,d,n);g&&g.type.valid(b,g)?(m||(m=[])).push(g):w.onRemove&&w.onRemove(this.local[f].spec)}return this.children.length?
function(c,b,d,n,m,w,f){for(var g=c.slice(),J=function(a,c,b,d){for(var k=0;k<g.length;k+=3){var n=g[k+1],f=void 0;-1==n||a>n+w||(c>=g[k]+w?g[k+1]=-1:(f=d-b-(c-a)+(w-m))&&(g[k]+=f,g[k+1]+=f))}},e=0;e<d.maps.length;e++)d.maps[e].forEach(J);J=!1;for(e=0;e<g.length;e+=3)if(-1==g[e+1]){var h=d.map(g[e]+w),l=h-m;if(0>l||l>=n.content.size)J=!0;else{var zb=d.map(c[e+1]+w,-1)-m,D=n.content.findIndex(l),t=D.offset;(D=n.maybeChild(D.index))&&t==l&&t+D.nodeSize==zb?(h=g[e+2].mapInner(d,D,h+1,g[e]+w+1,f),h!=
k?(g[e]=l,g[e+1]=zb,g[e+2]=h):(g.splice(e,3),e-=3)):J=!0}}if(J){b=function(a,c,b,d,k,n){function m(a,k){for(var w=0;w<a.local.length;w++){var f=a.local[w].map(b,d,k);f?c.push(f):n.onRemove&&n.onRemove(a.local[w].spec)}for(w=0;w<a.children.length;w+=3)m(a.children[w+2],a.children[w]+k+1)}for(var w=0;w<a.length;w+=3)-1==a[w+1]&&m(a[w+2],a[w]+k+1);return c}(g,b?a(b,m):[],d,m,w,f);n=K(b,n,0,f);b=n.local;for(f=0;f<g.length;f+=3)-1==g[f+1]&&(g.splice(f,3),f-=3);for(c=f=0;f<n.children.length;f+=3){for(d=
n.children[f];c<g.length&&g[c]<d;)c+=3;g.splice(c,0,n.children[f],n.children[f+1],n.children[f+2])}}return new L(b&&b.sort(Ha),g)}(this.children,m,c,b,d,n,w):m?new L(m.sort(Ha)):k};L.prototype.add=function(a,c){return c.length?this==k?L.create(a,c):this.addInner(a,c,0):this};L.prototype.addInner=function(b,d,k){var m,w=this,f=0;b.forEach(function(a,b){var n,g=b+k;if(n=c(d,a,g)){for(m||(m=w.children.slice());f<m.length&&m[f]<b;)f+=3;m[f]==b?m[f+2]=m[f+2].addInner(a,n,g+1):m.splice(f,0,b,b+a.nodeSize,
K(n,a,g+1,eb));f+=3}});b=a(f?n(d):d,-k);return new L(b.length?this.local.concat(b).sort(Ha):this.local,m||this.children)};L.prototype.remove=function(a){return 0==a.length||this==k?this:this.removeInner(a,0)};L.prototype.removeInner=function(a,c){for(var b=this.children,d=this.local,n=0;n<b.length;n+=3){for(var m=void 0,w=b[n]+c,f=b[n+1]+c,g=0,K=void 0;g<a.length;g++)(K=a[g])&&K.from>w&&K.to<f&&(a[g]=null,(m||(m=[])).push(K));m&&(b==this.children&&(b=this.children.slice()),m=b[n+2].removeInner(m,
w+1),m!=k?b[n+2]=m:(b.splice(n,3),n-=3))}if(d.length)for(c=0;c<a.length;c++)if(n=a[c])for(m=0;m<d.length;m++)d[m].type.eq(n.type)&&(d==this.local&&(d=this.local.slice()),d.splice(m--,1));return b==this.children&&d==this.local?this:d.length||b.length?new L(d,b):k};L.prototype.forChild=function(a,c){var b,d;if(this==k)return this;if(c.isLeaf)return L.empty;for(var n=0;n<this.children.length;n+=3)if(this.children[n]>=a){this.children[n]==a&&(b=this.children[n+2]);break}a+=1;c=a+c.content.size;for(n=
0;n<this.local.length;n++){var m=this.local[n];if(m.from<c&&m.to>a&&m.type instanceof Da){var f=Math.max(a,m.from)-a,g=Math.min(c,m.to)-a;f<g&&(d||(d=[])).push(m.copy(f,g))}}return d?(d=new L(d.sort(Ha)),b?new w([d,b]):d):b||k};L.prototype.eq=function(a){if(this==a)return!0;if(!(a instanceof L)||this.local.length!=a.local.length||this.children.length!=a.children.length)return!1;for(var c=0;c<this.local.length;c++)if(!this.local[c].eq(a.local[c]))return!1;for(c=0;c<this.children.length&&this.children[c]==
a.children[c]&&this.children[c+1]==a.children[c+1]&&this.children[c+2].eq(a.children[c+2]);c+=3);return!1};L.prototype.locals=function(a){return ab(this.localsInner(a))};L.prototype.localsInner=function(a){if(this==k)return ua;if(a.inlineContent||!this.local.some(Da.is))return this.local;a=[];for(var c=0;c<this.local.length;c++)this.local[c].type instanceof Da||a.push(this.local[c]);return a};var k=new L;L.empty=k;L.removeOverlap=ab;var w=function(a){this.members=a};w.prototype.forChild=function(a,
c){if(c.isLeaf)return L.empty;for(var b=[],d=0;d<this.members.length;d++){var n=this.members[d].forChild(a,c);n!=k&&(n instanceof w?b=b.concat(n.members):b.push(n))}return w.from(b)};w.prototype.eq=function(a){if(!(a instanceof w)||a.members.length!=this.members.length)return!1;for(var c=0;c<this.members.length;c++)if(!this.members[c].eq(a.members[c]))return!1;return!0};w.prototype.locals=function(a){for(var c,b=!0,d=0;d<this.members.length;d++){var k=this.members[d].localsInner(a);if(k.length)if(c){b&&
(c=c.slice(),b=!1);for(var n=0;n<k.length;n++)c.push(k[n])}else c=k}return c?ab(b?c:c.sort(Ha)):ua};w.from=function(a){switch(a.length){case 0:return k;case 1:return a[0];default:return new w(a)}};var J=function(a,c){this._props=c;this.state=c.state;this.dispatch=this.dispatch.bind(this);this._root=null;this.focused=!1;this.dom=a&&a.mount||document.createElement("div");a&&(a.appendChild?a.appendChild(this.dom):a.apply?a(this.dom):a.mount&&(this.mounted=!0));this.editable=qa(this);this.cursorWrapper=
null;ea(this);this.docView=P(this.state.doc,ma(this),Ja(this),this.dom,this);this.dragging=this.lastSelectedViewDesc=null;(function(a){a.shiftKey=!1;a.mouseDown=null;a.inDOMChange=null;a.lastKeyCode=null;a.lastKeyCodeTime=0;a.domObserver=new jb(a);a.domObserver.start();a.eventHandlers=Object.create(null);var c=function(c){var b=Aa[c];a.dom.addEventListener(c,a.eventHandlers[c]=function(c){!function(a,c){if(!c.bubbles)return!0;if(c.defaultPrevented)return!1;for(var b=c.target;b!=a.dom;b=b.parentNode)if(!b||
11==b.nodeType||b.pmViewDesc&&b.pmViewDesc.stopEvent(c))return!1;return!0}(a,c)||La(a,c)||!a.editable&&c.type in wa||b(a,c)})},b;for(b in Aa)c(b);W(a)})(this);this.selectionReader=new Ya(this);this.pluginViews=[];this.updatePluginViews()},zb={props:{},root:{}};zb.props.get=function(){if(this._props.state!=this.state){var a=this._props,c;for(c in this._props={},a)this._props[c]=a[c];this._props.state=this.state}return this._props};J.prototype.update=function(a){a.handleDOMEvents!=this._props.handleDOMEvents&&
W(this);this._props=a;this.updateState(a.state)};J.prototype.setProps=function(a){var c={},b;for(b in this._props)c[b]=this._props[b];for(var d in c.state=this.state,a)c[d]=a[d];this.update(c)};J.prototype.updateState=function(a){var c=this,d=this.state;if(this.state=a,d.plugins!=a.plugins&&W(this),this.domObserver.flush(),!this.inDOMChange||!this.inDOMChange.stateUpdated(a)){var k=this.editable;this.editable=qa(this);ea(this);var n=Ja(this),w=ma(this),m=d.config!=a.config?"reset":a.scrollToSelection>
d.scrollToSelection?"to selection":"preserve",f=!this.docView.matchesNode(a.doc,w,n),g=f||!a.selection.eq(d.selection)||this.selectionReader.domChanged(),K="preserve"==m&&g&&function(a){for(var c,b,d=a.dom.getBoundingClientRect(),k=Math.max(0,d.top),n=a.dom.ownerDocument,w=(d.left+d.right)/2,m=k+1;m<Math.min(innerHeight,d.bottom);m+=5){var f=a.root.elementFromPoint(w,m);if(f!=a.dom&&a.dom.contains(f)){var g=f.getBoundingClientRect();if(g.top>=k-20){c=f;b=g.top;break}}}d=[];for(a=a.dom;a&&(d.push({dom:a,
top:a.scrollTop,left:a.scrollLeft}),a!=n.body);a=Ab(a));return{refDOM:c,refTop:b,stack:d}}(this);g&&(this.domObserver.stop(),f&&(this.docView.update(a.doc,w,n,this)||(this.docView.destroy(),this.docView=P(a.doc,w,n,this.dom,this)),this.selectionReader.clearDOMState()),b(this),this.domObserver.start());k!=this.editable&&this.selectionReader.editableChanged();this.updatePluginViews(d);"reset"==m?this.dom.scrollTop=0:"to selection"==m?this.someProp("handleScrollToSelection",function(a){return a(c)})||
(a.selection instanceof ca.NodeSelection?T(this,this.docView.domAfterPos(a.selection.from).getBoundingClientRect()):T(this,this.coordsAtPos(a.selection.head))):K&&function(a){var c=a.refDOM,b=a.refTop;a=a.stack;c=c?c.getBoundingClientRect().top:0;b=0==c?0:c-b;for(c=0;c<a.length;c++){var d=a[c],k=d.dom,n=d.top;d=d.left;k.scrollTop!=n+b&&(k.scrollTop=n+b);k.scrollLeft!=d&&(k.scrollLeft=d)}}(K)}};J.prototype.destroyPluginViews=function(){for(var a;a=this.pluginViews.pop();)a.destroy&&a.destroy()};J.prototype.updatePluginViews=
function(a){var c=this.state.plugins;if(a&&a.plugins==c)for(c=0;c<this.pluginViews.length;c++){var b=this.pluginViews[c];b.update&&b.update(this,a)}else for(this.destroyPluginViews(),a=0;a<c.length;a++)b=c[a],b.spec.view&&this.pluginViews.push(b.spec.view(this))};J.prototype.someProp=function(a,c){var b,d=this._props&&this._props[a];if(null!=d&&(b=c?c(d):d))return b;if(d=this.state.plugins)for(var k=0;k<d.length;k++){var n=d[k].props[a];if(null!=n&&(b=c?c(n):n))return b}};J.prototype.hasFocus=function(){return this.root.activeElement==
this.dom};J.prototype.focus=function(){this.domObserver.stop();b(this,!0);this.domObserver.start();this.editable&&this.dom.focus()};zb.root.get=function(){var a=this._root;if(null==a)for(var c=this.dom.parentNode;c;c=c.parentNode)if(9==c.nodeType||11==c.nodeType&&c.host)return this._root=c;return a||document};J.prototype.posAtCoords=function(a){a=U(this,a);return this.inDOMChange&&a&&(a.pos=this.inDOMChange.mapping.map(a.pos),-1!=a.inside&&(a.inside=this.inDOMChange.mapping.map(a.inside))),a};J.prototype.coordsAtPos=
function(a){return this.inDOMChange&&(a=this.inDOMChange.mapping.invert().map(a)),ba(this,a)};J.prototype.domAtPos=function(a){return this.inDOMChange&&(a=this.inDOMChange.mapping.invert().map(a)),this.docView.domFromPos(a)};J.prototype.nodeDOM=function(a){this.inDOMChange&&(a=this.inDOMChange.mapping.invert().map(a));return(a=this.docView.descAt(a))?a.nodeDOM:null};J.prototype.posAtDOM=function(a,c,b){void 0===b&&(b=-1);a=this.docView.posFromDOM(a,c,b);if(null==a)throw new RangeError("DOM position not inside the editor");
return this.inDOMChange&&(a=this.inDOMChange.mapping.map(a)),a};J.prototype.endOfTextblock=function(a,c){return Y(this,c||this.state,a)};J.prototype.destroy=function(){if(this.docView){for(var a in this.domObserver.stop(),this.inDOMChange&&this.inDOMChange.destroy(),this.eventHandlers)this.dom.removeEventListener(a,this.eventHandlers[a]);!0;this.destroyPluginViews();this.selectionReader.destroy();this.mounted?(this.docView.update(this.state.doc,[],Ja(this),this),this.dom.textContent=""):this.dom.parentNode&&
this.dom.parentNode.removeChild(this.dom);this.docView.destroy();this.docView=null}};J.prototype.dispatchEvent=function(a){La(this,a)||!Aa[a.type]||!this.editable&&a.type in wa||Aa[a.type](this,a)};J.prototype.dispatch=function(a){var c=this._props.dispatchTransaction;c?c.call(this,a):this.updateState(this.state.apply(a))};Object.defineProperties(J.prototype,zb);p.EditorView=J;p.Decoration=ha;p.DecorationSet=L;p.__serializeForClipboard=Ra;p.__parseFromClipboard=da},1585:function(e,p,B){function M(a,
c){return f.index=a,f.offset=c,f}function T(a,c){if(a===c)return!0;if(!a||"object"!=typeof a||!c||"object"!=typeof c)return!1;var b=Array.isArray(a);if(Array.isArray(c)!=b)return!1;if(b){if(a.length!=c.length)return!1;for(b=0;b<a.length;b++)if(!T(a[b],c[b]))return!1}else{for(var d in a)if(!(d in c&&T(a[d],c[d])))return!1;for(var f in c)if(!(f in a))return!1}return!0}function G(a){a=Error.call(this,a);return a.__proto__=G.prototype,a}function U(a,c,d){if(d.openStart>a.depth)throw new G("Inserted content deeper than insertion position");
if(a.depth-d.openStart!=c.depth-d.openEnd)throw new G("Inconsistent open depths");return function ma(a,c,d,n){var f=a.index(n),g=a.node(n);if(f==c.index(n)&&n<a.depth-d.openStart)return a=ma(a,c,d,n+1),g.copy(g.content.replaceChild(f,a));if(d.content.size){if(d.openStart||d.openEnd||a.depth!=n||c.depth!=n)return d=function(a,c){for(var d=c.depth-a.openStart,n=c.node(d).copy(a.content),f=d-1;0<=f;f--)n=c.node(f).copy(b.from(n));return{start:n.resolveNoCache(a.openStart+d),end:n.resolveNoCache(n.content.size-
a.openEnd-d)}}(d,a),P(g,function cb(a,c,d,n,f){var g=a.depth>f&&ba(a,c,f+1),e=n.depth>f&&ba(d,n,f+1),h=[];Y(null,a,f,h);g&&e&&c.index(f)==d.index(f)?(aa(g,e),z(P(g,cb(a,c,d,n,f+1)),h)):(g&&z(P(g,x(a,c,f+1)),h),Y(c,d,f,h),e&&z(P(e,x(d,n,f+1)),h));Y(n,null,f,h);return new b(h)}(a,d.start,d.end,c,n));g=a.parent;n=g.content;return P(g,n.cut(0,a.parentOffset).append(d.content).append(n.cut(c.parentOffset)))}return P(g,x(a,c,n))}(a,c,d,0)}function aa(a,c){if(!c.type.compatibleContent(a.type))throw new G("Cannot join "+
c.type.name+" onto "+a.type.name);}function ba(a,c,b){a=a.node(b);return aa(a,c.node(b)),a}function z(a,c){var b=c.length-1;0<=b&&a.isText&&a.sameMarkup(c[b])?c[b]=a.withText(c[b].text+a.text):c.push(a)}function Y(a,c,b,d){var n=(c||a).node(b),f=0,g=c?c.index(b):n.childCount;a&&(f=a.index(b),a.depth>b?f++:a.textOffset&&(z(a.nodeAfter,d),f++));for(a=f;a<g;a++)z(n.child(a),d);c&&c.depth==b&&c.textOffset&&z(c.nodeBefore,d)}function P(a,c){if(!a.type.validContent(c))throw new G("Invalid content for node "+
a.type.name);return a.copy(c)}function x(a,c,d){var n=[];(Y(null,a,d,n),a.depth>d)&&z(P(ba(a,c,d+1),x(a,c,d+1)),n);return Y(c,null,d,n),new b(n)}function q(a,c){for(var b=a.length-1;0<=b;b--)c=a[b].type.name+"("+c+")";return c}function v(a){var c=[];do c.push(Q(a));while(a.eat("|"));return 1==c.length?c[0]:{type:"choice",exprs:c}}function Q(a){var c=[];do c.push(A(a));while(a.next&&")"!=a.next&&"|"!=a.next);return 1==c.length?c[0]:{type:"seq",exprs:c}}function A(a){for(var c=function(a){if(a.eat("(")){var c=
v(a);return a.eat(")")||a.err("Missing closing paren"),c}if(!/\W/.test(a.next))return c=function(a,c){var b=a.nodeTypes,d=b[c];if(d)return[d];d=[];for(var n in b){var f=b[n];-1<f.groups.indexOf(c)&&d.push(f)}0==d.length&&a.err("No node type or group '"+c+"' found");return d}(a,a.next).map(function(c){return null==a.inline?a.inline=c.isInline:a.inline!=c.isInline&&a.err("Mixing inline and block content"),{type:"name",value:c}}),a.pos++,1==c.length?c[0]:{type:"choice",exprs:c};a.err("Unexpected token '"+
a.next+"'")}(a);;)if(a.eat("+"))c={type:"plus",expr:c};else if(a.eat("*"))c={type:"star",expr:c};else if(a.eat("?"))c={type:"opt",expr:c};else{if(!a.eat("{"))break;c=ja(a,c)}return c}function C(a){/\D/.test(a.next)&&a.err("Expected number, got '"+a.next+"'");var c=Number(a.next);return a.pos++,c}function ja(a,c){var b=C(a),d=b;return a.eat(",")&&(d="}"!=a.next?C(a):-1),a.eat("}")||a.err("Unclosed braced range"),{type:"range",min:b,max:d,expr:c}}function y(a,c){return a-c}function Z(a,c){var b=[];
return function ab(c){var d=a[c];if(1==d.length&&!d[0].term)return ab(d[0].to);b.push(c);for(c=0;c<d.length;c++){var n=d[c],f=n.to;n.term||-1!=b.indexOf(f)||ab(f)}}(c),b.sort(y)}function O(a){var c=Object.create(null),b;for(b in a){var d=a[b];if(!d.hasDefault)return null;c[b]=d.default}return c}function N(a,c){var b=Object.create(null),d;for(d in a){var f=c&&c[d];if(void 0===f){f=a[d];if(!f.hasDefault)throw new RangeError("No value supplied for attribute "+d);f=f.default}b[d]=f}return b}function F(a){var c=
Object.create(null);if(a)for(var b in a)c[b]=new La(a[b]);return c}function l(a,c){for(var b=[],d=0;d<c.length;d++){var f=c[d],g=a.marks[f],e=g;if(g)b.push(g);else for(var h in a.marks)g=a.marks[h],("_"==f||g.spec.group&&-1<g.spec.group.split(" ").indexOf(f))&&b.push(e=g);if(!e)throw new SyntaxError("Unknown mark type: '"+c[d]+"'");}return b}function h(a){return(a?1:0)|("full"===a?2:0)}function r(a){var c={},b;for(b in a)c[b]=a[b];return c}function u(a){var c={},b;for(b in a){var d=a[b].spec.toDOM;
d&&(c[b]=d)}return c}Object.defineProperty(p,"__esModule",{value:!0});var d,g=(d=B(462))&&"object"==typeof d&&"default"in d?d.default:d,b=function(a,c){if(this.content=a,this.size=c||0,null==c)for(c=0;c<a.length;c++)this.size+=a[c].nodeSize};e={firstChild:{},lastChild:{},childCount:{}};b.prototype.nodesBetween=function(a,c,b,d,f){void 0===d&&(d=0);for(var n=0,g=0;g<c;n++){var K=this.content[n],e=g+K.nodeSize;e>a&&!1!==b(K,d+g,f,n)&&K.content.size&&(g+=1,K.nodesBetween(Math.max(0,a-g),Math.min(K.content.size,
c-g),b,d+g));g=e}};b.prototype.descendants=function(a){this.nodesBetween(0,this.size,a)};b.prototype.textBetween=function(a,c,b,d){var n="",f=!0;return this.nodesBetween(a,c,function(g,K){g.isText?(n+=g.text.slice(Math.max(a,K)-K,c-K),f=!b):g.isLeaf&&d?(n+=d,f=!b):!f&&g.isBlock&&(n+=b,f=!0)},0),n};b.prototype.append=function(a){if(!a.size)return this;if(!this.size)return a;var c=this.lastChild,d=a.firstChild,f=this.content.slice(),g=0;for(c.isText&&c.sameMarkup(d)&&(f[f.length-1]=c.withText(c.text+
d.text),g=1);g<a.content.length;g++)f.push(a.content[g]);return new b(f,this.size+a.size)};b.prototype.cut=function(a,c){if(null==c&&(c=this.size),0==a&&c==this.size)return this;var d=[],f=0;if(c>a)for(var g=0,e=0;e<c;g++){var h=this.content[g],l=e+h.nodeSize;l>a&&((e<a||l>c)&&(h=h.isText?h.cut(Math.max(0,a-e),Math.min(h.text.length,c-e)):h.cut(Math.max(0,a-e-1),Math.min(h.content.size,c-e-1))),d.push(h),f+=h.nodeSize);e=l}return new b(d,f)};b.prototype.cutByIndex=function(a,c){return a==c?b.empty:
0==a&&c==this.content.length?this:new b(this.content.slice(a,c))};b.prototype.replaceChild=function(a,c){var d=this.content[a];if(d==c)return this;var f=this.content.slice();d=this.size+c.nodeSize-d.nodeSize;return f[a]=c,new b(f,d)};b.prototype.addToStart=function(a){return new b([a].concat(this.content),this.size+a.nodeSize)};b.prototype.addToEnd=function(a){return new b(this.content.concat(a),this.size+a.nodeSize)};b.prototype.eq=function(a){if(this.content.length!=a.content.length)return!1;for(var c=
0;c<this.content.length;c++)if(!this.content[c].eq(a.content[c]))return!1;return!0};e.firstChild.get=function(){return this.content.length?this.content[0]:null};e.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null};e.childCount.get=function(){return this.content.length};b.prototype.child=function(a){var c=this.content[a];if(!c)throw new RangeError("Index "+a+" out of range for "+this);return c};b.prototype.maybeChild=function(a){return this.content[a]};b.prototype.forEach=
function(a){for(var c=0,b=0;c<this.content.length;c++){var d=this.content[c];a(d,b,c);b+=d.nodeSize}};b.prototype.findDiffStart=function(a,c){return void 0===c&&(c=0),function Ba(a,c,b){for(var d=0;;d++){if(d==a.childCount||d==c.childCount)return a.childCount==c.childCount?null:b;var f=a.child(d),g=c.child(d);if(f!=g){if(!f.sameMarkup(g))return b;if(f.isText&&f.text!=g.text){for(a=0;f.text[a]==g.text[a];a++)b++;return b}if(f.content.size||g.content.size)if(g=Ba(f.content,g.content,b+1),null!=g)return g}b+=
f.nodeSize}}(this,a,c)};b.prototype.findDiffEnd=function(a,c,b){return void 0===c&&(c=this.size),void 0===b&&(b=a.size),function ma(a,c,b,d){for(var n=a.childCount,f=c.childCount;;){if(0==n||0==f)return n==f?null:{a:b,b:d};var g=a.child(--n),e=c.child(--f),h=g.nodeSize;if(g!=e){if(!g.sameMarkup(e))return{a:b,b:d};if(g.isText&&g.text!=e.text){a=0;for(c=Math.min(g.text.length,e.text.length);a<c&&g.text[g.text.length-a-1]==e.text[e.text.length-a-1];)a++,b--,d--;return{a:b,b:d}}if(g.content.size||e.content.size)if(g=
ma(g.content,e.content,b-1,d-1))return g}b-=h;d-=h}}(this,a,c,b)};b.prototype.findIndex=function(a,c){if(void 0===c&&(c=-1),0==a)return M(0,a);if(a==this.size)return M(this.content.length,a);if(a>this.size||0>a)throw new RangeError("Position "+a+" outside of fragment ("+this+")");for(var b=0,d=0;;b++){var f=d+this.child(b).nodeSize;if(f>=a)return f==a||0<c?M(b+1,f):M(b,d);d=f}};b.prototype.toString=function(){return"\x3c"+this.toStringInner()+"\x3e"};b.prototype.toStringInner=function(){return this.content.join(", ")};
b.prototype.toJSON=function(){return this.content.length?this.content.map(function(a){return a.toJSON()}):null};b.fromJSON=function(a,c){if(!c)return b.empty;if(!Array.isArray(c))throw new RangeError("Invalid input for Fragment.fromJSON");return new b(c.map(a.nodeFromJSON))};b.fromArray=function(a){if(!a.length)return b.empty;for(var c,d=0,f=0;f<a.length;f++){var g=a[f];d+=g.nodeSize;f&&g.isText&&a[f-1].sameMarkup(g)?(c||(c=a.slice(0,f)),c[c.length-1]=g.withText(c[c.length-1].text+g.text)):c&&c.push(g)}return new b(c||
a,d)};b.from=function(a){return a?a instanceof b?a:Array.isArray(a)?this.fromArray(a):new b([a],a.nodeSize):b.empty};Object.defineProperties(b.prototype,e);var f={index:0,offset:0};b.empty=new b([],0);var t=function(a,c){this.type=a;this.attrs=c};t.prototype.addToSet=function(a){for(var c,b=!1,d=0;d<a.length;d++){var f=a[d];if(this.eq(f))return a;if(this.type.excludes(f.type))c||(c=a.slice(0,d));else{if(f.type.excludes(this.type))return a;!b&&f.type.rank>this.type.rank&&(c||(c=a.slice(0,d)),c.push(this),
b=!0);c&&c.push(f)}}return c||(c=a.slice()),b||c.push(this),c};t.prototype.removeFromSet=function(a){for(var c=0;c<a.length;c++)if(this.eq(a[c]))return a.slice(0,c).concat(a.slice(c+1));return a};t.prototype.isInSet=function(a){for(var c=0;c<a.length;c++)if(this.eq(a[c]))return!0;return!1};t.prototype.eq=function(a){return this==a||this.type==a.type&&T(this.attrs,a.attrs)};t.prototype.toJSON=function(){var a={type:this.type.name},c;for(c in this.attrs){a.attrs=this.attrs;break}return a};t.fromJSON=
function(a,c){if(!c)throw new RangeError("Invalid input for Mark.fromJSON");a=a.marks[c.type];if(!a)throw new RangeError("There is no mark type "+c.type+" in this schema");return a.create(c.attrs)};t.sameSet=function(a,c){if(a==c)return!0;if(a.length!=c.length)return!1;for(var b=0;b<a.length;b++)if(!a[b].eq(c[b]))return!1;return!0};t.setFrom=function(a){if(!a||0==a.length)return t.none;if(a instanceof t)return[a];a=a.slice();return a.sort(function(a,b){return a.type.rank-b.type.rank}),a};t.none=[];
G.prototype=Object.create(Error.prototype);G.prototype.constructor=G;G.prototype.name="ReplaceError";var E=function(a,c,b){this.content=a;this.openStart=c;this.openEnd=b};e={size:{}};e.size.get=function(){return this.content.size-this.openStart-this.openEnd};E.prototype.insertAt=function(a,c){return(a=function Ja(a,c,b,d){var f=a.findIndex(c),g=f.index,e=f.offset;f=a.maybeChild(g);return e==c||f.isText?d&&!d.canReplace(g,g,b)?null:a.cut(0,c).append(b).append(a.cut(c)):(c=Ja(f.content,c-e-1,b))&&a.replaceChild(g,
f.copy(c))}(this.content,a+this.openStart,c,null))&&new E(a,this.openStart,this.openEnd)};E.prototype.removeBetween=function(a,c){return new E(function Ba(a,c,b){var d=a.findIndex(c),f=d.index;d=d.offset;var g=a.maybeChild(f),e=a.findIndex(b),h=e.index;e=e.offset;if(d==c||g.isText){if(e!=b&&!a.child(h).isText)throw new RangeError("Removing non-flat range");return a.cut(0,c).append(a.cut(b))}if(f!=h)throw new RangeError("Removing non-flat range");return a.replaceChild(f,g.copy(Ba(g.content,c-d-1,b-
d-1)))}(this.content,a+this.openStart,c+this.openStart),this.openStart,this.openEnd)};E.prototype.eq=function(a){return this.content.eq(a.content)&&this.openStart==a.openStart&&this.openEnd==a.openEnd};E.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"};E.prototype.toJSON=function(){if(!this.content.size)return null;var a={content:this.content.toJSON()};return 0<this.openStart&&(a.openStart=this.openStart),0<this.openEnd&&(a.openEnd=this.openEnd),a};E.fromJSON=
function(a,c){if(!c)return E.empty;var d=c.openEnd||0;if("number"!=typeof(c.openStart||0)||"number"!=typeof d)throw new RangeError("Invalid input for Slice.fromJSON");return new E(b.fromJSON(a,c.content),c.openStart||0,c.openEnd||0)};E.maxOpen=function(a,c){void 0===c&&(c=!0);for(var b=0,d=0,f=a.firstChild;f&&!f.isLeaf&&(c||!f.type.spec.isolating);f=f.firstChild)b++;for(f=a.lastChild;f&&!f.isLeaf&&(c||!f.type.spec.isolating);f=f.lastChild)d++;return new E(a,b,d)};Object.defineProperties(E.prototype,
e);E.empty=new E(b.empty,0,0);var I=function(a,c,b){this.pos=a;this.path=c;this.depth=c.length/3-1;this.parentOffset=b};e={parent:{},doc:{},textOffset:{},nodeAfter:{},nodeBefore:{}};I.prototype.resolveDepth=function(a){return null==a?this.depth:0>a?this.depth+a:a};e.parent.get=function(){return this.node(this.depth)};e.doc.get=function(){return this.node(0)};I.prototype.node=function(a){return this.path[3*this.resolveDepth(a)]};I.prototype.index=function(a){return this.path[3*this.resolveDepth(a)+
1]};I.prototype.indexAfter=function(a){return a=this.resolveDepth(a),this.index(a)+(a!=this.depth||this.textOffset?1:0)};I.prototype.start=function(a){return 0==(a=this.resolveDepth(a))?0:this.path[3*a-1]+1};I.prototype.end=function(a){return a=this.resolveDepth(a),this.start(a)+this.node(a).content.size};I.prototype.before=function(a){if(!(a=this.resolveDepth(a)))throw new RangeError("There is no position before the top-level node");return a==this.depth+1?this.pos:this.path[3*a-1]};I.prototype.after=
function(a){if(!(a=this.resolveDepth(a)))throw new RangeError("There is no position after the top-level node");return a==this.depth+1?this.pos:this.path[3*a-1]+this.path[3*a].nodeSize};e.textOffset.get=function(){return this.pos-this.path[this.path.length-1]};e.nodeAfter.get=function(){var a=this.parent,c=this.index(this.depth);if(c==a.childCount)return null;var b=this.pos-this.path[this.path.length-1],d=a.child(c);return b?a.child(c).cut(b):d};e.nodeBefore.get=function(){var a=this.index(this.depth),
c=this.pos-this.path[this.path.length-1];return c?this.parent.child(a).cut(0,c):0==a?null:this.parent.child(a-1)};I.prototype.marks=function(){var a=this.parent,c=this.index();if(0==a.content.size)return t.none;if(this.textOffset)return a.child(c).marks;var b=a.maybeChild(c-1);a=a.maybeChild(c);b||(a=b=a);b=b.marks;for(c=0;c<b.length;c++)!1!==b[c].type.spec.inclusive||a&&b[c].isInSet(a.marks)||(b=b[c--].removeFromSet(b));return b};I.prototype.marksAcross=function(a){var c=this.parent.maybeChild(this.index());
if(!c||!c.isInline)return null;c=c.marks;a=a.parent.maybeChild(a.index());for(var b=0;b<c.length;b++)!1!==c[b].type.spec.inclusive||a&&c[b].isInSet(a.marks)||(c=c[b--].removeFromSet(c));return c};I.prototype.sharedDepth=function(a){for(var c=this.depth;0<c;c--)if(this.start(c)<=a&&this.end(c)>=a)return c;return 0};I.prototype.blockRange=function(a,c){if(void 0===a&&(a=this),a.pos<this.pos)return a.blockRange(this);for(var b=this.depth-(this.parent.inlineContent||this.pos==a.pos?1:0);0<=b;b--)if(a.pos<=
this.end(b)&&(!c||c(this.node(b))))return new Ia(this,a,b)};I.prototype.sameParent=function(a){return this.pos-this.parentOffset==a.pos-a.parentOffset};I.prototype.max=function(a){return a.pos>this.pos?a:this};I.prototype.min=function(a){return a.pos<this.pos?a:this};I.prototype.toString=function(){for(var a="",c=1;c<=this.depth;c++)a+=(a?"/":"")+this.node(c).type.name+"_"+this.index(c-1);return a+":"+this.parentOffset};I.resolve=function(a,c){if(!(0<=c&&c<=a.content.size))throw new RangeError("Position "+
c+" out of range");for(var b=[],d=0,f=c;;){var g=a.content.findIndex(f),e=g.index;g=g.offset;var h=f-g;if(b.push(a,e,d+g),!h)break;if((a=a.child(e)).isText)break;f=h-1;d+=g+1}return new I(c,b,f)};I.resolveCached=function(a,c){for(var b=0;b<ka.length;b++){var d=ka[b];if(d.pos==c&&d.doc==a)return d}a=ka[la]=I.resolve(a,c);return la=(la+1)%Ua,a};Object.defineProperties(I.prototype,e);var ka=[],la=0,Ua=12,Ia=function(a,c,b){this.$from=a;this.$to=c;this.depth=b};e={start:{},end:{},parent:{},startIndex:{},
endIndex:{}};e.start.get=function(){return this.$from.before(this.depth+1)};e.end.get=function(){return this.$to.after(this.depth+1)};e.parent.get=function(){return this.$from.node(this.depth)};e.startIndex.get=function(){return this.$from.index(this.depth)};e.endIndex.get=function(){return this.$to.indexAfter(this.depth)};Object.defineProperties(Ia.prototype,e);var gb=Object.create(null),H=function(a,c,d,f){this.type=a;this.attrs=c;this.content=d||b.empty;this.marks=f||t.none};e={nodeSize:{},childCount:{},
textContent:{},firstChild:{},lastChild:{},isBlock:{},isTextblock:{},inlineContent:{},isInline:{},isText:{},isLeaf:{},isAtom:{}};e.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size};e.childCount.get=function(){return this.content.childCount};H.prototype.child=function(a){return this.content.child(a)};H.prototype.maybeChild=function(a){return this.content.maybeChild(a)};H.prototype.forEach=function(a){this.content.forEach(a)};H.prototype.nodesBetween=function(a,c,b,d){void 0===d&&(d=
0);this.content.nodesBetween(a,c,b,d,this)};H.prototype.descendants=function(a){this.nodesBetween(0,this.content.size,a)};e.textContent.get=function(){return this.textBetween(0,this.content.size,"")};H.prototype.textBetween=function(a,c,b,d){return this.content.textBetween(a,c,b,d)};e.firstChild.get=function(){return this.content.firstChild};e.lastChild.get=function(){return this.content.lastChild};H.prototype.eq=function(a){return this==a||this.sameMarkup(a)&&this.content.eq(a.content)};H.prototype.sameMarkup=
function(a){return this.hasMarkup(a.type,a.attrs,a.marks)};H.prototype.hasMarkup=function(a,c,b){return this.type==a&&T(this.attrs,c||a.defaultAttrs||gb)&&t.sameSet(this.marks,b||t.none)};H.prototype.copy=function(a){return void 0===a&&(a=null),a==this.content?this:new this.constructor(this.type,this.attrs,a,this.marks)};H.prototype.mark=function(a){return a==this.marks?this:new this.constructor(this.type,this.attrs,this.content,a)};H.prototype.cut=function(a,c){return 0==a&&c==this.content.size?
this:this.copy(this.content.cut(a,c))};H.prototype.slice=function(a,c,b){if(void 0===c&&(c=this.content.size),void 0===b&&(b=!1),a==c)return E.empty;a=this.resolve(a);var d=this.resolve(c);c=b?0:a.sharedDepth(c);b=a.start(c);b=a.node(c).content.cut(a.pos-b,d.pos-b);return new E(b,a.depth-c,d.depth-c)};H.prototype.replace=function(a,c,b){return U(this.resolve(a),this.resolve(c),b)};H.prototype.nodeAt=function(a){for(var c=this;;){var b=c.content.findIndex(a),d=b.offset;if(!(c=c.maybeChild(b.index)))return null;
if(d==a||c.isText)return c;a-=d+1}};H.prototype.childAfter=function(a){var c=this.content.findIndex(a);a=c.index;c=c.offset;return{node:this.content.maybeChild(a),index:a,offset:c}};H.prototype.childBefore=function(a){if(0==a)return{node:null,index:0,offset:0};var c=this.content.findIndex(a),b=c.index;c=c.offset;if(c<a)return{node:this.content.child(b),index:b,offset:c};a=this.content.child(b-1);return{node:a,index:b-1,offset:c-a.nodeSize}};H.prototype.resolve=function(a){return I.resolveCached(this,
a)};H.prototype.resolveNoCache=function(a){return I.resolve(this,a)};H.prototype.rangeHasMark=function(a,c,b){var d=!1;return c>a&&this.nodesBetween(a,c,function(a){return b.isInSet(a.marks)&&(d=!0),!d}),d};e.isBlock.get=function(){return this.type.isBlock};e.isTextblock.get=function(){return this.type.isTextblock};e.inlineContent.get=function(){return this.type.inlineContent};e.isInline.get=function(){return this.type.isInline};e.isText.get=function(){return this.type.isText};e.isLeaf.get=function(){return this.type.isLeaf};
e.isAtom.get=function(){return this.type.isAtom};H.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var a=this.type.name;return this.content.size&&(a+="("+this.content.toStringInner()+")"),q(this.marks,a)};H.prototype.contentMatchAt=function(a){return this.type.contentMatch.matchFragment(this.content,0,a)};H.prototype.canReplace=function(a,c,d,f,g){void 0===d&&(d=b.empty);void 0===f&&(f=0);void 0===g&&(g=d.childCount);c=(a=this.contentMatchAt(a).matchFragment(d,
f,g))&&a.matchFragment(this.content,c);if(!c||!c.validEnd)return!1;for(;f<g;f++)if(!this.type.allowsMarks(d.child(f).marks))return!1;return!0};H.prototype.canReplaceWith=function(a,c,b,d){if(d&&!this.type.allowsMarks(d))return!1;c=(a=this.contentMatchAt(a).matchType(b))&&a.matchFragment(this.content,c);return!!c&&c.validEnd};H.prototype.canAppend=function(a){return a.content.size?this.canReplace(this.childCount,this.childCount,a.content):this.type.compatibleContent(a.type)};H.prototype.defaultContentType=
function(a){return this.contentMatchAt(a).defaultType};H.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach(function(a){return a.check()})};H.prototype.toJSON=function(){var a={type:this.type.name},c;for(c in this.attrs){a.attrs=this.attrs;break}return this.content.size&&(a.content=this.content.toJSON()),this.marks.length&&(a.marks=this.marks.map(function(a){return a.toJSON()})),
a};H.fromJSON=function(a,c){if(!c)throw new RangeError("Invalid input for Node.fromJSON");var d=null;if(c.marks){if(!Array.isArray(c.marks))throw new RangeError("Invalid mark data for Node.fromJSON");d=c.marks.map(a.markFromJSON)}if("text"==c.type){if("string"!=typeof c.text)throw new RangeError("Invalid text node in JSON");return a.text(c.text,d)}var f=b.fromJSON(a,c.content);return a.nodeType(c.type).create(c.attrs,f,d)};Object.defineProperties(H.prototype,e);var Ra=function(a){function c(c,b,d,
n){if(a.call(this,c,b,null,n),!d)throw new RangeError("Empty text nodes are not allowed");this.text=d}a&&(c.__proto__=a);c.prototype=Object.create(a&&a.prototype);c.prototype.constructor=c;var b={textContent:{},nodeSize:{}};return c.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):q(this.marks,JSON.stringify(this.text))},b.textContent.get=function(){return this.text},c.prototype.textBetween=function(a,c){return this.text.slice(a,c)},b.nodeSize.get=
function(){return this.text.length},c.prototype.mark=function(a){return a==this.marks?this:new c(this.type,this.attrs,this.text,a)},c.prototype.withText=function(a){return a==this.text?this:new c(this.type,this.attrs,a,this.marks)},c.prototype.cut=function(a,c){return void 0===a&&(a=0),void 0===c&&(c=this.text.length),0==a&&c==this.text.length?this:this.withText(this.text.slice(a,c))},c.prototype.eq=function(a){return this.sameMarkup(a)&&this.text==a.text},c.prototype.toJSON=function(){var c=a.prototype.toJSON.call(this);
return c.text=this.text,c},Object.defineProperties(c.prototype,b),c}(H),da=function(a){this.validEnd=a;this.next=[];this.wrapCache=[]};e={inlineContent:{},defaultType:{},edgeCount:{}};da.parse=function(a,c){a=new Ea(a,c);if(null==a.next)return da.empty;c=v(a);a.next&&a.err("Unexpected trailing text");c=function(a){var c=Object.create(null);return function Ba(b){var d=[];b.forEach(function(c){a[c].forEach(function(c){var b=c.term;c=c.to;if(b){var n=d.indexOf(b),f=-1<n&&d[n+1];Z(a,c).forEach(function(a){f||
d.push(b,f=[]);-1==f.indexOf(a)&&f.push(a)})}})});b=c[b.join(",")]=new da(-1<b.indexOf(a.length-1));for(var n=0;n<d.length;n+=2){var f=d[n+1].sort(y);b.next.push(d[n],c[f.join(",")]||Ba(f))}return b}(Z(a,0))}(function(a){function c(){return n.push([])-1}function b(a,c,b){c={term:b,to:c};return n[a].push(c),c}function d(a,c){a.forEach(function(a){return a.to=c})}var n=[[]];return d(function qa(a,n){if("choice"==a.type)return a.exprs.reduce(function(a,c){return a.concat(qa(c,n))},[]);if("seq"==a.type)for(var f=
0;;f++){var g=qa(a.exprs[f],n);if(f==a.exprs.length-1)return g;d(g,n=c())}else{if("star"==a.type)return f=c(),b(n,f),d(qa(a.expr,f),f),[b(f)];if("plus"==a.type)return f=c(),d(qa(a.expr,n),f),d(qa(a.expr,f),f),[b(f)];if("opt"==a.type)return[b(n)].concat(qa(a.expr,n));if("range"==a.type){f=n;for(g=0;g<a.min;g++){var e=c();d(qa(a.expr,f),e);f=e}if(-1==a.max)d(qa(a.expr,f),f);else for(g=a.min;g<a.max;g++)e=c(),b(f,e),d(qa(a.expr,f),e),f=e;return[b(f)]}if("name"==a.type)return[b(n,null,a.value)]}}(a,0),
c()),n}(c));return function(a,c){var b=0;for(a=[a];b<a.length;b++){for(var d=a[b],n=!d.validEnd,f=[],g=0;g<d.next.length;g+=2){var e=d.next[g],h=d.next[g+1];f.push(e.name);!n||e.isText||e.hasRequiredAttrs()||(n=!1);-1==a.indexOf(h)&&a.push(h)}n&&c.err("Only non-generatable nodes ("+f.join(", ")+") in a required position")}}(c,a),c};da.prototype.matchType=function(a){for(var c=0;c<this.next.length;c+=2)if(this.next[c]==a)return this.next[c+1];return null};da.prototype.matchFragment=function(a,c,b){void 0===
c&&(c=0);void 0===b&&(b=a.childCount);for(var d=this;d&&c<b;c++)d=d.matchType(a.child(c).type);return d};e.inlineContent.get=function(){var a=this.next[0];return!!a&&a.isInline};e.defaultType.get=function(){for(var a=0;a<this.next.length;a+=2){var c=this.next[a];if(!c.isText&&!c.hasRequiredAttrs())return c}};da.prototype.compatible=function(a){for(var c=0;c<this.next.length;c+=2)for(var b=0;b<a.next.length;b+=2)if(this.next[c]==a.next[b])return!0;return!1};da.prototype.fillBefore=function(a,c,d){void 0===
c&&(c=!1);void 0===d&&(d=0);var n=[this];return function Ja(f,g){var e=f.matchFragment(a,d);if(e&&(!c||e.validEnd))return b.from(g.map(function(a){return a.createAndFill()}));for(e=0;e<f.next.length;e+=2){var h=f.next[e],l=f.next[e+1];if(!h.isText&&!h.hasRequiredAttrs()&&-1==n.indexOf(l)&&(n.push(l),h=Ja(l,g.concat(h))))return h}}(this,[])};da.prototype.findWrapping=function(a){for(var c=0;c<this.wrapCache.length;c+=2)if(this.wrapCache[c]==a)return this.wrapCache[c+1];c=this.computeWrapping(a);return this.wrapCache.push(a,
c),c};da.prototype.computeWrapping=function(a){for(var c=Object.create(null),b=[{match:this,type:null,via:null}];b.length;){var d=b.shift(),f=d.match;if(f.matchType(a)){for(a=[];d.type;d=d.via)a.push(d.type);return a.reverse()}for(var g=0;g<f.next.length;g+=2){var e=f.next[g];e.isLeaf||e.name in c||d.type&&!f.next[g+1].validEnd||(b.push({match:e.contentMatch,type:e,via:d}),c[e.name]=!0)}}};e.edgeCount.get=function(){return this.next.length>>1};da.prototype.edge=function(a){var c=a<<1;if(c>this.next.length)throw new RangeError("There's no "+
a+"th edge in this content match");return{type:this.next[c],next:this.next[c+1]}};da.prototype.toString=function(){var a=[];return function K(b){a.push(b);for(var d=1;d<b.next.length;d+=2)-1==a.indexOf(b.next[d])&&K(b.next[d])}(this),a.map(function(b,d){d=d+(b.validEnd?"*":" ")+" ";for(var n=0;n<b.next.length;n+=2)d+=(n?", ":"")+b.next[n].name+"-\x3e"+a.indexOf(b.next[n+1]);return d}).join("\n")};Object.defineProperties(da.prototype,e);da.empty=new da(!0);var Ea=function(a,c){this.string=a;this.nodeTypes=
c;this.inline=null;this.pos=0;this.tokens=a.split(/\s*(?=\b|\W|$)/);""==this.tokens[this.tokens.length-1]&&this.tokens.pop();""==this.tokens[0]&&this.tokens.unshift()};e={next:{}};e.next.get=function(){return this.tokens[this.pos]};Ea.prototype.eat=function(a){return this.next==a&&(this.pos++||!0)};Ea.prototype.err=function(a){throw new SyntaxError(a+" (in content expression '"+this.string+"')");};Object.defineProperties(Ea.prototype,e);var W=function(a,c,b){this.name=a;this.schema=c;this.spec=b;
this.groups=b.group?b.group.split(" "):[];this.attrs=F(b.attrs);this.defaultAttrs=O(this.attrs);this.inlineContent=this.markSet=this.contentMatch=null;this.isBlock=!(b.inline||"text"==a);this.isText="text"==a};e={isInline:{},isTextblock:{},isLeaf:{},isAtom:{}};e.isInline.get=function(){return!this.isBlock};e.isTextblock.get=function(){return this.isBlock&&this.inlineContent};e.isLeaf.get=function(){return this.contentMatch==da.empty};e.isAtom.get=function(){return this.isLeaf||this.spec.atom};W.prototype.hasRequiredAttrs=
function(a){for(var c in this.attrs)if(this.attrs[c].isRequired&&!(a&&c in a))return!0;return!1};W.prototype.compatibleContent=function(a){return this==a||this.contentMatch.compatible(a.contentMatch)};W.prototype.computeAttrs=function(a){return!a&&this.defaultAttrs?this.defaultAttrs:N(this.attrs,a)};W.prototype.create=function(a,c,d){if(this.isText)throw Error("NodeType.create can't construct text nodes");return new H(this,this.computeAttrs(a),b.from(c),t.setFrom(d))};W.prototype.createChecked=function(a,
c,d){if(c=b.from(c),!this.validContent(c))throw new RangeError("Invalid content for node "+this.name);return new H(this,this.computeAttrs(a),c,t.setFrom(d))};W.prototype.createAndFill=function(a,c,d){if(a=this.computeAttrs(a),(c=b.from(c)).size){var n=this.contentMatch.fillBefore(c);if(!n)return null;c=n.append(c)}return(n=this.contentMatch.matchFragment(c).fillBefore(b.empty,!0))?new H(this,a,c.append(n),t.setFrom(d)):null};W.prototype.validContent=function(a){var c=this.contentMatch.matchFragment(a);
if(!c||!c.validEnd)return!1;for(c=0;c<a.childCount;c++)if(!this.allowsMarks(a.child(c).marks))return!1;return!0};W.prototype.allowsMarkType=function(a){return null==this.markSet||-1<this.markSet.indexOf(a)};W.prototype.allowsMarks=function(a){if(null==this.markSet)return!0;for(var c=0;c<a.length;c++)if(!this.allowsMarkType(a[c].type))return!1;return!0};W.prototype.allowedMarks=function(a){var c;if(null==this.markSet)return a;for(var b=0;b<a.length;b++)this.allowsMarkType(a[b].type)?c&&c.push(a[b]):
c||(c=a.slice(0,b));return c?c.length?c:t.empty:a};W.compile=function(a,c){var b=Object.create(null);a.forEach(function(a,d){return b[a]=new W(a,c,d)});a=c.spec.topNode||"doc";if(!b[a])throw new RangeError("Schema is missing its top node type ('"+a+"')");if(!b.text)throw new RangeError("Every schema needs a 'text' type");for(var d in b.text.attrs)throw new RangeError("The text node type should not have attributes");return b};Object.defineProperties(W.prototype,e);var La=function(a){this.hasDefault=
Object.prototype.hasOwnProperty.call(a,"default");this.default=a.default};e={isRequired:{}};e.isRequired.get=function(){return!this.hasDefault};Object.defineProperties(La.prototype,e);var ra=function(a,c,b,d){this.name=a;this.schema=b;this.spec=d;this.attrs=F(d.attrs);this.rank=c;this.excluded=null;this.instance=(a=O(this.attrs))&&new t(this,a)};ra.prototype.create=function(a){return!a&&this.instance?this.instance:new t(this,N(this.attrs,a))};ra.compile=function(a,c){var b=Object.create(null),d=0;
return a.forEach(function(a,n){return b[a]=new ra(a,d++,c,n)}),b};ra.prototype.removeFromSet=function(a){for(var c=0;c<a.length;c++)if(a[c].type==this)return a.slice(0,c).concat(a.slice(c+1));return a};ra.prototype.isInSet=function(a){for(var c=0;c<a.length;c++)if(a[c].type==this)return a[c]};ra.prototype.excludes=function(a){return-1<this.excluded.indexOf(a)};e=function(a){for(var c in this.spec={},a)this.spec[c]=a[c];this.spec.nodes=g.from(a.nodes);this.spec.marks=g.from(a.marks);this.nodes=W.compile(this.spec.nodes,
this);this.marks=ra.compile(this.spec.marks,this);a=Object.create(null);for(var b in this.nodes){if(b in this.marks)throw new RangeError(b+" can not be both a node and a mark");c=this.nodes[b];var d=c.spec.content||"",f=c.spec.marks;c.contentMatch=a[d]||(a[d]=da.parse(d,this.nodes));c.inlineContent=c.contentMatch.inlineContent;c.markSet="_"==f?null:f?l(this,f.split(" ")):""!=f&&c.inlineContent?null:[]}for(var e in this.marks)b=this.marks[e],a=b.spec.excludes,b.excluded=null==a?[b]:""==a?[]:l(this,
a.split(" "));this.nodeFromJSON=this.nodeFromJSON.bind(this);this.markFromJSON=this.markFromJSON.bind(this);this.topNodeType=this.nodes[this.spec.topNode||"doc"];this.cached=Object.create(null);this.cached.wrappings=Object.create(null)};e.prototype.node=function(a,c,b,d){if("string"==typeof a)a=this.nodeType(a);else{if(!(a instanceof W))throw new RangeError("Invalid node type: "+a);if(a.schema!=this)throw new RangeError("Node type from different schema used ("+a.name+")");}return a.createChecked(c,
b,d)};e.prototype.text=function(a,c){var b=this.nodes.text;return new Ra(b,b.defaultAttrs,a,t.setFrom(c))};e.prototype.mark=function(a,c){return"string"==typeof a&&(a=this.marks[a]),a.create(c)};e.prototype.nodeFromJSON=function(a){return H.fromJSON(this,a)};e.prototype.markFromJSON=function(a){return t.fromJSON(this,a)};e.prototype.nodeType=function(a){var c=this.nodes[a];if(!c)throw new RangeError("Unknown node type: "+a);return c};var na=function(a,c){var b=this;this.schema=a;this.rules=c;this.tags=
[];this.styles=[];c.forEach(function(a){a.tag?b.tags.push(a):a.style&&b.styles.push(a)})};na.prototype.parse=function(a,c){void 0===c&&(c={});var b=new R(this,c,!1);return b.addAll(a,null,c.from,c.to),b.finish()};na.prototype.parseSlice=function(a,c){void 0===c&&(c={});var b=new R(this,c,!0);return b.addAll(a,null,c.from,c.to),E.maxOpen(b.finish())};na.prototype.matchTag=function(a,c){for(var b=0;b<this.tags.length;b++){var d=this.tags[b];if((a.matches||a.msMatchesSelector||a.webkitMatchesSelector||
a.mozMatchesSelector).call(a,d.tag)&&(void 0===d.namespace||a.namespaceURI==d.namespace)&&(!d.context||c.matchesContext(d.context))){if(d.getAttrs){var f=d.getAttrs(a);if(!1===f)continue;d.attrs=f}return d}}};na.prototype.matchStyle=function(a,c,b){for(var d=0;d<this.styles.length;d++){var f=this.styles[d];if(!(0!=f.style.indexOf(a)||f.context&&!b.matchesContext(f.context)||f.style.length>a.length&&(61!=f.style.charCodeAt(a.length)||f.style.slice(a.length+1)!=c))){if(f.getAttrs){var n=f.getAttrs(c);
if(!1===n)continue;f.attrs=n}return f}}};na.schemaRules=function(a){function c(a){for(var c=null==a.priority?50:a.priority,d=0;d<b.length;d++){var f=b[d];if((null==f.priority?50:f.priority)<c)break}b.splice(d,0,a)}var b=[],d=function(b){var d=a.marks[b].spec.parseDOM;d&&d.forEach(function(a){c(a=r(a));a.mark=b})},f;for(f in a.marks)d(f);for(var g in a.nodes)d=void 0,(d=a.nodes[g].spec.parseDOM)&&d.forEach(function(a){c(a=r(a));a.node=g});return b};na.fromSchema=function(a){return a.cached.domParser||
(a.cached.domParser=new na(a,na.schemaRules(a)))};var xa={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Sa={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Ta={ol:!0,ul:!0},ya=function(a,c,b,d,f,g){this.type=a;this.attrs=c;this.solid=d;this.match=f||(4&g?null:a.contentMatch);
this.options=g;this.content=[];this.marks=b;this.activeMarks=t.none};ya.prototype.findWrapping=function(a){if(!this.match){if(!this.type)return[];var c=this.type.contentMatch.fillBefore(b.from(a));if(!c){var d;c=this.type.contentMatch;return(d=c.findWrapping(a.type))?(this.match=c,d):null}this.match=this.type.contentMatch.matchFragment(c)}return this.match.findWrapping(a.type)};ya.prototype.finish=function(a){if(!(this.options&1)){var c,d=this.content[this.content.length-1];d&&d.isText&&(c=/\s+$/.exec(d.text))&&
(d.text.length==c[0].length?this.content.pop():this.content[this.content.length-1]=d.withText(d.text.slice(0,d.text.length-c[0].length)))}c=b.from(this.content);return!a&&this.match&&(c=c.append(this.match.fillBefore(b.empty,!0))),this.type?this.type.create(this.attrs,c,this.marks):c};var R=function(a,c,b){this.parser=a;this.options=c;this.isOpen=b;this.pendingMarks=[];var d=c.topNode,f=h(c.preserveWhitespace)|(b?4:0);this.nodes=[d?new ya(d.type,d.attrs,t.none,!0,c.topMatch||d.type.contentMatch,f):
new ya(b?null:a.schema.topNodeType,null,t.none,!0,null,f)];this.open=0;this.find=c.findPositions;this.needsBlock=!1};B={top:{},currentPos:{}};B.top.get=function(){return this.nodes[this.open]};R.prototype.addDOM=function(a){if(3==a.nodeType)this.addTextNode(a);else if(1==a.nodeType){var c=a.getAttribute("style");c=c?this.readStyles(function(a){for(var c,b=/\s*([\w-]+)\s*:\s*([^;]+)/g,d=[];c=b.exec(a);)d.push(c[1],c[2].trim());return d}(c)):null;if(null!=c)for(var b=0;b<c.length;b++)this.addPendingMark(c[b]);
if(this.addElement(a),null!=c)for(a=0;a<c.length;a++)this.removePendingMark(c[a])}};R.prototype.addTextNode=function(a){var c=a.nodeValue,b=this.top;if((b.type?b.type.inlineContent:b.content.length&&b.content[0].isInline)||/\S/.test(c)){if(b.options&1)b.options&2||(c=c.replace(/\r?\n|\r/g," "));else if(c=c.replace(/\s+/g," "),/^\s/.test(c)&&this.open==this.nodes.length-1)b=b.content[b.content.length-1],(!b||b.isText&&/\s$/.test(b.text))&&(c=c.slice(1));c&&this.insertNode(this.parser.schema.text(c));
this.findInText(a)}else this.findInside(a)};R.prototype.addElement=function(a){var c=a.nodeName.toLowerCase();if(Ta.hasOwnProperty(c))for(var b=a.firstChild,d=null;b;b=b.nextSibling){var f=1==b.nodeType?b.nodeName.toLowerCase():null;f&&Ta.hasOwnProperty(f)&&d?(d.appendChild(b),b=d):"li"==f?d=b:f&&(d=null)}if((b=this.options.ruleFromNode&&this.options.ruleFromNode(a)||this.parser.matchTag(a,this))?b.ignore:Sa.hasOwnProperty(c))this.findInside(a);else if(!b||b.skip){b&&b.skip.nodeType&&(a=b.skip);var g;
b=this.top;d=this.needsBlock;xa.hasOwnProperty(c)&&(g=!0,b.type||(this.needsBlock=!0));this.addAll(a);g&&this.sync(b);this.needsBlock=d}else this.addElementByRule(a,b)};R.prototype.readStyles=function(a){for(var c=t.none,b=0;b<a.length;b+=2){var d=this.parser.matchStyle(a[b],a[b+1],this);if(d){if(d.ignore)return null;c=this.parser.schema.marks[d.mark].create(d.attrs).addToSet(c)}}return c};R.prototype.addElementByRule=function(a,c){var b,d,f,g=this;c.node?(d=this.parser.schema.nodes[c.node]).isLeaf?
this.insertNode(d.create(c.attrs)):b=this.enter(d,c.attrs,c.preserveWhitespace):(f=this.parser.schema.marks[c.mark].create(c.attrs),this.addPendingMark(f));var e=this.top;d&&d.isLeaf?this.findInside(a):c.getContent?(this.findInside(a),c.getContent(a,this.parser.schema).forEach(function(a){return g.insertNode(a)})):(c=c.contentElement,"string"==typeof c?c=a.querySelector(c):"function"==typeof c&&(c=c(a)),c||(c=a),this.findAround(a,c,!0),this.addAll(c,b));return b&&(this.sync(e),this.open--),f&&this.removePendingMark(f),
!0};R.prototype.addAll=function(a,c,b,d){var f=b||0;b=b?a.childNodes[b]:a.firstChild;for(d=null==d?null:a.childNodes[d];b!=d;b=b.nextSibling,++f)this.findAtPoint(a,f),this.addDOM(b),c&&xa.hasOwnProperty(b.nodeName.toLowerCase())&&this.sync(c);this.findAtPoint(a,f)};R.prototype.findPlace=function(a){for(var c,b,d=this.open;0<=d;d--){var f=this.nodes[d],g=f.findWrapping(a);if(g&&(!c||c.length>g.length)&&(c=g,b=f,!g.length))break;if(f.solid)break}if(!c)return!1;this.sync(b);for(a=0;a<c.length;a++)this.enterInner(c[a],
null,!1);return!0};R.prototype.insertNode=function(a){if(a.isInline&&this.needsBlock&&!this.top.type){var c=this.textblockFromContext();c&&this.enterInner(c)}if(this.findPlace(a)){this.closeExtra();c=this.top;this.applyPendingMarks(c);c.match&&(c.match=c.match.matchType(a.type));for(var b=c.activeMarks,d=0;d<a.marks.length;d++)c.type&&!c.type.allowsMarkType(a.marks[d].type)||(b=a.marks[d].addToSet(b));c.content.push(a.mark(b))}};R.prototype.applyPendingMarks=function(a){for(var c=0;c<this.pendingMarks.length;c++){var b=
this.pendingMarks[c];a.type&&!a.type.allowsMarkType(b.type)||b.type.isInSet(a.activeMarks)||(a.activeMarks=b.addToSet(a.activeMarks),this.pendingMarks.splice(c--,1))}};R.prototype.enter=function(a,c,b){var d=this.findPlace(a.create(c));return d&&(this.applyPendingMarks(this.top),this.enterInner(a,c,!0,b)),d};R.prototype.enterInner=function(a,c,b,d){this.closeExtra();var f=this.top;f.match=f.match&&f.match.matchType(a,c);d=null==d?-5&f.options:h(d);4&f.options&&0==f.content.length&&(d|=4);this.nodes.push(new ya(a,
c,f.activeMarks,b,null,d));this.open++};R.prototype.closeExtra=function(a){var c=this.nodes.length-1;if(c>this.open){for(;c>this.open;c--)this.nodes[c-1].content.push(this.nodes[c].finish(a));this.nodes.length=this.open+1}};R.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)};R.prototype.sync=function(a){for(var c=this.open;0<=c;c--)if(this.nodes[c]==a)return void(this.open=c)};R.prototype.addPendingMark=function(a){this.pendingMarks.push(a)};
R.prototype.removePendingMark=function(a){var c=this.pendingMarks.lastIndexOf(a);-1<c?this.pendingMarks.splice(c,1):(c=this.top,c.activeMarks=a.removeFromSet(c.activeMarks))};B.currentPos.get=function(){this.closeExtra();for(var a=0,c=this.open;0<=c;c--){for(var b=this.nodes[c].content,d=b.length-1;0<=d;d--)a+=b[d].nodeSize;c&&a++}return a};R.prototype.findAtPoint=function(a,c){if(this.find)for(var b=0;b<this.find.length;b++)this.find[b].node==a&&this.find[b].offset==c&&(this.find[b].pos=this.currentPos)};
R.prototype.findInside=function(a){if(this.find)for(var c=0;c<this.find.length;c++)null==this.find[c].pos&&1==a.nodeType&&a.contains(this.find[c].node)&&(this.find[c].pos=this.currentPos)};R.prototype.findAround=function(a,c,b){if(a!=c&&this.find)for(var d=0;d<this.find.length;d++)null==this.find[d].pos&&1==a.nodeType&&a.contains(this.find[d].node)&&c.compareDocumentPosition(this.find[d].node)&(b?2:4)&&(this.find[d].pos=this.currentPos)};R.prototype.findInText=function(a){if(this.find)for(var c=0;c<
this.find.length;c++)this.find[c].node==a&&(this.find[c].pos=this.currentPos-(a.nodeValue.length-this.find[c].offset))};R.prototype.matchesContext=function(a){var c=this;if(-1<a.indexOf("|"))return a.split(/\s*\|\s*/).some(this.matchesContext,this);var b=a.split("/"),d=this.options.context,f=!(this.isOpen||d&&d.parent.type!=this.nodes[0].type),g=-(d?d.depth+1:0)+(f?0:1),e=function(a,n){for(;0<=a;a--){var h=b[a];if(""==h){if(a==b.length-1||0==a)continue;for(;n>=g;n--)if(e(a-1,n))return!0;return!1}var l=
0<n||0==n&&f?c.nodes[n].type:d&&n>=g?d.node(n-g).type:null;if(!l||l.name!=h&&-1==l.groups.indexOf(h))return!1;n--}return!0};return e(b.length-1,this.open)};R.prototype.textblockFromContext=function(){var a=this.options.context;if(a)for(var c=a.depth;0<=c;c--){var b=a.node(c).contentMatchAt(a.indexAfter(c)).defaultType;if(b&&b.isTextblock&&b.defaultAttrs)return b}for(var d in this.parser.schema.nodes)if(a=this.parser.schema.nodes[d],a.isTextblock&&a.defaultAttrs)return a};Object.defineProperties(R.prototype,
B);var fa=function(a,c){this.nodes=a||{};this.marks=c||{}};fa.prototype.serializeFragment=function(a,c,b){var d=this;void 0===c&&(c={});b||(b=(c.document||window.document).createDocumentFragment());var f=b,g=null;return a.forEach(function(a){if(g||a.marks.length){g||(g=[]);for(var b=0,n=0;b<g.length&&n<a.marks.length;){var e=a.marks[n];if(d.marks[e.type.name]){if(!e.eq(g[b]))break;b+=2}n++}for(;b<g.length;)f=g.pop(),g.pop();for(;n<a.marks.length;)b=a.marks[n++],(e=d.serializeMark(b,a.isInline,c))&&
(g.push(b,f),f.appendChild(e.dom),f=e.contentDOM||e.dom)}f.appendChild(d.serializeNode(a,c))}),b};fa.prototype.serializeNode=function(a,c){void 0===c&&(c={});var b=fa.renderSpec(c.document||window.document,this.nodes[a.type.name](a)),d=b.dom;if(b=b.contentDOM){if(a.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");c.onContent?c.onContent(a,b,c):this.serializeFragment(a.content,c,b)}return d};fa.prototype.serializeNodeAndMarks=function(a,c){void 0===c&&(c={});for(var b=this.serializeNode(a,
c),d=a.marks.length-1;0<=d;d--){var f=this.serializeMark(a.marks[d],a.isInline,c);f&&((f.contentDOM||f.dom).appendChild(b),b=f.dom)}return b};fa.prototype.serializeMark=function(a,c,b){void 0===b&&(b={});var d=this.marks[a.type.name];return d&&fa.renderSpec(b.document||window.document,d(a,c))};fa.renderSpec=function(a,c){if("string"==typeof c)return{dom:a.createTextNode(c)};if(null!=c.nodeType)return{dom:c};var b=a.createElement(c[0]),d=null,f=c[1],g=1;if(f&&"object"==typeof f&&null==f.nodeType&&
!Array.isArray(f))for(var e in g=2,f)"style"==e?b.style.cssText=f[e]:null!=f[e]&&b.setAttribute(e,f[e]);for(f=g;f<c.length;f++){e=c[f];if(0===e){if(f<c.length-1||f>g)throw new RangeError("Content hole must be the only child of its parent node");return{dom:b,contentDOM:b}}e=fa.renderSpec(a,e);var h=e.contentDOM;if(b.appendChild(e.dom),h){if(d)throw new RangeError("Multiple content holes");d=h}}return{dom:b,contentDOM:d}};fa.fromSchema=function(a){return a.cached.domSerializer||(a.cached.domSerializer=
new fa(this.nodesFromSchema(a),this.marksFromSchema(a)))};fa.nodesFromSchema=function(a){a=u(a.nodes);return a.text||(a.text=function(a){return a.text}),a};fa.marksFromSchema=function(a){return u(a.marks)};p.Node=H;p.ResolvedPos=I;p.NodeRange=Ia;p.Fragment=b;p.Slice=E;p.ReplaceError=G;p.Mark=t;p.Schema=e;p.NodeType=W;p.MarkType=ra;p.ContentMatch=da;p.DOMParser=na;p.DOMSerializer=fa},1586:function(e,p,B){function M(e,q){var p="vert"==e?0<q?"down":"up":0<q?"right":"left";return function(e,v,x){var C=
e.selection,y=0<q?C.$to:C.$from,A=C.empty;if(C instanceof U.TextSelection){if(!x.endOfTextblock(p))return!1;A=!1;y=e.doc.resolve(0<q?y.after():y.before())}x=z.findFrom(y,q,A);return!!x&&(v&&v(e.tr.setSelection(new z(x))),!0)}}function T(e,q,p){q=e.state.doc.resolve(q);if(!z.valid(q))return!1;p=e.posAtCoords({left:p.clientX,top:p.clientY}).inside;return!(-1<p&&U.NodeSelection.isSelectable(e.state.doc.nodeAt(p)))&&(e.dispatch(e.state.tr.setSelection(new z(q))),!0)}function G(e){if(!(e.selection instanceof
z))return null;var q=document.createElement("div");return q.className="ProseMirror-gapcursor",aa.DecorationSet.create(e.doc,[aa.Decoration.widget(e.selection.head,q,{key:"gapcursor"})])}Object.defineProperty(p,"__esModule",{value:!0});e=B(466);var U=B(30),aa=B(463),ba=B(38),z=function(e){function q(q){e.call(this,q,q)}return e&&(q.__proto__=e),q.prototype=Object.create(e&&e.prototype),q.prototype.constructor=q,q.prototype.map=function(p,x){p=p.resolve(x.map(this.head));return q.valid(p)?new q(p):
e.near(p)},q.prototype.content=function(){return ba.Slice.empty},q.prototype.eq=function(e){return e instanceof q&&e.head==this.head},q.prototype.toJSON=function(){return{type:"gapcursor",pos:this.head}},q.fromJSON=function(e,p){if("number"!=typeof p.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new q(e.resolve(p.pos))},q.prototype.getBookmark=function(){return new Y(this.anchor)},q.valid=function(e){var q=e.parent;if(q.isTextblock||!function(e){for(var q=e.depth;0<=q;q--){var p=
e.index(q);if(0!=p)for(e=e.node(q).child(p-1);;e=e.lastChild){if(e.isTextblock)return!1;if(0==e.childCount||e.isAtom||e.type.spec.isolating)return!0}}return!0}(e)||!function(e){for(var q=e.depth;0<=q;q--){var p=e.indexAfter(q),v=e.node(q);if(p!=v.childCount)for(e=v.child(p);;e=e.firstChild){if(e.isTextblock)return!1;if(0==e.childCount||e.isAtom||e.type.spec.isolating)return!0}}return!0}(e))return!1;var p=q.type.spec.allowGapCursor;return null!=p?p:(e=q.contentMatchAt(e.index()).defaultType)&&e.isTextblock},
q.findFrom=function(e,p,x){if(!x&&q.valid(e))return e;x=e.pos;var v;for(v=e.depth;;v--){var A=e.node(v);if(0<p?e.indexAfter(v)<A.childCount:0<e.index(v)){v=A.maybeChild(0<p?e.indexAfter(v):e.index(v)-1);break}if(0==v)return null;x+=p;A=e.doc.resolve(x);if(q.valid(A))return A}for(;v=0<p?v.firstChild:v.lastChild;)if(x+=p,A=e.doc.resolve(x),q.valid(A))return A;return null},q}(U.Selection);z.prototype.visible=!1;U.Selection.jsonID("gapcursor",z);var Y=function(e){this.pos=e};Y.prototype.map=function(e){return new Y(e.map(this.pos))};
Y.prototype.resolve=function(e){e=e.resolve(this.pos);return z.valid(e)?new z(e):U.Selection.near(e)};var P=e.keydownHandler({ArrowLeft:M("horiz",-1),ArrowRight:M("horiz",1),ArrowUp:M("vert",-1),ArrowDown:M("vert",1)});p.gapCursor=function(){return new U.Plugin({props:{decorations:G,createSelectionBetween:function(e,q,p){if(q.pos==p.pos&&z.valid(p))return new z(p)},handleClick:T,handleKeyDown:P}})};p.GapCursor=z},30:function(e,p,B){function M(e,h,r,u,d,g){if(h.inlineContent)return P.create(e,r);for(u-=
0<d?0:1;0<d?u<h.childCount:0<=u;u+=d){var b=h.child(u);if(b.isAtom){if(!g&&q.isSelectable(b))return q.create(e,r-(0>d?b.nodeSize:0))}else{var f=M(e,b,r+d,0>d?b.childCount:0,d,g);if(f)return f}r+=b.nodeSize*d}}function T(e,h,r){var l,d=e.steps.length-1;!(d<h)&&e.steps[d]instanceof aa.ReplaceStep&&(e.mapping.maps[d].forEach(function(d,b,f,e){return l=e}),null!=l&&e.setSelection(z.near(e.doc.resolve(l),r)))}function G(e){return e in F?e+"$"+ ++F[e]:(F[e]=0,e+"$")}Object.defineProperty(p,"__esModule",
{value:!0});var U=B(38),aa=B(119),ba=Object.create(null),z=function(e,h,r){this.ranges=r||[new Y(e.min(h),e.max(h))];this.$anchor=e;this.$head=h};e={anchor:{},head:{},from:{},to:{},$from:{},$to:{},empty:{}};e.anchor.get=function(){return this.$anchor.pos};e.head.get=function(){return this.$head.pos};e.from.get=function(){return this.$from.pos};e.to.get=function(){return this.$to.pos};e.$from.get=function(){return this.ranges[0].$from};e.$to.get=function(){return this.ranges[0].$to};e.empty.get=function(){for(var e=
this.ranges,h=0;h<e.length;h++)if(e[h].$from.pos!=e[h].$to.pos)return!1;return!0};z.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)};z.prototype.replace=function(e,h){void 0===h&&(h=U.Slice.empty);for(var l=h.content.lastChild,u=null,d=0;d<h.openEnd;d++)u=l,l=l.lastChild;d=e.steps.length;for(var g=this.ranges,b=0;b<g.length;b++){var f=g[b],t=f.$from;f=f.$to;var p=e.mapping.slice(d);e.replaceRange(p.map(t.pos),p.map(f.pos),b?U.Slice.empty:h);0==b&&T(e,d,(l?l.isInline:
u&&u.isTextblock)?-1:1)}};z.prototype.replaceWith=function(e,h){for(var l=e.steps.length,u=this.ranges,d=0;d<u.length;d++){var g=u[d],b=g.$from;g=g.$to;var f=e.mapping.slice(l);b=f.map(b.pos);g=f.map(g.pos);d?e.deleteRange(b,g):(e.replaceRangeWith(b,g,h),T(e,l,h.isInline?-1:1))}};z.findFrom=function(e,h,r){var l=e.parent.inlineContent?new P(e):M(e.node(0),e.parent,e.pos,e.index(),h,r);if(l)return l;for(l=e.depth-1;0<=l;l--){var d=0>h?M(e.node(0),e.node(l),e.before(l+1),e.index(l),h,r):M(e.node(0),
e.node(l),e.after(l+1),e.index(l)+1,h,r);if(d)return d}};z.near=function(e,h){return void 0===h&&(h=1),this.findFrom(e,h)||this.findFrom(e,-h)||new Q(e.node(0))};z.atStart=function(e){return M(e,e,0,0,1)||new Q(e)};z.atEnd=function(e){return M(e,e,e.content.size,e.childCount,-1)||new Q(e)};z.fromJSON=function(e,h){var l=ba[h.type];return l?l.fromJSON(e,h):this.backwardsCompatFromJSON(e,h)};z.backwardsCompatFromJSON=function(e,h){if(null!=h.anchor)return P.fromJSON(e,h);if(null!=h.node)return q.fromJSON(e,
{anchor:h.node,head:h.after});throw new RangeError("Unrecognized JSON data "+JSON.stringify(h));};z.jsonID=function(e,h){if(e in ba)throw new RangeError("Duplicate use of selection JSON ID "+e);return ba[e]=h,h.prototype.jsonID=e,h};z.prototype.getBookmark=function(){return P.between(this.anchor,this.head).getBookmark()};Object.defineProperties(z.prototype,e);z.prototype.visible=!0;var Y=function(e,h){this.$from=e;this.$to=h},P=function(e){function h(h,d){void 0===d&&(d=h);e.call(this,h,d)}e&&(h.__proto__=
e);h.prototype=Object.create(e&&e.prototype);h.prototype.constructor=h;var l={$cursor:{}};return l.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},h.prototype.map=function(l,d){var g=l.resolve(d.map(this.head));if(!g.parent.inlineContent)return e.near(g);l=l.resolve(d.map(this.anchor));return new h(l.parent.inlineContent?l:g,g)},h.prototype.replace=function(h,d){(void 0===d&&(d=U.Slice.empty),e.prototype.replace.call(this,h,d),d==U.Slice.empty)&&(d=this.$from.marksAcross(this.$to))&&
h.ensureMarks(d)},h.prototype.eq=function(e){return e instanceof h&&e.anchor==this.anchor&&e.head==this.head},h.prototype.getBookmark=function(){return new x(this.anchor,this.head)},h.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},h.fromJSON=function(e,d){return new h(e.resolve(d.anchor),e.resolve(d.head))},h.create=function(e,d,g){void 0===g&&(g=d);var b=e.resolve(d);return new this(b,g==d?b:e.resolve(g))},h.between=function(l,d,g){var b=l.pos-d.pos;if(g&&!b||
(g=0<=b?1:-1),!d.parent.inlineContent){var f=e.findFrom(d,g,!0)||e.findFrom(d,-g,!0);if(!f)return e.near(d,g);d=f.$head}return l.parent.inlineContent||(0==b?l=d:(l=(e.findFrom(l,-g,!0)||e.findFrom(l,g,!0)).$anchor).pos<d.pos!=0>b&&(l=d)),new h(l,d)},Object.defineProperties(h.prototype,l),h}(z);z.jsonID("text",P);var x=function(e,h){this.anchor=e;this.head=h};x.prototype.map=function(e){return new x(e.map(this.anchor),e.map(this.head))};x.prototype.resolve=function(e){return P.between(e.resolve(this.anchor),
e.resolve(this.head))};var q=function(e){function h(h){var l=h.nodeAfter,d=h.node(0).resolve(h.pos+l.nodeSize);e.call(this,h,d);this.node=l}return e&&(h.__proto__=e),h.prototype=Object.create(e&&e.prototype),h.prototype.constructor=h,h.prototype.map=function(l,u){var d=u.mapResult(this.anchor);u=d.deleted;l=l.resolve(d.pos);return u?e.near(l):new h(l)},h.prototype.content=function(){return new U.Slice(U.Fragment.from(this.node),0,0)},h.prototype.eq=function(e){return e instanceof h&&e.anchor==this.anchor},
h.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},h.prototype.getBookmark=function(){return new v(this.anchor)},h.fromJSON=function(e,l){return new h(e.resolve(l.anchor))},h.create=function(e,h){return new this(e.resolve(h))},h.isSelectable=function(e){return!e.isText&&!1!==e.type.spec.selectable},h}(z);q.prototype.visible=!1;z.jsonID("node",q);var v=function(e){this.anchor=e};v.prototype.map=function(e){e=e.mapResult(this.anchor);var h=e.pos;return e.deleted?new x(h,h):new v(h)};
v.prototype.resolve=function(e){e=e.resolve(this.anchor);var h=e.nodeAfter;return h&&q.isSelectable(h)?new q(e):z.near(e)};var Q=function(e){function h(h){e.call(this,h.resolve(0),h.resolve(h.content.size))}return e&&(h.__proto__=e),h.prototype=Object.create(e&&e.prototype),h.prototype.constructor=h,h.prototype.toJSON=function(){return{type:"all"}},h.fromJSON=function(e){return new h(e)},h.prototype.map=function(e){return new h(e)},h.prototype.eq=function(e){return e instanceof h},h.prototype.getBookmark=
function(){return A},h}(z);z.jsonID("all",Q);var A={map:function(){return this},resolve:function(e){return new Q(e)}},C=function(e){function h(h){e.call(this,h.doc);this.time=Date.now();this.curSelection=h.selection;this.curSelectionFor=0;this.storedMarks=h.storedMarks;this.updated=0;this.meta=Object.create(null)}e&&(h.__proto__=e);h.prototype=Object.create(e&&e.prototype);h.prototype.constructor=h;var l={selection:{},selectionSet:{},storedMarksSet:{},isGeneric:{},scrolledIntoView:{}};return l.selection.get=
function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},h.prototype.setSelection=function(e){return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this},l.selectionSet.get=function(){return 0<(1&this.updated)},h.prototype.setStoredMarks=function(e){return this.storedMarks=e,this.updated|=
2,this},h.prototype.ensureMarks=function(e){return U.Mark.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this},h.prototype.addStoredMark=function(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))},h.prototype.removeStoredMark=function(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))},l.storedMarksSet.get=function(){return 0<(2&this.updated)},h.prototype.addStep=function(h,d){e.prototype.addStep.call(this,
h,d);this.updated&=-3;this.storedMarks=null},h.prototype.setTime=function(e){return this.time=e,this},h.prototype.replaceSelection=function(e){return this.selection.replace(this,e),this},h.prototype.replaceSelectionWith=function(e,d){var g=this.selection;return!1!==d&&(e=e.mark(this.storedMarks||(g.empty?g.$from.marks():g.$from.marksAcross(g.$to)))),g.replaceWith(this,e),this},h.prototype.deleteSelection=function(){return this.selection.replace(this),this},h.prototype.insertText=function(e,d,g){void 0===
g&&(g=d);var b=this.doc.type.schema;if(null==d)return e?this.replaceSelectionWith(b.text(e),!0):this.deleteSelection();if(!e)return this.deleteRange(d,g);var f=this.storedMarks;f||(f=this.doc.resolve(d),f=g==d?f.marks():f.marksAcross(this.doc.resolve(g)));return this.replaceRangeWith(d,g,b.text(e,f))},h.prototype.setMeta=function(e,d){return this.meta["string"==typeof e?e:e.key]=d,this},h.prototype.getMeta=function(e){return this.meta["string"==typeof e?e:e.key]},l.isGeneric.get=function(){for(var e in this.meta)return!1;
return!0},h.prototype.scrollIntoView=function(){return this.updated|=4,this},l.scrolledIntoView.get=function(){return 0<(4&this.updated)},Object.defineProperties(h.prototype,l),h}(aa.Transform),ja=function(e,h,p){this.name=e;e=h.init;this.init=p&&e?e.bind(p):e;h=h.apply;this.apply=p&&h?h.bind(p):h},y=[new ja("doc",{init:function(e){return e.doc||e.schema.topNodeType.createAndFill()},apply:function(e){return e.doc}}),new ja("selection",{init:function(e,h){return e.selection||z.atStart(h.doc)},apply:function(e){return e.selection}}),
new ja("storedMarks",{init:function(){return null},apply:function(e,h,p,q){return q.selection.$cursor?e.storedMarks:null}}),new ja("scrollToSelection",{init:function(){return 0},apply:function(e,h){return e.scrolledIntoView?h+1:h}})],Z=function(e,h){var l=this;this.schema=e;this.fields=y.concat();this.plugins=[];this.pluginsByKey=Object.create(null);h&&h.forEach(function(e){if(l.pluginsByKey[e.key])throw new RangeError("Adding different instances of a keyed plugin ("+e.key+")");l.plugins.push(e);
l.pluginsByKey[e.key]=e;e.spec.state&&l.fields.push(new ja(e.key,e.spec.state,e))})},O=function(e){this.config=e};e={schema:{},plugins:{},tr:{}};e.schema.get=function(){return this.config.schema};e.plugins.get=function(){return this.config.plugins};O.prototype.apply=function(e){return this.applyTransaction(e).state};O.prototype.filterTransaction=function(e,h){void 0===h&&(h=-1);for(var l=0;l<this.config.plugins.length;l++)if(l!=h){var p=this.config.plugins[l];if(p.spec.filterTransaction&&!p.spec.filterTransaction.call(p,
e,this))return!1}return!0};O.prototype.applyTransaction=function(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};var h=[e];e=this.applyInner(e);for(var l=null;;){for(var p=!1,d=0;d<this.config.plugins.length;d++){var g=this.config.plugins[d];if(g.spec.appendTransaction){var b=l?l[d].n:0,f=l?l[d].state:this;if((g=b<h.length&&g.spec.appendTransaction.call(g,b?h.slice(b):h,f,e))&&e.filterTransaction(g,d)){if(g.setMeta("appendedTransaction",g),!l)for(l=[],p=0;p<this.config.plugins.length;p++)l.push(p<
d?{state:e,n:h.length}:{state:this,n:0});h.push(g);e=e.applyInner(g);p=!0}l&&(l[d]={state:e,n:h.length})}}if(!p)return{state:e,transactions:h}}};O.prototype.applyInner=function(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var h=new O(this.config),l=this.config.fields,p=0;p<l.length;p++){var d=l[p];h[d.name]=d.apply(e,this[d.name],this,h)}for(l=0;l<N.length;l++)N[l](this,e,h);return h};e.tr.get=function(){return new C(this)};O.create=function(e){for(var h=
new Z(e.schema||e.doc.type.schema,e.plugins),l=new O(h),p=0;p<h.fields.length;p++)l[h.fields[p].name]=h.fields[p].init(e,l);return l};O.prototype.reconfigure=function(e){var h=new Z(e.schema||this.schema,e.plugins),l=h.fields;h=new O(h);for(var p=0;p<l.length;p++){var d=l[p].name;h[d]=this.hasOwnProperty(d)?this[d]:l[p].init(e,h)}return h};O.prototype.toJSON=function(e){var h={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(e)for(var l in e){if("doc"==l||"selection"==l)throw new RangeError("The JSON fields `doc` and `selection` are reserved");
var p=e[l],d=p.spec.state;d&&d.toJSON&&(h[l]=d.toJSON.call(p,this[p.key]))}return h};O.fromJSON=function(e,h,p){if(!e.schema)throw new RangeError("Required config field 'schema' missing");var l=new Z(e.schema,e.plugins),d=new O(l);return l.fields.forEach(function(g){if("doc"==g.name)d.doc=U.Node.fromJSON(e.schema,h.doc);else if("selection"==g.name)d.selection=z.fromJSON(d.doc,h.selection);else{if(p)for(var b in p){var f=p[b],l=f.spec.state;if(f.key==g.name&&l&&l.fromJSON&&Object.prototype.hasOwnProperty.call(h,
b))return void(d[g.name]=l.fromJSON.call(f,e,h[b],d))}d[g.name]=g.init(e,d)}}),d};O.addApplyListener=function(e){N.push(e)};O.removeApplyListener=function(e){e=N.indexOf(e);-1<e&&N.splice(e,1)};Object.defineProperties(O.prototype,e);var N=[];e=function(e){this.props={};e.props&&function g(e,l,d){for(var b in e){var f=e[b];f instanceof Function?f=f.bind(l):"handleDOMEvents"==b&&(f=g(f,l,{}));d[b]=f}return d}(e.props,this,this.props);this.spec=e;this.key=e.key?e.key.key:G("plugin")};e.prototype.getState=
function(e){return e[this.key]};var F=Object.create(null);B=function(e){void 0===e&&(e="key");this.key=G(e)};B.prototype.get=function(e){return e.config.pluginsByKey[this.key]};B.prototype.getState=function(e){return e[this.key]};p.Selection=z;p.SelectionRange=Y;p.TextSelection=P;p.NodeSelection=q;p.AllSelection=Q;p.Transaction=C;p.EditorState=O;p.Plugin=e;p.PluginKey=B},38:function(e,p,B){function M(a,c){return f.index=a,f.offset=c,f}function T(a,c){if(a===c)return!0;if(!a||"object"!=typeof a||!c||
"object"!=typeof c)return!1;var b=Array.isArray(a);if(Array.isArray(c)!=b)return!1;if(b){if(a.length!=c.length)return!1;for(b=0;b<a.length;b++)if(!T(a[b],c[b]))return!1}else{for(var d in a)if(!(d in c&&T(a[d],c[d])))return!1;for(var f in c)if(!(f in a))return!1}return!0}function G(a){a=Error.call(this,a);return a.__proto__=G.prototype,a}function U(a,c,d){if(d.openStart>a.depth)throw new G("Inserted content deeper than insertion position");if(a.depth-d.openStart!=c.depth-d.openEnd)throw new G("Inconsistent open depths");
return function ma(a,c,d,f){var e=a.index(f),g=a.node(f);if(e==c.index(f)&&f<a.depth-d.openStart)return a=ma(a,c,d,f+1),g.copy(g.content.replaceChild(e,a));if(d.content.size){if(d.openStart||d.openEnd||a.depth!=f||c.depth!=f)return d=function(a,c){for(var d=c.depth-a.openStart,f=c.node(d).copy(a.content),e=d-1;0<=e;e--)f=c.node(e).copy(b.from(f));return{start:f.resolveNoCache(a.openStart+d),end:f.resolveNoCache(f.content.size-a.openEnd-d)}}(d,a),P(g,function cb(a,c,d,f,e){var g=a.depth>e&&ba(a,c,
e+1),n=f.depth>e&&ba(d,f,e+1),h=[];Y(null,a,e,h);g&&n&&c.index(e)==d.index(e)?(aa(g,n),z(P(g,cb(a,c,d,f,e+1)),h)):(g&&z(P(g,x(a,c,e+1)),h),Y(c,d,e,h),n&&z(P(n,x(d,f,e+1)),h));Y(f,null,e,h);return new b(h)}(a,d.start,d.end,c,f));g=a.parent;f=g.content;return P(g,f.cut(0,a.parentOffset).append(d.content).append(f.cut(c.parentOffset)))}return P(g,x(a,c,f))}(a,c,d,0)}function aa(a,c){if(!c.type.compatibleContent(a.type))throw new G("Cannot join "+c.type.name+" onto "+a.type.name);}function ba(a,c,b){a=
a.node(b);return aa(a,c.node(b)),a}function z(a,c){var b=c.length-1;0<=b&&a.isText&&a.sameMarkup(c[b])?c[b]=a.withText(c[b].text+a.text):c.push(a)}function Y(a,c,b,d){var f=(c||a).node(b),e=0,g=c?c.index(b):f.childCount;a&&(e=a.index(b),a.depth>b?e++:a.textOffset&&(z(a.nodeAfter,d),e++));for(a=e;a<g;a++)z(f.child(a),d);c&&c.depth==b&&c.textOffset&&z(c.nodeBefore,d)}function P(a,c){if(!a.type.validContent(c))throw new G("Invalid content for node "+a.type.name);return a.copy(c)}function x(a,c,d){var f=
[];(Y(null,a,d,f),a.depth>d)&&z(P(ba(a,c,d+1),x(a,c,d+1)),f);return Y(c,null,d,f),new b(f)}function q(a,c){for(var b=a.length-1;0<=b;b--)c=a[b].type.name+"("+c+")";return c}function v(a){var c=[];do c.push(Q(a));while(a.eat("|"));return 1==c.length?c[0]:{type:"choice",exprs:c}}function Q(a){var c=[];do c.push(A(a));while(a.next&&")"!=a.next&&"|"!=a.next);return 1==c.length?c[0]:{type:"seq",exprs:c}}function A(a){for(var c=function(a){if(a.eat("(")){var c=v(a);return a.eat(")")||a.err("Missing closing paren"),
c}if(!/\W/.test(a.next))return c=function(a,c){var b=a.nodeTypes,d=b[c];if(d)return[d];d=[];for(var f in b){var e=b[f];-1<e.groups.indexOf(c)&&d.push(e)}0==d.length&&a.err("No node type or group '"+c+"' found");return d}(a,a.next).map(function(c){return null==a.inline?a.inline=c.isInline:a.inline!=c.isInline&&a.err("Mixing inline and block content"),{type:"name",value:c}}),a.pos++,1==c.length?c[0]:{type:"choice",exprs:c};a.err("Unexpected token '"+a.next+"'")}(a);;)if(a.eat("+"))c={type:"plus",expr:c};
else if(a.eat("*"))c={type:"star",expr:c};else if(a.eat("?"))c={type:"opt",expr:c};else{if(!a.eat("{"))break;c=ja(a,c)}return c}function C(a){/\D/.test(a.next)&&a.err("Expected number, got '"+a.next+"'");var c=Number(a.next);return a.pos++,c}function ja(a,c){var b=C(a),d=b;return a.eat(",")&&(d="}"!=a.next?C(a):-1),a.eat("}")||a.err("Unclosed braced range"),{type:"range",min:b,max:d,expr:c}}function y(a,c){return a-c}function Z(a,c){var b=[];return function ab(c){b.push(c);c=a[c];for(var d=0;d<c.length;d++){var f=
c[d],e=f.to;f.term||-1!=b.indexOf(e)||ab(e)}}(c),b.sort(y)}function O(a){var c=Object.create(null),b;for(b in a){var d=a[b];if(!d.hasDefault)return null;c[b]=d.default}return c}function N(a,c){var b=Object.create(null),d;for(d in a){var f=c&&c[d];if(void 0===f){f=a[d];if(!f.hasDefault)throw new RangeError("No value supplied for attribute "+d);f=f.default}b[d]=f}return b}function F(a){var c=Object.create(null);if(a)for(var b in a)c[b]=new La(a[b]);return c}function l(a,c){for(var b=[],d=0;d<c.length;d++){var f=
c[d],e=a.marks[f],g=e;if(e)b.push(e);else for(var h in a.marks)e=a.marks[h],("_"==f||e.spec.group&&-1<e.spec.group.split(" ").indexOf(f))&&b.push(g=e);if(!g)throw new SyntaxError("Unknown mark type: '"+c[d]+"'");}return b}function h(a){return(a?1:0)|("full"===a?2:0)}function r(a){var c={},b;for(b in a)c[b]=a[b];return c}function u(a){var c={},b;for(b in a){var d=a[b].spec.toDOM;d&&(c[b]=d)}return c}Object.defineProperty(p,"__esModule",{value:!0});var d,g=(d=B(462))&&"object"==typeof d&&"default"in
d?d.default:d,b=function(a,c){if(this.content=a,this.size=c||0,null==c)for(c=0;c<a.length;c++)this.size+=a[c].nodeSize};e={firstChild:{},lastChild:{},childCount:{}};b.prototype.nodesBetween=function(a,c,b,d,f){void 0===d&&(d=0);for(var e=0,g=0;g<c;e++){var n=this.content[e],h=g+n.nodeSize;h>a&&!1!==b(n,d+g,f,e)&&n.content.size&&(g+=1,n.nodesBetween(Math.max(0,a-g),Math.min(n.content.size,c-g),b,d+g));g=h}};b.prototype.descendants=function(a){this.nodesBetween(0,this.size,a)};b.prototype.textBetween=
function(a,c,b,d){var f="",e=!0;return this.nodesBetween(a,c,function(g,n){g.isText?(f+=g.text.slice(Math.max(a,n)-n,c-n),e=!b):g.isLeaf&&d?(f+=d,e=!b):!e&&g.isBlock&&(f+=b,e=!0)},0),f};b.prototype.append=function(a){if(!a.size)return this;if(!this.size)return a;var c=this.lastChild,d=a.firstChild,f=this.content.slice(),e=0;for(c.isText&&c.sameMarkup(d)&&(f[f.length-1]=c.withText(c.text+d.text),e=1);e<a.content.length;e++)f.push(a.content[e]);return new b(f,this.size+a.size)};b.prototype.cut=function(a,
c){if(null==c&&(c=this.size),0==a&&c==this.size)return this;var d=[],f=0;if(c>a)for(var e=0,g=0;g<c;e++){var h=this.content[e],l=g+h.nodeSize;l>a&&((g<a||l>c)&&(h=h.isText?h.cut(Math.max(0,a-g),Math.min(h.text.length,c-g)):h.cut(Math.max(0,a-g-1),Math.min(h.content.size,c-g-1))),d.push(h),f+=h.nodeSize);g=l}return new b(d,f)};b.prototype.cutByIndex=function(a,c){return a==c?b.empty:0==a&&c==this.content.length?this:new b(this.content.slice(a,c))};b.prototype.replaceChild=function(a,c){var d=this.content[a];
if(d==c)return this;var f=this.content.slice();d=this.size+c.nodeSize-d.nodeSize;return f[a]=c,new b(f,d)};b.prototype.addToStart=function(a){return new b([a].concat(this.content),this.size+a.nodeSize)};b.prototype.addToEnd=function(a){return new b(this.content.concat(a),this.size+a.nodeSize)};b.prototype.eq=function(a){if(this.content.length!=a.content.length)return!1;for(var c=0;c<this.content.length;c++)if(!this.content[c].eq(a.content[c]))return!1;return!0};e.firstChild.get=function(){return this.content.length?
this.content[0]:null};e.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null};e.childCount.get=function(){return this.content.length};b.prototype.child=function(a){var c=this.content[a];if(!c)throw new RangeError("Index "+a+" out of range for "+this);return c};b.prototype.maybeChild=function(a){return this.content[a]};b.prototype.forEach=function(a){for(var c=0,b=0;c<this.content.length;c++){var d=this.content[c];a(d,b,c);b+=d.nodeSize}};b.prototype.findDiffStart=
function(a,c){return void 0===c&&(c=0),function Ba(a,c,b){for(var d=0;;d++){if(d==a.childCount||d==c.childCount)return a.childCount==c.childCount?null:b;var f=a.child(d),e=c.child(d);if(f!=e){if(!f.sameMarkup(e))return b;if(f.isText&&f.text!=e.text){for(a=0;f.text[a]==e.text[a];a++)b++;return b}if(f.content.size||e.content.size)if(e=Ba(f.content,e.content,b+1),null!=e)return e}b+=f.nodeSize}}(this,a,c)};b.prototype.findDiffEnd=function(a,c,b){return void 0===c&&(c=this.size),void 0===b&&(b=a.size),
function ma(a,c,b,d){for(var f=a.childCount,e=c.childCount;;){if(0==f||0==e)return f==e?null:{a:b,b:d};var g=a.child(--f),n=c.child(--e),h=g.nodeSize;if(g!=n){if(!g.sameMarkup(n))return{a:b,b:d};if(g.isText&&g.text!=n.text){a=0;for(c=Math.min(g.text.length,n.text.length);a<c&&g.text[g.text.length-a-1]==n.text[n.text.length-a-1];)a++,b--,d--;return{a:b,b:d}}if(g.content.size||n.content.size)if(g=ma(g.content,n.content,b-1,d-1))return g}b-=h;d-=h}}(this,a,c,b)};b.prototype.findIndex=function(a,c){if(void 0===
c&&(c=-1),0==a)return M(0,a);if(a==this.size)return M(this.content.length,a);if(a>this.size||0>a)throw new RangeError("Position "+a+" outside of fragment ("+this+")");for(var b=0,d=0;;b++){var f=d+this.child(b).nodeSize;if(f>=a)return f==a||0<c?M(b+1,f):M(b,d);d=f}};b.prototype.toString=function(){return"\x3c"+this.toStringInner()+"\x3e"};b.prototype.toStringInner=function(){return this.content.join(", ")};b.prototype.toJSON=function(){return this.content.length?this.content.map(function(a){return a.toJSON()}):
null};b.fromJSON=function(a,c){return c?new b(c.map(a.nodeFromJSON)):b.empty};b.fromArray=function(a){if(!a.length)return b.empty;for(var c,d=0,f=0;f<a.length;f++){var e=a[f];d+=e.nodeSize;f&&e.isText&&a[f-1].sameMarkup(e)?(c||(c=a.slice(0,f)),c[c.length-1]=e.withText(c[c.length-1].text+e.text)):c&&c.push(e)}return new b(c||a,d)};b.from=function(a){return a?a instanceof b?a:Array.isArray(a)?this.fromArray(a):new b([a],a.nodeSize):b.empty};Object.defineProperties(b.prototype,e);var f={index:0,offset:0};
b.empty=new b([],0);var t=function(a,c){this.type=a;this.attrs=c};t.prototype.addToSet=function(a){for(var c,b=!1,d=0;d<a.length;d++){var f=a[d];if(this.eq(f))return a;if(this.type.excludes(f.type))c||(c=a.slice(0,d));else{if(f.type.excludes(this.type))return a;!b&&f.type.rank>this.type.rank&&(c||(c=a.slice(0,d)),c.push(this),b=!0);c&&c.push(f)}}return c||(c=a.slice()),b||c.push(this),c};t.prototype.removeFromSet=function(a){for(var c=0;c<a.length;c++)if(this.eq(a[c]))return a.slice(0,c).concat(a.slice(c+
1));return a};t.prototype.isInSet=function(a){for(var c=0;c<a.length;c++)if(this.eq(a[c]))return!0;return!1};t.prototype.eq=function(a){return this==a||this.type==a.type&&T(this.attrs,a.attrs)};t.prototype.toJSON=function(){var a={type:this.type.name},c;for(c in this.attrs){a.attrs=this.attrs;break}return a};t.fromJSON=function(a,c){a=a.marks[c.type];if(!a)throw new RangeError("There is no mark type "+c.type+" in this schema");return a.create(c.attrs)};t.sameSet=function(a,c){if(a==c)return!0;if(a.length!=
c.length)return!1;for(var b=0;b<a.length;b++)if(!a[b].eq(c[b]))return!1;return!0};t.setFrom=function(a){if(!a||0==a.length)return t.none;if(a instanceof t)return[a];a=a.slice();return a.sort(function(a,b){return a.type.rank-b.type.rank}),a};t.none=[];G.prototype=Object.create(Error.prototype);G.prototype.constructor=G;G.prototype.name="ReplaceError";var E=function(a,c,b){this.content=a;this.openStart=c;this.openEnd=b};e={size:{}};e.size.get=function(){return this.content.size-this.openStart-this.openEnd};
E.prototype.insertAt=function(a,c){return(a=function Ja(a,c,b,d){var f=a.findIndex(c),e=f.index,g=f.offset;f=a.maybeChild(e);return g==c||f.isText?d&&!d.canReplace(e,e,b)?null:a.cut(0,c).append(b).append(a.cut(c)):(c=Ja(f.content,c-g-1,b))&&a.replaceChild(e,f.copy(c))}(this.content,a+this.openStart,c,null))&&new E(a,this.openStart,this.openEnd)};E.prototype.removeBetween=function(a,c){return new E(function Ba(a,c,b){var d=a.findIndex(c),f=d.index;d=d.offset;var e=a.maybeChild(f),g=a.findIndex(b),
h=g.index;g=g.offset;if(d==c||e.isText){if(g!=b&&!a.child(h).isText)throw new RangeError("Removing non-flat range");return a.cut(0,c).append(a.cut(b))}if(f!=h)throw new RangeError("Removing non-flat range");return a.replaceChild(f,e.copy(Ba(e.content,c-d-1,b-d-1)))}(this.content,a+this.openStart,c+this.openStart),this.openStart,this.openEnd)};E.prototype.eq=function(a){return this.content.eq(a.content)&&this.openStart==a.openStart&&this.openEnd==a.openEnd};E.prototype.toString=function(){return this.content+
"("+this.openStart+","+this.openEnd+")"};E.prototype.toJSON=function(){if(!this.content.size)return null;var a={content:this.content.toJSON()};return 0<this.openStart&&(a.openStart=this.openStart),0<this.openEnd&&(a.openEnd=this.openEnd),a};E.fromJSON=function(a,c){return c?new E(b.fromJSON(a,c.content),c.openStart||0,c.openEnd||0):E.empty};E.maxOpen=function(a){for(var c=0,b=0,d=a.firstChild;d&&!d.isLeaf;d=d.firstChild)c++;for(d=a.lastChild;d&&!d.isLeaf;d=d.lastChild)b++;return new E(a,c,b)};Object.defineProperties(E.prototype,
e);E.empty=new E(b.empty,0,0);var I=function(a,c,b){this.pos=a;this.path=c;this.depth=c.length/3-1;this.parentOffset=b};e={parent:{},doc:{},textOffset:{},nodeAfter:{},nodeBefore:{}};I.prototype.resolveDepth=function(a){return null==a?this.depth:0>a?this.depth+a:a};e.parent.get=function(){return this.node(this.depth)};e.doc.get=function(){return this.node(0)};I.prototype.node=function(a){return this.path[3*this.resolveDepth(a)]};I.prototype.index=function(a){return this.path[3*this.resolveDepth(a)+
1]};I.prototype.indexAfter=function(a){return a=this.resolveDepth(a),this.index(a)+(a!=this.depth||this.textOffset?1:0)};I.prototype.start=function(a){return 0==(a=this.resolveDepth(a))?0:this.path[3*a-1]+1};I.prototype.end=function(a){return a=this.resolveDepth(a),this.start(a)+this.node(a).content.size};I.prototype.before=function(a){if(!(a=this.resolveDepth(a)))throw new RangeError("There is no position before the top-level node");return a==this.depth+1?this.pos:this.path[3*a-1]};I.prototype.after=
function(a){if(!(a=this.resolveDepth(a)))throw new RangeError("There is no position after the top-level node");return a==this.depth+1?this.pos:this.path[3*a-1]+this.path[3*a].nodeSize};e.textOffset.get=function(){return this.pos-this.path[this.path.length-1]};e.nodeAfter.get=function(){var a=this.parent,c=this.index(this.depth);if(c==a.childCount)return null;var b=this.pos-this.path[this.path.length-1],d=a.child(c);return b?a.child(c).cut(b):d};e.nodeBefore.get=function(){var a=this.index(this.depth),
c=this.pos-this.path[this.path.length-1];return c?this.parent.child(a).cut(0,c):0==a?null:this.parent.child(a-1)};I.prototype.marks=function(){var a=this.parent,c=this.index();if(0==a.content.size)return t.none;if(this.textOffset)return a.child(c).marks;var b=a.maybeChild(c-1);a=a.maybeChild(c);b||(a=b=a);b=b.marks;for(c=0;c<b.length;c++)!1!==b[c].type.spec.inclusive||a&&b[c].isInSet(a.marks)||(b=b[c--].removeFromSet(b));return b};I.prototype.marksAcross=function(a){var c=this.parent.maybeChild(this.index());
if(!c||!c.isInline)return null;c=c.marks;a=a.parent.maybeChild(a.index());for(var b=0;b<c.length;b++)!1!==c[b].type.spec.inclusive||a&&c[b].isInSet(a.marks)||(c=c[b--].removeFromSet(c));return c};I.prototype.sharedDepth=function(a){for(var c=this.depth;0<c;c--)if(this.start(c)<=a&&this.end(c)>=a)return c;return 0};I.prototype.blockRange=function(a,c){if(void 0===a&&(a=this),a.pos<this.pos)return a.blockRange(this);for(var b=this.depth-(this.parent.inlineContent||this.pos==a.pos?1:0);0<=b;b--)if(a.pos<=
this.end(b)&&(!c||c(this.node(b))))return new Ia(this,a,b)};I.prototype.sameParent=function(a){return this.pos-this.parentOffset==a.pos-a.parentOffset};I.prototype.max=function(a){return a.pos>this.pos?a:this};I.prototype.min=function(a){return a.pos<this.pos?a:this};I.prototype.toString=function(){for(var a="",c=1;c<=this.depth;c++)a+=(a?"/":"")+this.node(c).type.name+"_"+this.index(c-1);return a+":"+this.parentOffset};I.resolve=function(a,c){if(!(0<=c&&c<=a.content.size))throw new RangeError("Position "+
c+" out of range");for(var b=[],d=0,f=c;;){var e=a.content.findIndex(f),g=e.index;e=e.offset;var h=f-e;if(b.push(a,g,d+e),!h)break;if((a=a.child(g)).isText)break;f=h-1;d+=e+1}return new I(c,b,f)};I.resolveCached=function(a,c){for(var b=0;b<ka.length;b++){var d=ka[b];if(d.pos==c&&d.node(0)==a)return d}a=ka[la]=I.resolve(a,c);return la=(la+1)%Ua,a};Object.defineProperties(I.prototype,e);var ka=[],la=0,Ua=6,Ia=function(a,c,b){this.$from=a;this.$to=c;this.depth=b};e={start:{},end:{},parent:{},startIndex:{},
endIndex:{}};e.start.get=function(){return this.$from.before(this.depth+1)};e.end.get=function(){return this.$to.after(this.depth+1)};e.parent.get=function(){return this.$from.node(this.depth)};e.startIndex.get=function(){return this.$from.index(this.depth)};e.endIndex.get=function(){return this.$to.indexAfter(this.depth)};Object.defineProperties(Ia.prototype,e);var gb=Object.create(null),H=function(a,c,d,f){this.type=a;this.attrs=c;this.content=d||b.empty;this.marks=f||t.none};e={nodeSize:{},childCount:{},
textContent:{},firstChild:{},lastChild:{},isBlock:{},isTextblock:{},inlineContent:{},isInline:{},isText:{},isLeaf:{},isAtom:{}};e.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size};e.childCount.get=function(){return this.content.childCount};H.prototype.child=function(a){return this.content.child(a)};H.prototype.maybeChild=function(a){return this.content.maybeChild(a)};H.prototype.forEach=function(a){this.content.forEach(a)};H.prototype.nodesBetween=function(a,c,b,d){void 0===d&&(d=
0);this.content.nodesBetween(a,c,b,d,this)};H.prototype.descendants=function(a){this.nodesBetween(0,this.content.size,a)};e.textContent.get=function(){return this.textBetween(0,this.content.size,"")};H.prototype.textBetween=function(a,c,b,d){return this.content.textBetween(a,c,b,d)};e.firstChild.get=function(){return this.content.firstChild};e.lastChild.get=function(){return this.content.lastChild};H.prototype.eq=function(a){return this==a||this.sameMarkup(a)&&this.content.eq(a.content)};H.prototype.sameMarkup=
function(a){return this.hasMarkup(a.type,a.attrs,a.marks)};H.prototype.hasMarkup=function(a,c,b){return this.type==a&&T(this.attrs,c||a.defaultAttrs||gb)&&t.sameSet(this.marks,b||t.none)};H.prototype.copy=function(a){return void 0===a&&(a=null),a==this.content?this:new this.constructor(this.type,this.attrs,a,this.marks)};H.prototype.mark=function(a){return a==this.marks?this:new this.constructor(this.type,this.attrs,this.content,a)};H.prototype.cut=function(a,c){return 0==a&&c==this.content.size?
this:this.copy(this.content.cut(a,c))};H.prototype.slice=function(a,c,b){if(void 0===c&&(c=this.content.size),void 0===b&&(b=!1),a==c)return E.empty;a=this.resolve(a);var d=this.resolve(c);c=b?0:a.sharedDepth(c);b=a.start(c);b=a.node(c).content.cut(a.pos-b,d.pos-b);return new E(b,a.depth-c,d.depth-c)};H.prototype.replace=function(a,c,b){return U(this.resolve(a),this.resolve(c),b)};H.prototype.nodeAt=function(a){for(var c=this;;){var b=c.content.findIndex(a),d=b.offset;if(!(c=c.maybeChild(b.index)))return null;
if(d==a||c.isText)return c;a-=d+1}};H.prototype.childAfter=function(a){var c=this.content.findIndex(a);a=c.index;c=c.offset;return{node:this.content.maybeChild(a),index:a,offset:c}};H.prototype.childBefore=function(a){if(0==a)return{node:null,index:0,offset:0};var c=this.content.findIndex(a),b=c.index;c=c.offset;if(c<a)return{node:this.content.child(b),index:b,offset:c};a=this.content.child(b-1);return{node:a,index:b-1,offset:c-a.nodeSize}};H.prototype.resolve=function(a){return I.resolveCached(this,
a)};H.prototype.resolveNoCache=function(a){return I.resolve(this,a)};H.prototype.rangeHasMark=function(a,c,b){var d=!1;return this.nodesBetween(a,c,function(a){return b.isInSet(a.marks)&&(d=!0),!d}),d};e.isBlock.get=function(){return this.type.isBlock};e.isTextblock.get=function(){return this.type.isTextblock};e.inlineContent.get=function(){return this.type.inlineContent};e.isInline.get=function(){return this.type.isInline};e.isText.get=function(){return this.type.isText};e.isLeaf.get=function(){return this.type.isLeaf};
e.isAtom.get=function(){return this.type.isAtom};H.prototype.toString=function(){var a=this.type.name;return this.content.size&&(a+="("+this.content.toStringInner()+")"),q(this.marks,a)};H.prototype.contentMatchAt=function(a){return this.type.contentMatch.matchFragment(this.content,0,a)};H.prototype.canReplace=function(a,c,d,f,e){void 0===d&&(d=b.empty);void 0===f&&(f=0);void 0===e&&(e=d.childCount);c=(a=this.contentMatchAt(a).matchFragment(d,f,e))&&a.matchFragment(this.content,c);if(!c||!c.validEnd)return!1;
for(;f<e;f++)if(!this.type.allowsMarks(d.child(f).marks))return!1;return!0};H.prototype.canReplaceWith=function(a,c,b,d){if(d&&!this.type.allowsMarks(d))return!1;c=(a=this.contentMatchAt(a).matchType(b))&&a.matchFragment(this.content,c);return!!c&&c.validEnd};H.prototype.canAppend=function(a){return a.content.size?this.canReplace(this.childCount,this.childCount,a.content):this.type.compatibleContent(a.type)};H.prototype.defaultContentType=function(a){return this.contentMatchAt(a).defaultType};H.prototype.check=
function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach(function(a){return a.check()})};H.prototype.toJSON=function(){var a={type:this.type.name},c;for(c in this.attrs){a.attrs=this.attrs;break}return this.content.size&&(a.content=this.content.toJSON()),this.marks.length&&(a.marks=this.marks.map(function(a){return a.toJSON()})),a};H.fromJSON=function(a,c){var d=c.marks&&c.marks.map(a.markFromJSON);
if("text"==c.type)return a.text(c.text,d);var f=a.nodeType(c.type);if(!f)throw new RangeError("There is no node type "+c.type+" in this schema");return f.create(c.attrs,b.fromJSON(a,c.content),d)};Object.defineProperties(H.prototype,e);var Ra=function(a){function c(c,b,d,f){if(a.call(this,c,b,null,f),!d)throw new RangeError("Empty text nodes are not allowed");this.text=d}a&&(c.__proto__=a);c.prototype=Object.create(a&&a.prototype);c.prototype.constructor=c;var b={textContent:{},nodeSize:{}};return c.prototype.toString=
function(){return q(this.marks,JSON.stringify(this.text))},b.textContent.get=function(){return this.text},c.prototype.textBetween=function(a,c){return this.text.slice(a,c)},b.nodeSize.get=function(){return this.text.length},c.prototype.mark=function(a){return a==this.marks?this:new c(this.type,this.attrs,this.text,a)},c.prototype.withText=function(a){return a==this.text?this:new c(this.type,this.attrs,a,this.marks)},c.prototype.cut=function(a,c){return void 0===a&&(a=0),void 0===c&&(c=this.text.length),
0==a&&c==this.text.length?this:this.withText(this.text.slice(a,c))},c.prototype.eq=function(a){return this.sameMarkup(a)&&this.text==a.text},c.prototype.toJSON=function(){var c=a.prototype.toJSON.call(this);return c.text=this.text,c},Object.defineProperties(c.prototype,b),c}(H),da=function(a){this.validEnd=a;this.next=[];this.wrapCache=[]};e={inlineContent:{},defaultType:{}};da.parse=function(a,c){a=new Ea(a,c);if(null==a.next)return da.empty;c=v(a);a.next&&a.err("Unexpected trailing text");c=function(a){var c=
Object.create(null);return function Ba(b){var d=[];b.forEach(function(c){a[c].forEach(function(c){var b=c.term;c=c.to;if(b){var f=d.indexOf(b),e=-1<f&&d[f+1];Z(a,c).forEach(function(a){e||d.push(b,e=[]);-1==e.indexOf(a)&&e.push(a)})}})});b=c[b.join(",")]=new da(-1<b.indexOf(a.length-1));for(var f=0;f<d.length;f+=2){var e=d[f+1].sort(y);b.next.push(d[f],c[e.join(",")]||Ba(e))}return b}(Z(a,0))}(function(a){function c(){return f.push([])-1}function b(a,c,b){c={term:b,to:c};return f[a].push(c),c}function d(a,
c){a.forEach(function(a){return a.to=c})}var f=[[]];return d(function qa(a,f){if("choice"==a.type)return a.exprs.reduce(function(a,c){return a.concat(qa(c,f))},[]);if("seq"==a.type)for(var e=0;;e++){var g=qa(a.exprs[e],f);if(e==a.exprs.length-1)return g;d(g,f=c())}else{if("star"==a.type)return e=c(),b(f,e),d(qa(a.expr,e),e),[b(e)];if("plus"==a.type)return e=c(),d(qa(a.expr,f),e),d(qa(a.expr,e),e),[b(e)];if("opt"==a.type)return[b(f)].concat(qa(a.expr,f));if("range"==a.type){e=f;for(g=0;g<a.min;g++){var h=
c();d(qa(a.expr,e),h);e=h}if(-1==a.max)d(qa(a.expr,e),e);else for(g=a.min;g<a.max;g++)h=c(),b(e,h),d(qa(a.expr,e),h),e=h;return[b(e)]}if("name"==a.type)return[b(f,null,a.value)]}}(a,0),c()),f}(c));return function(a,c){var b=0;for(a=[a];b<a.length;b++){for(var d=a[b],f=!d.validEnd,e=[],g=0;g<d.next.length;g+=2){var h=d.next[g+1];e.push(d.next[g].name);f&&!d.next[g].hasRequiredAttrs()&&(f=!1);-1==a.indexOf(h)&&a.push(h)}f&&c.err("Only non-generatable nodes ("+e.join(", ")+") after a match state")}}(c,
a),c};da.prototype.matchType=function(a){for(var c=0;c<this.next.length;c+=2)if(this.next[c]==a)return this.next[c+1];return null};da.prototype.matchFragment=function(a,c,b){void 0===c&&(c=0);void 0===b&&(b=a.childCount);for(var d=this;d&&c<b;c++)d=d.matchType(a.child(c).type);return d};e.inlineContent.get=function(){var a=this.next[0];return!!a&&a.isInline};e.defaultType.get=function(){return this.next[0]};da.prototype.compatible=function(a){for(var c=0;c<this.next.length;c+=2)for(var b=0;b<a.next.length;b+=
2)if(this.next[c]==a.next[b])return!0;return!1};da.prototype.fillBefore=function(a,c,d){void 0===c&&(c=!1);void 0===d&&(d=0);var f=[this];return function Ja(e,g){var h=e.matchFragment(a,d);if(h&&(!c||h.validEnd))return b.from(g.map(function(a){return a.createAndFill()}));for(h=0;h<e.next.length;h+=2){var n=e.next[h],l=e.next[h+1];if(!n.hasRequiredAttrs()&&-1==f.indexOf(l)&&(f.push(l),n=Ja(l,g.concat(n))))return n}}(this,[])};da.prototype.findWrapping=function(a){for(var c=0;c<this.wrapCache.length;c+=
2)if(this.wrapCache[c]==a)return this.wrapCache[c+1];c=this.computeWrapping(a);return this.wrapCache.push(a,c),c};da.prototype.computeWrapping=function(a){for(var c=Object.create(null),b=[{match:this,type:null,via:null}];b.length;){var d=b.shift(),f=d.match;if(f.matchType(a)){for(a=[];d.type;d=d.via)a.push(d.type);return a.reverse()}for(var e=0;e<f.next.length;e+=2){var g=f.next[e];g.isLeaf||g.name in c||d.type&&!f.next[e+1].validEnd||(b.push({match:g.contentMatch,type:g,via:d}),c[g.name]=!0)}}};
da.prototype.toString=function(){var a=[];return function K(b){a.push(b);for(var d=1;d<b.next.length;d+=2)-1==a.indexOf(b.next[d])&&K(b.next[d])}(this),a.map(function(b,d){d=d+(b.validEnd?"*":" ")+" ";for(var f=0;f<b.next.length;f+=2)d+=(f?", ":"")+b.next[f].name+"-\x3e"+a.indexOf(b.next[f+1]);return d}).join("\n")};Object.defineProperties(da.prototype,e);da.empty=new da(!0);var Ea=function(a,c){this.string=a;this.nodeTypes=c;this.inline=null;this.pos=0;this.tokens=a.split(/\s*(?=\b|\W|$)/);""==this.tokens[this.tokens.length-
1]&&this.tokens.pop();""==this.tokens[0]&&this.tokens.unshift()};e={next:{}};e.next.get=function(){return this.tokens[this.pos]};Ea.prototype.eat=function(a){return this.next==a&&(this.pos++||!0)};Ea.prototype.err=function(a){throw new SyntaxError(a+" (in content expression '"+this.string+"')");};Object.defineProperties(Ea.prototype,e);var W=function(a,c,b){this.name=a;this.schema=c;this.spec=b;this.groups=b.group?b.group.split(" "):[];this.attrs=F(b.attrs);this.defaultAttrs=O(this.attrs);this.inlineContent=
this.markSet=this.contentMatch=null;this.isBlock=!(b.inline||"text"==a);this.isText="text"==a};e={isInline:{},isTextblock:{},isLeaf:{},isAtom:{}};e.isInline.get=function(){return!this.isBlock};e.isTextblock.get=function(){return this.isBlock&&this.inlineContent};e.isLeaf.get=function(){return this.contentMatch==da.empty};e.isAtom.get=function(){return this.isLeaf||this.spec.atom};W.prototype.hasRequiredAttrs=function(a){for(var c in this.attrs)if(this.attrs[c].isRequired&&!(a&&c in a))return!0;return!1};
W.prototype.compatibleContent=function(a){return this==a||this.contentMatch.compatible(a.contentMatch)};W.prototype.computeAttrs=function(a){return!a&&this.defaultAttrs?this.defaultAttrs:N(this.attrs,a)};W.prototype.create=function(a,c,d){if("string"==typeof c)throw Error("Calling create with string");if(this.isText)throw Error("NodeType.create can't construct text nodes");return new H(this,this.computeAttrs(a),b.from(c),t.setFrom(d))};W.prototype.createChecked=function(a,c,d){if(c=b.from(c),!this.validContent(c))throw new RangeError("Invalid content for node "+
this.name);return new H(this,this.computeAttrs(a),c,t.setFrom(d))};W.prototype.createAndFill=function(a,c,d){if(a=this.computeAttrs(a),(c=b.from(c)).size){var f=this.contentMatch.fillBefore(c);if(!f)return null;c=f.append(c)}return(f=this.contentMatch.matchFragment(c).fillBefore(b.empty,!0))?new H(this,a,c.append(f),t.setFrom(d)):null};W.prototype.validContent=function(a){var c=this.contentMatch.matchFragment(a);if(!c||!c.validEnd)return!1;for(c=0;c<a.childCount;c++)if(!this.allowsMarks(a.child(c).marks))return!1;
return!0};W.prototype.allowsMarkType=function(a){return null==this.markSet||-1<this.markSet.indexOf(a)};W.prototype.allowsMarks=function(a){if(null==this.markSet)return!0;for(var c=0;c<a.length;c++)if(!this.allowsMarkType(a[c].type))return!1;return!0};W.prototype.allowedMarks=function(a){var c;if(null==this.markSet)return a;for(var b=0;b<a.length;b++)this.allowsMarkType(a[b].type)?c&&c.push(a[b]):c||(c=a.slice(0,b));return c?c.length?c:t.empty:a};W.compile=function(a,c){var b=Object.create(null);
a.forEach(function(a,d){return b[a]=new W(a,c,d)});a=c.spec.topNode||"doc";if(!b[a])throw new RangeError("Schema is missing its top node type ('"+a+"')");if(!b.text)throw new RangeError("Every schema needs a 'text' type");for(var d in b.text.attrs)throw new RangeError("The text node type should not have attributes");return b};Object.defineProperties(W.prototype,e);var La=function(a){this.hasDefault=Object.prototype.hasOwnProperty.call(a,"default");this.default=a.default};e={isRequired:{}};e.isRequired.get=
function(){return!this.hasDefault};Object.defineProperties(La.prototype,e);var ra=function(a,c,b,d){this.name=a;this.schema=b;this.spec=d;this.attrs=F(d.attrs);this.rank=c;this.excluded=null;this.instance=(a=O(this.attrs))&&new t(this,a)};ra.prototype.create=function(a){return!a&&this.instance?this.instance:new t(this,N(this.attrs,a))};ra.compile=function(a,c){var b=Object.create(null),d=0;return a.forEach(function(a,f){return b[a]=new ra(a,d++,c,f)}),b};ra.prototype.removeFromSet=function(a){for(var c=
0;c<a.length;c++)if(a[c].type==this)return a.slice(0,c).concat(a.slice(c+1));return a};ra.prototype.isInSet=function(a){for(var c=0;c<a.length;c++)if(a[c].type==this)return a[c]};ra.prototype.excludes=function(a){return-1<this.excluded.indexOf(a)};e=function(a){for(var c in this.spec={},a)this.spec[c]=a[c];for(var b in this.spec.nodes=g.from(a.nodes),this.spec.marks=g.from(a.marks),this.nodes=W.compile(this.spec.nodes,this),this.marks=ra.compile(this.spec.marks,this),this.nodes){if(b in this.marks)throw new RangeError(b+
" can not be both a node and a mark");a=this.nodes[b];c=a.spec.marks;a.contentMatch=da.parse(a.spec.content||"",this.nodes);a.inlineContent=a.contentMatch.inlineContent;a.markSet="_"==c?null:c?l(this,c.split(" ")):""!=c&&a.inlineContent?null:[]}for(var d in this.marks)b=this.marks[d],a=b.spec.excludes,b.excluded=null==a?[b]:""==a?[]:l(this,a.split(" "));this.nodeFromJSON=this.nodeFromJSON.bind(this);this.markFromJSON=this.markFromJSON.bind(this);this.topNodeType=this.nodes[this.spec.topNode||"doc"];
this.cached=Object.create(null);this.cached.wrappings=Object.create(null)};e.prototype.node=function(a,c,b,d){if("string"==typeof a)a=this.nodeType(a);else{if(!(a instanceof W))throw new RangeError("Invalid node type: "+a);if(a.schema!=this)throw new RangeError("Node type from different schema used ("+a.name+")");}return a.createChecked(c,b,d)};e.prototype.text=function(a,c){var b=this.nodes.text;return new Ra(b,b.defaultAttrs,a,t.setFrom(c))};e.prototype.mark=function(a,c){return"string"==typeof a&&
(a=this.marks[a]),a.create(c)};e.prototype.nodeFromJSON=function(a){return H.fromJSON(this,a)};e.prototype.markFromJSON=function(a){return t.fromJSON(this,a)};e.prototype.nodeType=function(a){var c=this.nodes[a];if(!c)throw new RangeError("Unknown node type: "+a);return c};var na=function(a,c){var b=this;this.schema=a;this.rules=c;this.tags=[];this.styles=[];c.forEach(function(a){a.tag?b.tags.push(a):a.style&&b.styles.push(a)})};na.prototype.parse=function(a,c){void 0===c&&(c={});var b=new R(this,
c,!1);return b.addAll(a,null,c.from,c.to),b.finish()};na.prototype.parseSlice=function(a,c){void 0===c&&(c={});var b=new R(this,c,!0);return b.addAll(a,null,c.from,c.to),E.maxOpen(b.finish())};na.prototype.matchTag=function(a,c){for(var b=0;b<this.tags.length;b++){var d=this.tags[b];if((a.matches||a.msMatchesSelector||a.webkitMatchesSelector||a.mozMatchesSelector).call(a,d.tag)&&(void 0===d.namespace||a.namespaceURI==d.namespace)&&(!d.context||c.matchesContext(d.context))){if(d.getAttrs){var f=d.getAttrs(a);
if(!1===f)continue;d.attrs=f}return d}}};na.prototype.matchStyle=function(a,c,b){for(var d=0;d<this.styles.length;d++){var f=this.styles[d];if(!(0!=f.style.indexOf(a)||f.context&&!b.matchesContext(f.context)||f.style.length>a.length&&(61!=f.style.charCodeAt(a.length)||f.style.slice(a.length+1)!=c))){if(f.getAttrs){var e=f.getAttrs(c);if(!1===e)continue;f.attrs=e}return f}}};na.schemaRules=function(a){function c(a){for(var c=null==a.priority?50:a.priority,d=0;d<b.length;d++){var f=b[d];if((null==f.priority?
50:f.priority)<c)break}b.splice(d,0,a)}var b=[],d=function(b){var d=a.marks[b].spec.parseDOM;d&&d.forEach(function(a){c(a=r(a));a.mark=b})},f;for(f in a.marks)d(f);for(var e in a.nodes)d=void 0,(d=a.nodes[e].spec.parseDOM)&&d.forEach(function(a){c(a=r(a));a.node=e});return b};na.fromSchema=function(a){return a.cached.domParser||(a.cached.domParser=new na(a,na.schemaRules(a)))};var xa={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,
form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Sa={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Ta={ol:!0,ul:!0},ya=function(a,c,b,d,f){this.type=a;this.attrs=c;this.solid=b;this.match=d||(4&f?null:a.contentMatch);this.options=f;this.content=[]};ya.prototype.findWrapping=function(a){if(!this.match){if(!this.type)return[];var c=this.type.contentMatch.fillBefore(b.from(a));if(!c){var d;
c=this.type.contentMatch;return(d=c.findWrapping(a.type))?(this.match=c,d):null}this.match=this.type.contentMatch.matchFragment(c)}return this.match.findWrapping(a.type)};ya.prototype.finish=function(a){if(!(this.options&1)){var c,d=this.content[this.content.length-1];d&&d.isText&&(c=/\s+$/.exec(d.text))&&(d.text.length==c[0].length?this.content.pop():this.content[this.content.length-1]=d.withText(d.text.slice(0,d.text.length-c[0].length)))}c=b.from(this.content);return!a&&this.match&&(c=c.append(this.match.fillBefore(b.empty,
!0))),this.type?this.type.create(this.attrs,c):c};var R=function(a,c,b){this.parser=a;this.options=c;this.isOpen=b;var d=c.topNode,f=h(c.preserveWhitespace)|(b?4:0);this.nodes=[d?new ya(d.type,d.attrs,!0,c.topMatch||d.type.contentMatch,f):new ya(b?null:a.schema.topNodeType,null,!0,null,f)];this.marks=t.none;this.open=0;this.find=c.findPositions;this.needsBlock=!1};B={top:{},currentPos:{}};B.top.get=function(){return this.nodes[this.open]};R.prototype.addMark=function(a){var c=this.marks;return this.marks=
a.addToSet(this.marks),c};R.prototype.addDOM=function(a){if(3==a.nodeType)this.addTextNode(a);else if(1==a.nodeType){var c=a.getAttribute("style");c?this.addElementWithStyles(function(a){for(var c,b=/\s*([\w-]+)\s*:\s*([^;]+)/g,d=[];c=b.exec(a);)d.push(c[1],c[2].trim());return d}(c),a):this.addElement(a)}};R.prototype.addTextNode=function(a){var c=a.nodeValue,b=this.top;if((b.type?b.type.inlineContent:b.content.length&&b.content[0].isInline)||/\S/.test(c)){if(b.options&1)b.options&2||(c=c.replace(/\r?\n|\r/g,
" "));else if(c=c.replace(/\s+/g," "),/^\s/.test(c)&&this.open==this.nodes.length-1)b=b.content[b.content.length-1],(!b||b.isText&&/\s$/.test(b.text))&&(c=c.slice(1));c&&this.insertNode(this.parser.schema.text(c,this.marks));this.findInText(a)}else this.findInside(a)};R.prototype.addElement=function(a){var c=a.nodeName.toLowerCase();if(Ta.hasOwnProperty(c))for(var b=a.firstChild,d=null;b;b=b.nextSibling){var f=1==b.nodeType?b.nodeName.toLowerCase():null;f&&Ta.hasOwnProperty(f)&&d?(d.appendChild(b),
b=d):"li"==f?d=b:f&&(d=null)}if((b=this.options.ruleFromNode&&this.options.ruleFromNode(a)||this.parser.matchTag(a,this))?b.ignore:Sa.hasOwnProperty(c))this.findInside(a);else if(!b||b.skip){b&&b.skip.nodeType&&(a=b.skip);var e;b=this.needsBlock;xa.hasOwnProperty(c)&&((e=this.top).type||(this.needsBlock=!0));this.addAll(a);e&&this.sync(e);this.needsBlock=b}else this.addElementByRule(a,b)};R.prototype.addElementWithStyles=function(a,b){for(var c=this.marks,d=!1,f=0;f<a.length;f+=2){var e=this.parser.matchStyle(a[f],
a[f+1],this);if(e){if(e.ignore){d=!0;break}this.addMark(this.parser.schema.marks[e.mark].create(e.attrs))}}d||this.addElement(b);this.marks=c};R.prototype.addElementByRule=function(a,b){var c,d,f,e,g,h=this;(b.node?(f=this.parser.schema.nodes[b.node]).isLeaf?this.insertNode(f.create(b.attrs,null,this.marks)):c=this.enter(f,b.attrs,b.preserveWhitespace)&&this.top:(e=this.parser.schema.marks[b.mark],d=this.addMark(g=e.create(b.attrs))),f&&f.isLeaf)?this.findInside(a):b.getContent?(this.findInside(a),
b.getContent(a).forEach(function(a){return h.insertNode(g?a.mark(g.addToSet(a.marks)):a)})):(b=b.contentElement,"string"==typeof b?b=a.querySelector(b):"function"==typeof b&&(b=b(a)),b||(b=a),this.findAround(a,b,!0),this.addAll(b,c));return c?(this.sync(c),this.open--):d&&(this.marks=d),!0};R.prototype.addAll=function(a,b,d,f){var c=d||0;d=d?a.childNodes[d]:a.firstChild;for(f=null==f?null:a.childNodes[f];d!=f;d=d.nextSibling,++c)this.findAtPoint(a,c),this.addDOM(d),b&&xa.hasOwnProperty(d.nodeName.toLowerCase())&&
this.sync(b);this.findAtPoint(a,c)};R.prototype.findPlace=function(a){for(var b,d,f=this.open;0<=f;f--){var e=this.nodes[f],g=e.findWrapping(a);if(g&&(!b||b.length>g.length)&&(b=g,d=e,!g.length))break;if(e.solid)break}if(!b)return!1;this.sync(d);for(a=0;a<b.length;a++)this.enterInner(b[a],null,!1);return!0};R.prototype.insertNode=function(a){if(a.isInline&&this.needsBlock&&!this.top.type){var b=this.textblockFromContext();b&&this.enter(b)}this.findPlace(a)&&(this.closeExtra(),b=this.top,b.match&&
(b.match=b.match.matchType(a.type),b.type&&(a=a.mark(b.type.allowedMarks(a.marks)))),b.content.push(a))};R.prototype.enter=function(a,b,d){var c=this.findPlace(a.create(b));return c&&this.enterInner(a,b,!0,d),c};R.prototype.enterInner=function(a,b,d,f){this.closeExtra();var c=this.top;c.match=c.match&&c.match.matchType(a,b);f=null==f?-5&c.options:h(f);4&c.options&&0==c.content.length&&(f|=4);this.nodes.push(new ya(a,b,d,null,f));this.open++};R.prototype.closeExtra=function(a){var b=this.nodes.length-
1;if(b>this.open){for(this.marks=t.none;b>this.open;b--)this.nodes[b-1].content.push(this.nodes[b].finish(a));this.nodes.length=this.open+1}};R.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)};R.prototype.sync=function(a){for(var b=this.open;0<=b;b--)if(this.nodes[b]==a)return void(this.open=b)};B.currentPos.get=function(){this.closeExtra();for(var a=0,b=this.open;0<=b;b--){for(var d=this.nodes[b].content,f=d.length-
1;0<=f;f--)a+=d[f].nodeSize;b&&a++}return a};R.prototype.findAtPoint=function(a,b){if(this.find)for(var c=0;c<this.find.length;c++)this.find[c].node==a&&this.find[c].offset==b&&(this.find[c].pos=this.currentPos)};R.prototype.findInside=function(a){if(this.find)for(var b=0;b<this.find.length;b++)null==this.find[b].pos&&1==a.nodeType&&a.contains(this.find[b].node)&&(this.find[b].pos=this.currentPos)};R.prototype.findAround=function(a,b,d){if(a!=b&&this.find)for(var c=0;c<this.find.length;c++)null==
this.find[c].pos&&1==a.nodeType&&a.contains(this.find[c].node)&&b.compareDocumentPosition(this.find[c].node)&(d?2:4)&&(this.find[c].pos=this.currentPos)};R.prototype.findInText=function(a){if(this.find)for(var b=0;b<this.find.length;b++)this.find[b].node==a&&(this.find[b].pos=this.currentPos-(a.nodeValue.length-this.find[b].offset))};R.prototype.matchesContext=function(a){var b=this;if(-1<a.indexOf("|"))return a.split(/\s*\|\s*/).some(this.matchesContext,this);var d=a.split("/"),f=this.options.context,
e=!(this.isOpen||f&&f.parent.type!=this.nodes[0].type),g=-(f?f.depth+1:0)+(e?0:1),h=function(a,c){for(;0<=a;a--){var n=d[a];if(""==n){if(a==d.length-1||0==a)continue;for(;c>=g;c--)if(h(a-1,c))return!0;return!1}var l=0<c||0==c&&e?b.nodes[c].type:f&&c>=g?f.node(c-g).type:null;if(!l||l.name!=n&&-1==l.groups.indexOf(n))return!1;c--}return!0};return h(d.length-1,this.open)};R.prototype.textblockFromContext=function(){var a=this.options.context;if(a)for(var b=a.depth;0<=b;b--){var d=a.node(b).defaultContentType(a.indexAfter(b));
if(d&&d.isTextblock&&d.defaultAttrs)return d}for(var f in this.parser.schema.nodes)if(a=this.parser.schema.nodes[f],a.isTextblock&&a.defaultAttrs)return a};Object.defineProperties(R.prototype,B);var fa=function(a,b){this.nodes=a||{};this.marks=b||{}};fa.prototype.serializeFragment=function(a,b,d){var c=this;void 0===b&&(b={});d||(d=(b.document||window.document).createDocumentFragment());var f=d,e=null;return a.forEach(function(a){if(e||a.marks.length){e||(e=[]);for(var d=0;d<Math.min(e.length,a.marks.length)&&
a.marks[d].eq(e[d]);++d);for(;d<e.length;){var g=e.pop();c.marks[g.type.name]&&(f=f.parentNode)}for(;e.length<a.marks.length;)d=a.marks[e.length],e.push(d),(d=c.serializeMark(d,a.isInline,b))&&(f=f.appendChild(d))}f.appendChild(c.serializeNode(a,b))}),d};fa.prototype.serializeNode=function(a,b){return void 0===b&&(b={}),this.renderStructure(this.nodes[a.type.name](a),a,b)};fa.prototype.serializeNodeAndMarks=function(a,b){void 0===b&&(b={});for(var c=this.serializeNode(a,b),d=a.marks.length-1;0<=d;d--){var f=
this.serializeMark(a.marks[d],a.isInline,b);f&&(f.appendChild(c),c=f)}return c};fa.prototype.serializeMark=function(a,b,d){void 0===d&&(d={});var c=this.marks[a.type.name];return c&&this.renderStructure(c(a,b),null,d)};fa.renderSpec=function(a,b){if("string"==typeof b)return{dom:a.createTextNode(b)};if(null!=b.nodeType)return{dom:b};var c=a.createElement(b[0]),d=null,f=b[1],e=1;if(f&&"object"==typeof f&&null==f.nodeType&&!Array.isArray(f))for(var g in e=2,f)"style"==g?c.style.cssText=f[g]:null!=f[g]&&
c.setAttribute(g,f[g]);for(f=e;f<b.length;f++){g=b[f];if(0===g){if(f<b.length-1||f>e)throw new RangeError("Content hole must be the only child of its parent node");return{dom:c,contentDOM:c}}g=fa.renderSpec(a,g);var h=g.contentDOM;if(c.appendChild(g.dom),h){if(d)throw new RangeError("Multiple content holes");d=h}}return{dom:c,contentDOM:d}};fa.prototype.renderStructure=function(a,b,d){var c=fa.renderSpec(d.document||window.document,a);a=c.dom;if(c=c.contentDOM){if(!b||b.isLeaf)throw new RangeError("Content hole not allowed in a mark or leaf node spec");
d.onContent?d.onContent(b,c,d):this.serializeFragment(b.content,d,c)}return a};fa.fromSchema=function(a){return a.cached.domSerializer||(a.cached.domSerializer=new fa(this.nodesFromSchema(a),this.marksFromSchema(a)))};fa.nodesFromSchema=function(a){a=u(a.nodes);return a.text||(a.text=function(a){return a.text}),a};fa.marksFromSchema=function(a){return u(a.marks)};p.Node=H;p.ResolvedPos=I;p.NodeRange=Ia;p.Fragment=b;p.Slice=E;p.ReplaceError=G;p.Mark=t;p.Schema=e;p.NodeType=W;p.MarkType=ra;p.ContentMatch=
da;p.DOMParser=na;p.DOMSerializer=fa},463:function(e,p,B){function M(a,b,c,d,f){for(;;){if(a==c&&b==d)return!0;if(b==(0>f?0:3==a.nodeType?a.nodeValue.length:a.childNodes.length)){var k=a.parentNode;if(1!=k.nodeType||(e=void 0,(e=a.pmViewDesc)&&e.node&&e.node.isBlock)||hb.test(a.nodeName))return!1;b=bb(a)+(0>f?0:1);a=k}else{if(1!=a.nodeType)return!1;a=a.childNodes[b+(0>f?-1:0)];b=0>f?3==a.nodeType?a.nodeValue.length:a.childNodes.length:0}}var e}function T(a,b){var c=a.someProp("scrollThreshold")||
0,d=a.someProp("scrollMargin"),f=a.dom.ownerDocument,k=f.defaultView;null==d&&(d=5);for(a=a.dom;a;a=cb(a)){var e=a==f.body,g=e?{left:0,right:k.innerWidth,top:0,bottom:k.innerHeight}:a.getBoundingClientRect(),h=0,L=0;if(b.top<g.top+c?L=-(g.top-b.top+d):b.bottom>g.bottom-c&&(L=b.bottom-g.bottom+d),b.left<g.left+c?h=-(g.left-b.left+d):b.right>g.right-c&&(h=b.right-g.right+d),(h||L)&&(e?k.scrollBy(h,L):(L&&(a.scrollTop+=L),h&&(a.scrollLeft+=h))),e)break}}function G(a,b){for(var c,d,f=2E8,k=0,e=b.top,
g=b.top,h=a.firstChild,L=0;h;h=h.nextSibling,L++){if(1==h.nodeType)var n=h.getClientRects();else{if(3!=h.nodeType)continue;n=Wa(h).getClientRects()}for(var l=0;l<n.length;l++){var t=n[l];if(t.top<=e&&t.bottom>=g){e=Math.max(t.bottom,e);g=Math.min(t.top,g);var p=t.left>b.left?t.left-b.left:t.right<b.left?b.left-t.right:0;if(p<f){c=h;d=(f=p)&&3==c.nodeType?{left:t.right<b.left?t.right:t.left,top:b.top}:b;1==h.nodeType&&p&&(k=L+(b.left>=(t.left+t.right)/2?1:0));continue}}!c&&(b.left>=t.right&&b.top>=
t.top||b.left>=t.left&&b.top>=t.bottom)&&(k=L+1)}}if(c&&3==c.nodeType)a:{a=c;b=a.nodeValue.length;c=document.createRange();for(f=0;f<b;f++)if(c.setEnd(a,f+1),c.setStart(a,f),k=aa(c,1),k.top!=k.bottom&&k.left-1<=d.left&&k.right+1>=d.left&&k.top-1<=d.top&&k.bottom+1>=d.top){d={node:a,offset:f+(d.left>=(k.left+k.right)/2?1:0)};break a}d={node:a,offset:0}}else d=!c||f&&1==c.nodeType?{node:a,offset:k}:G(c,d);return d}function U(a,b){var c=a.root;if(c.caretPositionFromPoint){var d=c.caretPositionFromPoint(b.left,
b.top);if(d){var f=d.offsetNode;var k=d.offset}}!f&&c.caretRangeFromPoint&&(d=c.caretRangeFromPoint(b.left,b.top))&&(f=d.startContainer,k=d.startOffset);var e;c=c.elementFromPoint(b.left,b.top+1);if(!c||(c=function(a,b){var c=a.parentNode;return c&&/^li$/i.test(c.nodeName)&&b.left<a.getBoundingClientRect().left?c:a}(c,b),f&&(f==a.dom&&k==f.childNodes.length-1&&1==f.lastChild.nodeType&&b.top>f.lastChild.getBoundingClientRect().bottom?e=a.state.doc.content.size:0!=k&&1==f.nodeType&&"BR"==f.childNodes[k-
1].nodeName||(e=function(a,b,c,d){for(var f=-1,k=b;k!=a.dom;){k=a.docView.nearestDesc(k,!0);if(!k)return null;if(k.node.isBlock&&k.parent){var e=k.dom.getBoundingClientRect();if(e.left>d.left||e.top>d.top)f=k.posBefore;else{if(!(e.right<d.left||e.bottom<d.top))break;f=k.posAfter}}k=k.dom.parentNode}return-1<f?f:a.docView.posFromDOM(b,c)}(a,f,k,b))),null==e&&null==(e=function(a,b,c){if(!a.dom.contains(1!=b.nodeType?b.parentNode:b))return null;var d=G(b,c);b=d.node;d=d.offset;var f=-1;1!=b.nodeType||
b.firstChild||(f=b.getBoundingClientRect(),f=f.left!=f.right&&c.left>(f.left+f.right)/2?1:-1);return a.docView.posFromDOM(b,d,f)}(a,c,b))))return null;a=a.docView.nearestDesc(c,!0);return{pos:e,inside:a?a.posAtStart-a.border:-1}}function aa(a,b){var c=a.getClientRects();return c.length?c[0>b?0:c.length-1]:a.getBoundingClientRect()}function ba(a,b){var c,d;b=a.docView.domFromPos(b);a=b.node;b=b.offset;3==a.nodeType?(b<a.nodeValue.length&&(d=aa(Wa(a,b,b+1),-1),c="left"),d&&d.left!=d.right||!b||(d=aa(Wa(a,
b-1,b),1),c="right")):a.firstChild?(b<a.childNodes.length&&(d=a.childNodes[b],d=aa(3==d.nodeType?Wa(d):d,-1),c="left"),d&&d.top!=d.bottom||!b||(d=a.childNodes[b-1],d=aa(3==d.nodeType?Wa(d):d,1),c="right")):(d=a.getBoundingClientRect(),c="left");c=d[c];return{top:d.top,bottom:d.bottom,left:c,right:c}}function z(a,b,c){var d=a.state,f=a.root.activeElement;d==b&&a.inDOMChange||a.updateState(b);f!=a.dom&&a.focus();try{return c()}finally{d!=b&&a.updateState(d),f!=a.dom&&f.focus()}}function Y(a,b,c){return Cb==
b&&Hb==c?tb:(Cb=b,Hb=c,tb="up"==c||"down"==c?function(a,b,c){var d=b.selection,f="up"==c?d.$anchor.min(d.$head):d.$anchor.max(d.$head);return!!f.depth&&z(a,b,function(){var b=a.docView.domAfterPos(f.before()),d=ba(a,f.pos);for(b=b.firstChild;b;b=b.nextSibling){if(1==b.nodeType)var k=b.getClientRects();else{if(3!=b.nodeType)continue;k=Wa(b,0,b.nodeValue.length).getClientRects()}for(var e=0;e<k.length;e++){var g=k[e];if(g.bottom>g.top&&("up"==c?g.bottom<d.top+1:g.top>d.bottom-1))return!1}}return!0})}(a,
b,c):function(a,b,c){var d=b.selection.$head;if(!d.parent.isTextblock||!d.depth)return!1;var f=d.parentOffset,k=!f;f=f==d.parent.content.size;var e=getSelection();return kb.test(d.parent.textContent)&&e.modify?z(a,b,function(){var b=e.getRangeAt(0),f=e.focusNode,k=e.focusOffset;e.modify("move",c,"character");f=!a.docView.domAfterPos(d.before()).contains(1==e.focusNode.nodeType?e.focusNode:e.focusNode.parentNode)||f==e.focusNode&&k==e.focusOffset;return e.removeAllRanges(),e.addRange(b),f}):"left"==
c||"backward"==c?k:f}(a,b,c))}function P(a,b,c,d,f){return v(d,d,Ma,q(b,a,1!=d.nodeType)),new Na(null,a,b,c,d,d,d,f)}function x(a){a&&(this.nodeName=a)}function q(a,b,c){if(0==a.length)return Ma;for(var d=c?Ma[0]:new x,f=[d],e=0;e<a.length;e++){var k=a[e].type.attrs,g=d;if(k)for(var w in k.nodeName&&f.push(g=new x(k.nodeName)),k){var h=k[w];null!=h&&(c&&1==f.length&&f.push(g=d=new x(b.isInline?"span":"div")),"class"==w?g.class=(g.class?g.class+" ":"")+h:"style"==w?g.style=(g.style?g.style+";":"")+
h:"nodeName"!=w&&(g[w]=h))}}return f}function v(a,b,c,d){if(c==Ma&&d==Ma)return b;for(var f=b,e=0;e<d.length;e++){var k=d[e],g=c[e];if(e){var w=void 0;g&&g.nodeName==k.nodeName&&f!=a&&(w=b.parentNode)&&w.tagName.toLowerCase()==k.nodeName?f=w:((w=document.createElement(k.nodeName)).appendChild(f),f=w)}var h,J=h=void 0;w=f;g=g||Ma[0];for(J in g)"class"==J||"style"==J||"nodeName"==J||J in k||w.removeAttribute(J);for(h in k)"class"!=h&&"style"!=h&&"nodeName"!=h&&k[h]!=g[h]&&w.setAttribute(h,k[h]);if(g.class!=
k.class){h=g.class?g.class.split(" "):Za;J=k.class?k.class.split(" "):Za;for(var L=0;L<h.length;L++)-1==J.indexOf(h[L])&&w.classList.remove(h[L]);for(L=0;L<J.length;L++)-1==h.indexOf(J[L])&&w.classList.add(J[L])}if(g.style!=k.style){if(g.style)for(J=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;h=J.exec(g.style);)w.style[h[1].toLowerCase()]="";k.style&&(w.style.cssText+=k.style)}}return f}function Q(a,b){if(a.length!=b.length)return!1;for(var c=0;c<a.length;c++)if(!a[c].type.eq(b[c].type))return!1;
return!0}function A(a){var b=a.nextSibling;return a.parentNode.removeChild(a),b}function C(a){return Ib==a._props?Fb:(Ib=a._props,Fb=function(a){var b={};return a.someProp("nodeViews",function(a){for(var c in a)Object.prototype.hasOwnProperty.call(b,c)||(b[c]=a[c])}),b}(a))}function ja(a,b){var c=a.selection,d=c.$anchor;c=c.$head;d=0<b?d.max(c):d.min(c);return(a=d.parent.inlineContent?d.depth?a.doc.resolve(0<b?d.after():d.before()):null:d)&&ea.Selection.findFrom(a,b)}function y(a,b){return a.dispatch(a.state.tr.setSelection(b).scrollIntoView()),
!0}function Z(a,b){var c=a.state.selection;if(c instanceof ea.TextSelection){if(c.empty){if(a.endOfTextblock(0<b?"right":"left"))return b=ja(a.state,b),!!(b&&b instanceof ea.NodeSelection)&&y(a,b);var d;c=c.$head;var f=c.textOffset?null:0>b?c.nodeBefore:c.nodeAfter;return!!(f&&ea.NodeSelection.isSelectable(f)&&(f.isAtom||(d=a.docView.descAt(c.pos))&&!d.contentDOM))&&y(a,new ea.NodeSelection(0>b?a.state.doc.resolve(c.pos-f.nodeSize):c))}return!1}if(c instanceof ea.NodeSelection&&c.node.isInline)return y(a,
new ea.TextSelection(0<b?c.$to:c.$from));b=ja(a.state,b);return!!b&&y(a,b)}function O(a){return 3==a.nodeType?a.nodeValue.length:a.childNodes.length}function N(a){var b=a.pmViewDesc;return b&&0==b.size&&(a.nextSibling||"BR"!=a.nodeName)}function F(a){for(var b,c,d=a.root.getSelection(),f=d.anchorNode,e=d.anchorOffset;;)if(0<e)if(1!=f.nodeType){if(3!=f.nodeType||"\ufeff"!=f.nodeValue.charAt(e-1))break;b=f;c=--e}else{var g=f.childNodes[e-1];if(N(g))b=f,c=--e;else{if(3!=g.nodeType)break;e=(f=g).nodeValue.length}}else{if(h(f))break;
for(e=f.previousSibling;e&&N(e);)b=f.parentNode,c=bb(e),e=e.previousSibling;if(e)e=O(f=e);else{if((f=f.parentNode)==a.dom)break;e=0}}b&&r(d,b,c)}function l(a){for(var b,c,d=a.root.getSelection(),f=d.anchorNode,e=d.anchorOffset,g=O(f);;)if(e<g){if(1!=f.nodeType)break;if(!N(f.childNodes[e]))break;b=f;c=++e}else{if(h(f))break;for(g=f.nextSibling;g&&N(g);)b=g.parentNode,c=bb(g)+1,g=g.nextSibling;if(g)e=0,g=O(f=g);else{if((f=f.parentNode)==a.dom)break;e=g=0}}b&&r(d,b,c)}function h(a){return(a=a.pmViewDesc)&&
a.node&&a.node.isBlock}function r(a,b,c){var d=document.createRange();d.setEnd(b,c);d.setStart(b,c);a.removeAllRanges();a.addRange(d)}function u(a,b){var c=a.state.selection;if(c instanceof ea.TextSelection&&!c.empty)return!1;var d=c.$from;c=c.$to;if(!d.parent.inlineContent||a.endOfTextblock(0>b?"up":"down")){var f=ja(a.state,b);if(f&&f instanceof ea.NodeSelection)return y(a,f)}return d.parent.inlineContent?!1:(b=ea.Selection.findFrom(0>b?d:c,b),!b||y(a,b))}function d(a,b){if(!(a.state.selection instanceof
ea.TextSelection))return!0;var c=a.state.selection,d=c.$head,f=c.empty;return d.sameParent(c.$anchor)?f?a.endOfTextblock(0<b?"forward":"backward")?!0:(c=!d.textOffset&&(0>b?d.nodeBefore:d.nodeAfter))&&!c.isText?(f=a.state.tr,0>b?f.delete(d.pos-c.nodeSize,d.pos):f.delete(d.pos,d.pos+c.nodeSize),a.dispatch(f),!0):!1:!1:!0}function g(a,c){var d=a.state.selection;if(function(a,b){b instanceof ea.NodeSelection?(b=a.docView.descAt(b.from),b!=a.lastSelectedViewDesc&&(a.lastSelectedViewDesc&&(a.lastSelectedViewDesc.deselectNode(),
a.lastSelectedViewDesc=null),b&&b.selectNode(),a.lastSelectedViewDesc=b)):a.lastSelectedViewDesc&&(a.lastSelectedViewDesc.deselectNode(),a.lastSelectedViewDesc=null)}(a,d),!a.hasFocus()){if(!c)return;X.gecko&&a.editable&&(a.selectionReader.ignoreUpdates=!0,a.dom.focus(),a.selectionReader.ignoreUpdates=!1)}c=a.selectionReader;if(!c.lastSelection||!c.lastSelection.eq(d)||c.domChanged()){if(c.ignoreUpdates=!0,a.cursorWrapper)!function(a){var b=a.root.getSelection(),c=document.createRange(),d=a.cursorWrapper.type.widget;
c.setEnd(d,d.childNodes.length);c.collapse(!1);b.removeAllRanges();b.addRange(c);!a.state.selection.visible&&X.ie&&11>=X.ie_version&&(d.disabled=!0,d.disabled=!1)}(a);else{var f,e,k=d.anchor,g=d.head;!X.webkit||d instanceof ea.TextSelection||(d.$from.parent.inlineContent||(f=b(a,d.from)),d.empty||d.$from.parent.inlineContent||(e=b(a,d.to)));a.docView.setSelection(k,g,a.root);X.webkit&&(f&&(f.contentEditable="false"),e&&(e.contentEditable="false"));d.visible?a.dom.classList.remove("ProseMirror-hideselection"):
k!=g&&(a.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(a){var b=a.dom.ownerDocument;b.removeEventListener("selectionchange",a.hideSelectionGuard);var c=a.root.getSelection(),d=c.anchorNode,f=c.anchorOffset;b.addEventListener("selectionchange",a.hideSelectionGuard=function(){c.anchorNode==d&&c.anchorOffset==f||(b.removeEventListener("selectionchange",a.hideSelectionGuard),a.dom.classList.remove("ProseMirror-hideselection"))})}(a))}c.storeDOMState(d);c.ignoreUpdates=
!1}}function b(a,b){b=a.docView.domFromPos(b);a=b.node;var c=b.offset;b=c<a.childNodes.length?a.childNodes[c]:null;a=c?a.childNodes[c-1]:null;if(!(b&&"false"!=b.contentEditable||a&&"false"!=a.contentEditable)){if(b)return b.contentEditable="true",b;if(a)return a.contentEditable="true",a}}function f(a,b,c,d){return a.someProp("createSelectionBetween",function(d){return d(a,b,c)})||ea.TextSelection.between(b,c,d)}function t(a){if(a.editable&&a.root.activeElement!=a.dom)return!1;var b=a.root.getSelection();
if(!b.anchorNode)return!1;try{return a.dom.contains(3==b.anchorNode.nodeType?b.anchorNode.parentNode:b.anchorNode)}catch(w){return!1}}function E(a,b){return function(c){var d=c.pmViewDesc;if(d)return d.parseRule();if("BR"==c.nodeName&&c.parentNode){if(X.safari&&/^(ul|ol)$/i.test(c.parentNode.nodeName))return a.matchTag(document.createElement("li"),b);if(c.parentNode.lastChild==c)return{ignore:!0}}}}function I(a,b){var c=document.createEvent("Event");return c.initEvent("keydown",!0,!0),c.keyCode=a,
c.key=c.code=b,c}function ka(a,b,c,d){return Math.max(d.anchor,d.head)>b.content.size?null:f(a,b.resolve(c.map(d.anchor)),b.resolve(c.map(d.head)))}function la(a,b,c){for(var d=a.depth,f=b?a.end():a.pos;0<d&&(b||a.indexAfter(d)==a.node(d).childCount);)d--,f++,b=!1;if(c)for(a=a.node(d).maybeChild(a.indexAfter(d));a&&!a.isLeaf;)a=a.firstChild,f++;return f}function Ua(a,b){for(var c=[],d=b.content,f=b.openStart,e=b.openEnd;1<f&&1<e&&1==d.childCount&&1==d.firstChild.childCount;)f--,e--,d=d.firstChild,
c.push(d.type.name,d.type.hasRequiredAttrs()?d.attrs:null),d=d.content;e=a.someProp("clipboardSerializer")||ma.DOMSerializer.fromSchema(a.state.schema);f=document.createElement("div");f.appendChild(e.serializeFragment(d));var k;for(d=f.firstChild;d&&1==d.nodeType&&(k=Ya[d.nodeName.toLowerCase()]);){for(d=k.length-1;0<=d;d--){for(e=document.createElement(k[d]);f.firstChild;)e.appendChild(f.firstChild);f.appendChild(e)}d=f.firstChild}d&&1==d.nodeType&&d.setAttribute("data-pm-context",0!=b.openStart||
0!=b.openEnd||1!=b.content.childCount||b.content.firstChild.isText?JSON.stringify(c):"none");return{dom:f,text:a.someProp("clipboardTextSerializer",function(a){return a(b)})||b.content.textBetween(0,b.content.size,"\n\n")}}function Ia(a,b,c,d,f){var e,k,g=f.parent.type.spec.code;if(!c&&!b)return null;if((d||g||!c)&&b){if(a.someProp("transformPastedText",function(a){b=a(b)}),g)return new ma.Slice(ma.Fragment.from(a.state.schema.text(b)),0,0);(d=a.someProp("clipboardTextParser",function(a){return a(b,
f)}))?k=d:(e=document.createElement("div"),b.trim().split(/(?:\r\n?|\n)+/).forEach(function(a){e.appendChild(document.createElement("p")).textContent=a}))}else a.someProp("transformPastedHTML",function(a){return c=a(c)}),e=function(a){var b=/(\s*<meta [^>]*>)*/.exec(a);b&&(a=a.slice(b[0].length));var c;b=(nb||(nb=document.implementation.createHTMLDocument("title"))).createElement("div");var d=/(?:<meta [^>]*>)*<([a-z][^>\s]+)/i.exec(a),f=0;(c=d&&Ya[d[1].toLowerCase()])&&(a=c.map(function(a){return"\x3c"+
a+"\x3e"}).join("")+a+c.map(function(a){return"\x3c/"+a+"\x3e"}).reverse().join(""),f=c.length);b.innerHTML=a;for(a=0;a<f;a++)b=b.firstChild;return b}(c);k||(k=(a.someProp("clipboardParser")||a.someProp("domParser")||ma.DOMParser.fromSchema(a.state.schema)).parseSlice(e,{preserveWhitespace:!0,context:f}));k=function(a){for(var b=0,c=a.content,d=1;d<=a.openStart;d++){c=c.firstChild;if(c.type.spec.isolating){b=d;break}c=c.content}return 0==b?a:new ma.Slice(function Lb(a,b,c){if(0==b)return a;var d=
a.firstChild;b=Lb(d.content,b-1,c-1);c=d.contentMatchAt(0).fillBefore(d.content,0>=c);return a.replaceChild(0,d.copy(c.append(b)))}(a.content,b,a.openEnd),a.openStart-b,a.openEnd)}(k);d=(d=e&&e.querySelector("[data-pm-context]"))&&d.getAttribute("data-pm-context");return k="none"==d?new ma.Slice(k.content,0,0):d?function(a,b){if(!a.size)return a;var c=a.content.firstChild.type.schema;try{var d=JSON.parse(b)}catch(Qb){return a}b=a.content;var f=a.openStart;a=a.openEnd;for(var e=d.length-2;0<=e;e-=
2){var k=c.nodes[d[e]];if(!k||k.hasRequiredAttrs())break;b=ma.Fragment.from(k.create(d[e+1],b));f++;a++}return new ma.Slice(b,f,a)}(k,d):function(a,b){if(2>a.content.childCount)return a;for(var c=function(c){var d=b.node(c).contentMatchAt(b.index(c)),f=void 0,e=[];if(a.content.forEach(function(a){if(e){var b,c=d.findWrapping(a.type);if(!c)return e=null;(b=e.length&&f.length&&function Ob(a,b,c,d,f){if(f<a.length&&f<b.length&&a[f]==b[f]){if(b=Ob(a,b,c,d.lastChild,f+1))return d.copy(d.content.replaceChild(d.childCount-
1,b));if(d.contentMatchAt(d.childCount).matchType(f==a.length-1?c.type:a[f+1]))return d.copy(d.content.append(ma.Fragment.from(gb(c,a,f+1))))}}(c,f,a,e[e.length-1],0))?e[e.length-1]=b:(e.length&&(e[e.length-1]=function Mb(a,b){if(0==b)return a;b=a.content.replaceChild(a.childCount-1,Mb(a.lastChild,b-1));var c=a.contentMatchAt(a.childCount).fillBefore(ma.Fragment.empty,!0);return a.copy(b.append(c))}(e[e.length-1],f.length)),a=gb(a,c),e.push(a),d=d.matchType(a.type,a.attrs),f=c)}}),e)return{v:ma.Slice.maxOpen(ma.Fragment.from(e))}},
d=b.depth;0<=d;d--){var f=c(d);if(f)return f.v}return a}(k,f),a.someProp("transformPasted",function(a){k=a(k)}),k}function gb(a,b,c){void 0===c&&(c=0);for(var d=b.length-1;d>=c;d--)a=b[d].create(null,ma.Fragment.from(a));return a}function H(a){a.someProp("handleDOMEvents",function(b){for(var c in b)a.eventHandlers[c]||a.dom.addEventListener(c,a.eventHandlers[c]=function(b){return Ra(a,b)})})}function Ra(a,b){return a.someProp("handleDOMEvents",function(c){c=c[b.type];return!!c&&(c(a,b)||b.defaultPrevented)})}
function da(a,b){var c=b.x-a.clientX;a=b.y-a.clientY;return 100>c*c+a*a}function Ea(a,b,c,d,f){if(-1==d)return!1;var e=a.state.doc.resolve(d);d=function(d){if(a.someProp(b,function(b){return d>e.depth?b(a,c,e.nodeAfter,e.before(d),f,!0):b(a,c,e.node(d),e.before(d),f,!1)}))return{v:!0}};for(var k=e.depth+1;0<k;k--){var g=d(k);if(g)return g.v}return!1}function W(a,b,c){a.focused||a.focus();b=a.state.tr.setSelection(b);"pointer"==c&&b.setMeta("pointer",!0);a.dispatch(b)}function La(a,b,c,d,f){return Ea(a,
"handleClickOn",b,c,d)||a.someProp("handleClick",function(c){return c(a,b,d)})||(f?function(a,b){if(-1==b)return!1;var c,d=a.state.selection;d instanceof ea.NodeSelection&&(c=d.node);b=a.state.doc.resolve(b);for(var f=b.depth+1;0<f;f--){var e=f>b.depth?b.nodeAfter:b.node(f);if(ea.NodeSelection.isSelectable(e)){var k=c&&0<d.$from.depth&&f>=d.$from.depth&&b.before(d.$from.depth+1)==d.$from.pos?b.before(d.$from.depth):b.before(f);break}}return null!=k&&(W(a,ea.NodeSelection.create(a.state.doc,k),"pointer"),
!0)}(a,c):function(a,b){if(-1==b)return!1;b=a.state.doc.resolve(b);var c=b.nodeAfter;return!!(c&&c.isAtom&&ea.NodeSelection.isSelectable(c))&&(W(a,new ea.NodeSelection(b),"pointer"),!0)}(a,c))}function ra(a,b,c,d){return Ea(a,"handleTripleClickOn",b,c,d)||a.someProp("handleTripleClick",function(c){return c(a,b,d)})||function(a,b){var c=a.state.doc;if(-1==b)return!!c.inlineContent&&(W(a,ea.TextSelection.create(c,0,c.content.size),"pointer"),!0);b=c.resolve(b);for(var d=b.depth+1;0<d;d--){var f=d>b.depth?
b.nodeAfter:b.node(d),e=b.before(d);if(f.inlineContent)W(a,ea.TextSelection.create(c,e+1,e+1+f.content.size),"pointer");else{if(!ea.NodeSelection.isSelectable(f))continue;W(a,ea.NodeSelection.create(c,e),"pointer")}return!0}}(a,c)}function na(a){return!!a.inDOMChange&&(a.inDOMChange.finish(!0),!0)}function xa(a,b,c,d){var f=Ia(a,b,c,a.shiftKey,a.state.selection.$from);if(!f)return!1;if(a.someProp("handlePaste",function(b){return b(a,d,f)}))return!0;b=(b=0==f.openStart&&0==f.openEnd&&1==f.content.childCount?
f.content.firstChild:null)?a.state.tr.replaceSelectionWith(b,a.shiftKey):a.state.tr.replaceSelection(f);return a.dispatch(b.scrollIntoView().setMeta("paste",!0)),!0}function Sa(a,b){if(a==b)return!0;for(var c in a)if(a[c]!==b[c])return!1;for(var d in b)if(!(d in a))return!1;return!0}function Ta(a,b){if(!b||!a.length)return a;for(var c=[],d=0;d<a.length;d++){var f=a[d];c.push(new va(f.from+b,f.to+b,f.type))}return c}function ya(a,b,c){if(b.isLeaf)return null;b=c+b.nodeSize;for(var d=null,f=0,e=void 0;f<
a.length;f++)(e=a[f])&&e.from>c&&e.to<b&&((d||(d=[])).push(e),a[f]=null);return d}function R(a){for(var b=[],c=0;c<a.length;c++)null!=a[c]&&b.push(a[c]);return b}function fa(b,c,d,f){var e=[],k=!1;c.forEach(function(a,c){var g=ya(b,a,c+d);g&&(k=!0,g=fa(g,a,d+c+1,f),g!=ha&&e.push(c,c+a.nodeSize,g))});for(var g=Ta(k?R(b):b,-d).sort(a),h=0;h<g.length;h++)g[h].type.valid(c,g[h])||(f.onRemove&&f.onRemove(g[h].spec),g.splice(h--,1));return g.length||e.length?new ia(g,e):ha}function a(a,b){return a.from-
b.from||a.to-b.to}function c(a){for(var b=a,c=0;c<b.length-1;c++){var d=b[c];if(d.from!=d.to)for(var f=c+1;f<b.length;f++){var e=b[f];if(e.from!=d.from){e.from<d.to&&(b==a&&(b=a.slice()),b[c]=d.copy(d.from,e.from),n(b,f,d.copy(e.from,d.to)));break}e.to!=d.to&&(b==a&&(b=a.slice()),b[f]=e.copy(e.from,d.to),n(b,f+1,e.copy(d.to,e.to)))}}return b}function n(b,c,d){for(;c<b.length&&0<a(d,b[c]);)c++;b.splice(c,0,d)}function K(a){var b=[];return a.someProp("decorations",function(c){(c=c(a.state))&&c!=ha&&
b.push(c)}),a.cursorWrapper&&b.push(ia.create(a.state.doc,[a.cursorWrapper])),Pa.from(b)}function Ha(a){var b=Object.create(null);return b.class="ProseMirror"+(a.focused?" ProseMirror-focused":""),b.contenteditable=String(a.editable),a.someProp("attributes",function(c){if("function"==typeof c&&(c=c(a.state)),c)for(var d in c)"class"==d?b.class+=" "+c[d]:b[d]||"contenteditable"==d||"nodeName"==d||(b[d]=String(c[d]))}),[va.node(0,a.state.doc.content.size,b)]}function ab(a){return!1===a.type.spec.inclusive}
function Ba(a){var b=a.state.selection,c=b.$head,d=b.visible;if((b=c.pos!=b.$anchor.pos||d&&!c.parent.inlineContent?null:c)&&(!d||a.state.storedMarks||0==b.parent.content.length||b.parentOffset&&!b.textOffset&&b.nodeBefore.marks.some(ab))){c=a.state.storedMarks||b.marks();var f={isCursorWrapper:!0,marks:c,raw:!0,visible:d};a.cursorWrapper&&ma.Mark.sameSet(a.cursorWrapper.spec.marks,c)&&"\ufeff"==a.cursorWrapper.type.widget.textContent&&a.cursorWrapper.spec.visible==d?a.cursorWrapper.pos!=b.pos&&(a.cursorWrapper=
va.widget(b.pos,a.cursorWrapper.type.widget,f)):a.cursorWrapper=va.widget(b.pos,function(a){var b=document.createElement("span");return b.textContent="\ufeff",a||(b.style.position="absolute",b.style.left="-100000px"),b}(d),f)}else a.cursorWrapper=null}function Ja(a){return!a.someProp("editable",function(b){return!1===b(a.state)})}Object.defineProperty(p,"__esModule",{value:!0});var ma=B(38),ea=B(30),qa=B(119),X={};if("undefined"!=typeof navigator){var ca=/Edge\/(\d+)/.exec(navigator.userAgent),vb=
/MSIE \d/.test(navigator.userAgent),V=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);X.mac=/Mac/.test(navigator.platform);var lb=X.ie=!!(vb||V||ca);X.ie_version=vb?document.documentMode||6:V?+V[1]:ca?+ca[1]:null;X.gecko=!lb&&/gecko\/\d/i.test(navigator.userAgent);X.chrome=!lb&&/Chrome\//.test(navigator.userAgent);X.ios=!lb&&/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent);X.webkit=!lb&&"WebkitAppearance"in document.documentElement.style;X.safari=
/Apple Computer/.test(navigator.vendor)}var bb=function(a){for(var b=0;;b++)if(!(a=a.previousSibling))return b},cb=function(a){return(a=a.parentNode)&&11==a.nodeType?a.host:a},Wa=function(a,b,c){var d=document.createRange();return d.setEnd(a,null==c?a.nodeValue.length:c),d.setStart(a,b||0),d},wb=function(a,b,c,d){return c&&(M(a,b,c,d,-1)||M(a,b,c,d,1))},hb=/^(img|br|input|textarea|hr)$/i,Ab=function(a){var b=a.isCollapsed;return b&&X.chrome&&a.rangeCount&&!a.getRangeAt(0).collapsed&&(b=!1),b},kb=
/[\u0590-\u08ac]/,Cb=null,Hb=null,tb=!1,oa=function(a,b,c,d){this.parent=a;this.children=b;this.dom=c;c.pmViewDesc=this;this.contentDOM=d;this.dirty=0},Qa={beforePosition:{},size:{},border:{},posBefore:{},posAtStart:{},posAfter:{},posAtEnd:{},contentLost:{}};oa.prototype.matchesWidget=function(){return!1};oa.prototype.matchesMark=function(){return!1};oa.prototype.matchesNode=function(){return!1};oa.prototype.matchesHack=function(){return!1};Qa.beforePosition.get=function(){return!1};oa.prototype.parseRule=
function(){return null};oa.prototype.stopEvent=function(){return!1};Qa.size.get=function(){for(var a=0,b=0;b<this.children.length;b++)a+=this.children[b].size;return a};Qa.border.get=function(){return 0};oa.prototype.destroy=function(){this.parent=null;this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=null);for(var a=0;a<this.children.length;a++)this.children[a].destroy()};oa.prototype.posBeforeChild=function(a){for(var b=0,c=this.posAtStart;b<this.children.length;b++){var d=this.children[b];if(d==
a)return c;c+=d.size}};Qa.posBefore.get=function(){return this.parent.posBeforeChild(this)};Qa.posAtStart.get=function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0};Qa.posAfter.get=function(){return this.posBefore+this.size};Qa.posAtEnd.get=function(){return this.posAtStart+this.size-2*this.border};oa.prototype.localPosFromDOM=function(a,b,c){if(this.contentDOM&&this.contentDOM.contains(1==a.nodeType?a:a.parentNode)){if(0>c){var d;if(a==this.contentDOM)c=a.childNodes[b-1];else{for(;a.parentNode!=
this.contentDOM;)a=a.parentNode;c=a.previousSibling}for(;c&&(!(d=c.pmViewDesc)||d.parent!=this);)c=c.previousSibling;return c?this.posBeforeChild(d)+d.size:this.posAtStart}var f;if(a==this.contentDOM)c=a.childNodes[b];else{for(;a.parentNode!=this.contentDOM;)a=a.parentNode;c=a.nextSibling}for(;c&&(!(f=c.pmViewDesc)||f.parent!=this);)c=c.nextSibling;return c?this.posBeforeChild(f):this.posAtEnd}if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))var e=2&a.compareDocumentPosition(this.contentDOM);
else if(this.dom.firstChild){if(0==b)for(d=a;;d=d.parentNode){if(d==this.dom){e=!1;break}if(d.parentNode.firstChild!=d)break}if(null==e&&b==a.childNodes.length)for(;;a=a.parentNode){if(a==this.dom){e=!0;break}if(a.parentNode.lastChild!=a)break}}return(null==e?0<c:e)?this.posAtEnd:this.posAtStart};oa.prototype.nearestDesc=function(a,b){for(var c=!0,d=a;d;d=d.parentNode){var f=this.getDesc(d);if(f&&(!b||f.node)){if(!c||!f.nodeDOM||(1==f.nodeDOM.nodeType?f.nodeDOM.contains(a):f.nodeDOM==a))return f;
c=!1}}};oa.prototype.getDesc=function(a){for(var b=a=a.pmViewDesc;b;b=b.parent)if(b==this)return a};oa.prototype.posFromDOM=function(a,b,c){for(var d=a;;d=d.parentNode){var f=this.getDesc(d);if(f)return f.localPosFromDOM(a,b,c)}};oa.prototype.descAt=function(a){for(var b=0,c=0;b<this.children.length;b++){var d=this.children[b],f=c+d.size;if(c==a&&f!=c){for(;!d.border&&d.children.length;)d=d.children[0];return d}if(a<f)return d.descAt(a-c-d.border);c=f}};oa.prototype.domFromPos=function(a){if(!this.contentDOM)return{node:this.dom,
offset:0};for(var b=0,c=0;;c++){if(b==a){for(;c<this.children.length&&this.children[c].beforePosition;)c++;return{node:this.contentDOM,offset:c}}if(c==this.children.length)throw Error("Invalid position "+a);var d=this.children[c],f=b+d.size;if(a<f)return d.domFromPos(a-b-d.border);b=f}};oa.prototype.parseRange=function(a,b,c){if(void 0===c&&(c=0),0==this.children.length)return{node:this.contentDOM,from:a,to:b,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var d=-1,f=-1,e=0,g=0;;g++){var k=
this.children[g],h=e+k.size;if(-1==d&&a<=h){var w=e+k.border;if(a>=w&&b<=h-k.border&&k.node&&k.contentDOM&&this.contentDOM.contains(k.contentDOM))return k.parseRange(a-w,b-w,c+w);a=c+e;for(e=g;0<e;e--){k=this.children[e-1];if(k.size&&k.dom.parentNode==this.contentDOM&&!k.emptyChildAt(1)){d=bb(k.dom)+1;break}a-=k.size}-1==d&&(d=0)}if(-1<d&&b<=h){b=c+h;for(c=g+1;c<this.children.length;c++){g=this.children[c];if(g.size&&g.dom.parentNode==this.contentDOM&&!g.emptyChildAt(-1)){f=bb(g.dom);break}b+=g.size}-1==
f&&(f=this.contentDOM.childNodes.length);break}e=h}return{node:this.contentDOM,from:a,to:b,fromOffset:d,toOffset:f}};oa.prototype.emptyChildAt=function(a){if(this.border||!this.contentDOM||!this.children.length)return!1;var b=this.children[0>a?0:this.children.length-1];return 0==b.size||b.emptyChildAt(a)};oa.prototype.domAfterPos=function(a){var b=this.domFromPos(a),c=b.node;b=b.offset;if(1!=c.nodeType||b==c.childNodes.length)throw new RangeError("No node after pos "+a);return c.childNodes[b]};oa.prototype.setSelection=
function(a,b,c){for(var d=Math.min(a,b),f=Math.max(a,b),e=0,g=0;e<this.children.length;e++){var k=this.children[e],h=g+k.size;if(d>g&&f<h)return k.setSelection(a-g-k.border,b-g-k.border,c);g=h}d=this.domFromPos(a);f=this.domFromPos(b);c=c.getSelection();e=document.createRange();wb(d.node,d.offset,c.anchorNode,c.anchorOffset)&&wb(f.node,f.offset,c.focusNode,c.focusOffset)||(c.extend?(e.setEnd(d.node,d.offset),e.collapse(!1)):(a>b&&(f=d=f),e.setEnd(f.node,f.offset),e.setStart(d.node,d.offset)),c.removeAllRanges(),
c.addRange(e),c.extend&&c.extend(f.node,f.offset))};oa.prototype.ignoreMutation=function(a){return!this.contentDOM};Qa.contentLost.get=function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)};oa.prototype.markDirty=function(a,b){for(var c=0,d=0;d<this.children.length;d++){var f=this.children[d],e=c+f.size;if(c==e?a<=e&&b>=c:a<e&&b>c){var g=c+f.border,k=e-f.border;if(a>=g&&b<=k)return this.dirty=a==c||b==e?2:1,void(a==g&&b==k&&f.contentLost?f.dirty=3:f.markDirty(a-
g,b-g));f.dirty=3}c=e}this.dirty=2};Object.defineProperties(oa.prototype,Qa);var Za=[],Bb=function(a){function b(b,c){a.call(this,b,Za,c.type.widget,null);this.widget=c}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=b;var c={beforePosition:{}};return c.beforePosition.get=function(){return 0>this.widget.type.side},b.prototype.matchesWidget=function(a){return 0==this.dirty&&a.type.eq(this.widget.type)},b.prototype.parseRule=function(){return{ignore:!0}},b.prototype.stopEvent=
function(a){var b=this.widget.spec.stopEvent;return!!b&&b(a)},Object.defineProperties(b.prototype,c),b}(oa),pa=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.parseRule=function(){for(var b,c=this.dom.firstChild;c;c=c.nextSibling){if(3==c.nodeType){var d=c.nodeValue.replace(/\ufeff/g,"");if(!d)continue;d=document.createTextNode(d)}else{if("\ufeff"==c.textContent)continue;d=c.cloneNode(!0)}b||
(b=document.createDocumentFragment());b.appendChild(d)}return b?{skip:b}:a.prototype.parseRule.call(this)},b.prototype.ignoreMutation=function(){return!1},b}(Bb),Oa=function(a){function b(b,c,d){a.call(this,b,[],d,d);this.mark=c}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.create=function(a,c,d,f){var e=C(f)[c.type.name];d=(f=e&&e(c,f))&&f.dom||ma.DOMSerializer.renderSpec(document,c.type.spec.toDOM(c,d)).dom;return new b(a,c,d)},b.prototype.parseRule=
function(){return{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}},b.prototype.matchesMark=function(a){return 3!=this.dirty&&this.mark.eq(a)},b.prototype.markDirty=function(b,c){if(a.prototype.markDirty.call(this,b,c),0!=this.dirty){for(b=this.parent;!b.node;)b=b.parent;b.dirty<this.dirty&&(b.dirty=this.dirty);this.dirty=0}},b}(oa),Na=function(a){function b(b,c,d,f,e,g,k,h){a.call(this,b,c.isLeaf?Za:[],e,g);this.nodeDOM=k;this.node=c;this.outerDeco=d;this.innerDeco=
f;g&&this.updateChildren(h)}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=b;var c={size:{},border:{}};return b.create=function(a,c,d,f,e){var g,k=C(e)[c.type.name],h=(k=k&&k(c,e,function(){if(g&&g.parent)return g.parent.posBeforeChild(g)},d))&&k.dom,m=k&&k.contentDOM;if(c.isText)if(h){if(3!=h.nodeType)throw new RangeError("Text must be rendered as a DOM text node");}else h=document.createTextNode(c.text);else h||(h=(m=ma.DOMSerializer.renderSpec(document,c.type.spec.toDOM(c))).dom,
m=m.contentDOM);m||c.isText||(h.contentEditable=!1,c.type.spec.draggable&&(h.draggable=!0));var w=h;return h=v(h,h,Ma,q(d,c,1!=h.nodeType)),k?g=new Eb(a,c,d,f,h,m,w,k,e):c.isText?new Db(a,c,d,f,h,w,e):new b(a,c,d,f,h,m,w,e)},b.prototype.parseRule=function(){var a=this;return this.contentDOM&&!this.contentLost?{node:this.node.type.name,attrs:this.node.attrs,contentElement:this.contentDOM}:{node:this.node.type.name,attrs:this.node.attrs,getContent:function(){return a.contentDOM?ma.Fragment.empty:a.node.content}}},
b.prototype.matchesNode=function(a,b,c){return 0==this.dirty&&a.eq(this.node)&&Q(b,this.outerDeco)&&c.eq(this.innerDeco)},c.size.get=function(){return this.node.nodeSize},c.border.get=function(){return this.node.isLeaf?0:1},b.prototype.updateChildren=function(a){var b=new Xa(this),c=this.node.inlineContent;!function(a,b,c,d){var f=b.locals(a),e=0;if(0==f.length)for(c=0;c<a.childCount;c++){var g=a.child(c);d(g,f,b.forChild(e,g),c);e+=g.nodeSize}else{g=0;for(var k=[],h=null,m=0;;){if(g<f.length&&f[g].to==
e){for(var w=f[g++],n=void 0;g<f.length&&f[g].to==e;)(n||(n=[w])).push(f[g++]);n?(n.sort(function(a,b){return a.type.side-b.type.side}),n.forEach(c)):c(w)}w=void 0;if(h)w=h,h=null;else{if(!(m<a.childCount))break;w=a.child(m++)}for(n=0;n<k.length;n++)k[n].to<=e&&k.splice(n--,1);for(;g<f.length&&f[g].from==e;)k.push(f[g++]);n=e+w.nodeSize;if(w.isText){var l=n;g<f.length&&f[g].from<l&&(l=f[g].from);for(var t=0;t<k.length;t++)k[t].to<l&&(l=k[t].to);l<n&&(h=w.cut(l-e),w=w.cut(0,l-e),n=l)}d(w,k.length?
k.slice():Za,b.forChild(e,w),m-1);e=n}}}(this.node,this.innerDeco,function(d){d.spec.isCursorWrapper&&b.syncToMarks(d.spec.marks,c,a);b.placeWidget(d)},function(d,f,e,g){b.syncToMarks(d.marks,c,a);b.findNodeMatch(d,f,e,g)||b.updateNextNode(d,f,e,a,g)||b.addNode(d,f,e,a)});b.syncToMarks(Za,c,a);this.node.isTextblock&&b.addTextblockHacks();b.destroyRest();(b.changed||2==this.dirty)&&this.renderChildren()},b.prototype.renderChildren=function(){!function m(a,b){for(var c=a.firstChild,d=0;d<b.length;d++){var f=
b[d],e=f.dom;if(e.parentNode==a){for(;e!=c;)c=A(c);c=c.nextSibling}else a.insertBefore(e,c);f instanceof Oa&&(c=c?c.previousSibling:a.lastChild,m(f.contentDOM,f.children),c=c?c.nextSibling:a.firstChild)}for(;c;)c=A(c)}(this.contentDOM,this.children,b.is);X.ios&&function(a){if("UL"==a.nodeName||"OL"==a.nodeName){var b=a.style.cssText;a.style.cssText=b+"; list-style: square !important";window.getComputedStyle(a).listStyle;a.style.cssText=b}}(this.dom)},b.prototype.update=function(a,b,c,d){return!(3==
this.dirty||!a.sameMarkup(this.node))&&(this.updateInner(a,b,c,d),!0)},b.prototype.updateInner=function(a,b,c,d){this.updateOuterDeco(b);this.node=a;this.innerDeco=c;this.contentDOM&&this.updateChildren(d);this.dirty=0},b.prototype.updateOuterDeco=function(a){if(!Q(a,this.outerDeco)){var b=1!=this.nodeDOM.nodeType,c=this.dom;this.dom=v(this.dom,this.nodeDOM,q(this.outerDeco,this.node,b),q(a,this.node,b));this.dom!=c&&(c.pmViewDesc=null,this.dom.pmViewDesc=this);this.outerDeco=a}},b.prototype.selectNode=
function(){this.nodeDOM.classList.add("ProseMirror-selectednode")},b.prototype.deselectNode=function(){this.nodeDOM.classList.remove("ProseMirror-selectednode")},Object.defineProperties(b.prototype,c),b}(oa),Db=function(a){function b(b,c,d,f,e,g,k){a.call(this,b,c,d,f,e,null,g,k)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.parseRule=function(){var a=this.nodeDOM.parentNode;return a?{skip:a}:{ignore:!0}},b.prototype.update=function(a,b){return!(3==
this.dirty||0!=this.dirty&&!this.inParent()||!a.sameMarkup(this.node))&&(this.updateOuterDeco(b),0==this.dirty&&a.text==this.node.text||a.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=a.text),this.node=a,this.dirty=0,!0)},b.prototype.inParent=function(){for(var a=this.parent.contentDOM,b=this.nodeDOM;b;b=b.parentNode)if(b==a)return!0;return!1},b.prototype.domFromPos=function(a){return{node:this.nodeDOM,offset:a}},b.prototype.localPosFromDOM=function(b,c,d){return b==this.nodeDOM?this.posAtStart+
Math.min(c,this.node.text.length):a.prototype.localPosFromDOM.call(this,b,c,d)},b.prototype.ignoreMutation=function(a){return"characterData"!=a.type},b}(Na),Jb=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.parseRule=function(){return{ignore:!0}},b.prototype.matchesHack=function(){return 0==this.dirty},b}(oa),Eb=function(a){function b(b,c,d,f,e,g,k,h,n){a.call(this,b,c,d,f,e,g,k,n);this.spec=
h}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.update=function(b,c,d,f){if(3==this.dirty)return!1;if(this.spec.update){var e=this.spec.update(b,c);return e&&this.updateInner(b,c,d,f),e}return!(!this.contentDOM&&!b.isLeaf)&&a.prototype.update.call(this,b,c,this.contentDOM?this.innerDeco:d,f)},b.prototype.selectNode=function(){this.spec.selectNode?this.spec.selectNode():a.prototype.selectNode.call(this)},b.prototype.deselectNode=function(){this.spec.deselectNode?
this.spec.deselectNode():a.prototype.deselectNode.call(this)},b.prototype.setSelection=function(b,c,d){this.spec.setSelection?this.spec.setSelection(b,c,d):a.prototype.setSelection.call(this,b,c,d)},b.prototype.destroy=function(){this.spec.destroy&&this.spec.destroy();a.prototype.destroy.call(this)},b.prototype.stopEvent=function(a){return!!this.spec.stopEvent&&this.spec.stopEvent(a)},b.prototype.ignoreMutation=function(b){return this.spec.ignoreMutation?this.spec.ignoreMutation(b):a.prototype.ignoreMutation.call(this,
b)},b}(Na);x.prototype=Object.create(null);var Ma=[new x],Fb,Ib,Xa=function(a){this.top=a;this.index=0;this.stack=[];this.changed=!1;var b=a.node.content;a=a.children;for(var c=[],d=b.childCount,f=a.length-1;0<d&&0<=f;f--){var e=a[f],g=e.node;if(g){if(g!=b.child(d-1))break;c[--d]=e}}this.preMatched=c};Xa.prototype.destroyBetween=function(a,b){if(a!=b){for(var c=a;c<b;c++)this.top.children[c].destroy();this.top.children.splice(a,b-a);this.changed=!0}};Xa.prototype.destroyRest=function(){this.destroyBetween(this.index,
this.top.children.length)};Xa.prototype.syncToMarks=function(a,b,c){for(var d,f=0,e=this.stack.length>>1,g=Math.min(e,a.length);f<g&&(f==e-1?this.top:this.stack[f+1<<1]).matchesMark(a[f]);)f++;for(;f<e;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),e--;for(;e<a.length;)(this.stack.push(this.top,this.index+1),this.index<this.top.children.length&&(d=this.top.children[this.index]).matchesMark(a[e]))?this.top=d:(f=Oa.create(this.top,a[e],b,c),this.top.children.splice(this.index,
0,f),this.top=f,this.changed=!0),this.index=0,e++};Xa.prototype.findNodeMatch=function(a,b,c,d){for(var f=this.index,e=this.top.children,g=Math.min(e.length,f+5);f<g;f++){var k=e[f],h=void 0;if(k.matchesNode(a,b,c)&&(-1==(h=this.preMatched.indexOf(k))||h==d))return this.destroyBetween(this.index,f),this.index++,!0}return!1};Xa.prototype.updateNextNode=function(a,b,c,d,f){if(this.index==this.top.children.length)return!1;var e=this.top.children[this.index];if(e instanceof Na){var g=this.preMatched.indexOf(e);
if(-1<g&&g!=f)return!1;f=e.dom;if(e.update(a,b,c,d))return e.dom!=f&&(this.changed=!0),this.index++,!0}return!1};Xa.prototype.addNode=function(a,b,c,d){this.top.children.splice(this.index++,0,Na.create(this.top,a,b,c,d));this.changed=!0};Xa.prototype.placeWidget=function(a){this.index<this.top.children.length&&this.top.children[this.index].matchesWidget(a)?this.index++:(a=new (a.spec.isCursorWrapper?pa:Bb)(this.top,a),this.top.children.splice(this.index++,0,a),this.changed=!0)};Xa.prototype.addTextblockHacks=
function(){for(var a=this.top.children[this.index-1];a instanceof Oa;)a=a.children[a.children.length-1];a&&a instanceof Db&&!/\n$/.test(a.node.text)||(this.index<this.top.children.length&&this.top.children[this.index].matchesHack()?this.index++:(a=document.createElement("br"),this.top.children.splice(this.index++,0,new Jb(this.top,Za,a,null)),this.changed=!0))};var $a=function(a,b,c){this.prev=a;this.mapping=b;this.state=c},ib=function(a){this.seen=[new $a(null,null,a)];ea.EditorState.addApplyListener(this.track=
this.track.bind(this))};ib.prototype.destroy=function(){ea.EditorState.removeApplyListener(this.track)};ib.prototype.find=function(a){for(var b=this.seen.length-1;0<=b;b--){var c=this.seen[b];if(c.state==a)return c}};ib.prototype.track=function(a,b,c){(a=200>this.seen.length?this.find(a):null)&&this.seen.push(new $a(a,b.docChanged?b.mapping:null,c))};ib.prototype.getMapping=function(a,b){var c=this.find(a);if(!c)return null;for(a=[];c;c=c.prev)c.mapping&&a.push(c.mapping);b=b||new qa.Mapping;for(c=
a.length-1;0<=c;c--)b.appendMapping(a[c]);return b};var Va=function(a){var b=this;this.view=a;this.lastAnchorNode=this.lastHeadNode=this.lastAnchorOffset=this.lastHeadOffset=null;this.lastSelection=a.state.selection;this.ignoreUpdates=!1;this.poller=new ("onselectionchange"in document?Ka:mb)(this);a.dom.addEventListener("focus",function(){return b.poller.start(t(b.view))});a.dom.addEventListener("blur",function(){return b.poller.stop()});a.editable||this.poller.start(!1)};Va.prototype.destroy=function(){this.poller.stop()};
Va.prototype.poll=function(a){this.poller.poll(a)};Va.prototype.editableChanged=function(){this.view.editable?t(this.view)||this.poller.stop():this.poller.start()};Va.prototype.domChanged=function(){var a=this.view.root.getSelection();return a.anchorNode!=this.lastAnchorNode||a.anchorOffset!=this.lastAnchorOffset||a.focusNode!=this.lastHeadNode||a.focusOffset!=this.lastHeadOffset};Va.prototype.storeDOMState=function(a){var b=this.view.root.getSelection();this.lastAnchorNode=b.anchorNode;this.lastAnchorOffset=
b.anchorOffset;this.lastHeadNode=b.focusNode;this.lastHeadOffset=b.focusOffset;this.lastSelection=a};Va.prototype.clearDOMState=function(){this.lastAnchorNode=this.lastSelection=null};Va.prototype.readFromDOM=function(a){if(!this.ignoreUpdates&&this.domChanged()&&t(this.view)&&(this.view.inDOMChange||this.view.domObserver.flush(),!this.view.inDOMChange)){var b=this.view.root.getSelection();var c=this.view.state.doc,d=this.view.docView.nearestDesc(b.focusNode),e=0==d.size,h=this.view.docView.posFromDOM(b.focusNode,
b.focusOffset),m=c.resolve(h);if(Ab(b)){for(b=m;d&&!d.node;)d=d.parent;if(d&&d.node.isAtom&&ea.NodeSelection.isSelectable(d.node)&&d.parent){var n=d.posBefore;n=new ea.NodeSelection(h==n?m:c.resolve(n))}}else b=c.resolve(this.view.docView.posFromDOM(b.anchorNode,b.anchorOffset));n||(n=f(this.view,b,m,"pointer"==a||this.view.state.selection.head<m.pos&&!e?1:-1));c=!e&&!this.view.cursorWrapper&&h==n.head&&b.pos==n.anchor;(c&&this.storeDOMState(n),this.view.state.selection.eq(n))?c||g(this.view):(n=
this.view.state.tr.setSelection(n),"pointer"==a&&n.setMeta("pointer",!0),this.view.dispatch(n))}};var Ka=function(a){var b=this;this.listening=!1;this.curOrigin=null;this.originTime=0;this.reader=a;this.readFunc=function(){return a.readFromDOM(b.originTime>Date.now()-50?b.curOrigin:null)}};Ka.prototype.poll=function(a){this.curOrigin=a;this.originTime=Date.now()};Ka.prototype.start=function(a){this.listening||(this.reader.view.dom.ownerDocument.addEventListener("selectionchange",this.readFunc),this.listening=
!0,a&&this.readFunc())};Ka.prototype.stop=function(){this.listening&&(this.reader.view.dom.ownerDocument.removeEventListener("selectionchange",this.readFunc),this.listening=!1)};var mb=function(a){this.polling=null;this.reader=a;this.pollFunc=this.doPoll.bind(this,null)};mb.prototype.doPoll=function(a){var b=this.reader.view;b.focused||!b.editable?(this.reader.readFromDOM(a),this.polling=setTimeout(this.pollFunc,100)):this.polling=null};mb.prototype.poll=function(a){clearTimeout(this.polling);this.polling=
setTimeout(a?this.doPoll.bind(this,a):this.pollFunc,0)};mb.prototype.start=function(){null==this.polling&&this.poll()};mb.prototype.stop=function(){clearTimeout(this.polling);this.polling=null};var sa=function J(a,b){var c=this;this.view=a;this.state=a.state;this.composing=b;this.from=this.to=null;this.typeOver=!1;this.timeout=b?null:setTimeout(function(){return c.finish()},J.commitTimeout);this.trackMappings=new ib(a.state);this.mapping=new qa.Mapping;this.mappingTo=a.state};sa.prototype.addRange=
function(a,b){null==this.from?(this.from=a,this.to=b):(this.from=Math.min(a,this.from),this.to=Math.max(b,this.to))};sa.prototype.changedRange=function(){if(null==this.from){a:{var a=this.state.selection;var b=a.$anchor.min(a.$head);a=a.$anchor.max(a.$head);if(b.sameParent(a)&&b.parent.inlineContent&&b.parentOffset&&a.parentOffset<a.parent.content.size){var c=Math.max(0,b.parentOffset),d=b.parent.content.size;a=Math.min(d,a.parentOffset);if(0<c&&(c=b.parent.childBefore(c).offset),a<d)a=b.parent.childAfter(a),
a=a.offset+a.node.nodeSize;b=b.start();b={from:b+c,to:b+a}}else for(c=0;;c++){b:{d=b;for(var f=c+1||0;f<d.depth;f++)if(0<d.index(0)){d=!1;break b}d=0==d.parentOffset}b:{f=a;for(var e=c+1||0;e<f.depth;e++)if(f.index(e)+1<f.node(e).childCount){var g=!1;break b}g=f.parentOffset==f.parent.content.size}if(d||g||b.index(c)!=a.index(c)||a.node(c).isTextblock){f=b.before(c+1);e=a.after(c+1);b=(d&&0<b.index(c)&&(f-=b.node(c).child(b.index(c)-1).nodeSize),g&&a.index(c)+1<a.node(c).childCount&&(e+=a.node(c).child(a.index(c)+
1).nodeSize),{from:f,to:e});break a}}}return b}b=this.state.doc.resolve(Math.min(this.from,this.state.selection.from));a=this.state.doc.resolve(this.to);c=b.sharedDepth(this.to);return{from:b.before(c+1),to:a.after(c+1)}};sa.prototype.markDirty=function(a){null==this.from?this.view.docView.markDirty((a=a||this.changedRange()).from,a.to):this.view.docView.markDirty(this.from,this.to)};sa.prototype.stateUpdated=function(a){return this.trackMappings.getMapping(a,this.mapping)?(this.trackMappings.destroy(),
this.trackMappings=new ib(a),this.mappingTo=a,!0):(this.markDirty(),this.destroy(),!1)};sa.prototype.finish=function(a){if(clearTimeout(this.timeout),!this.composing||a){this.view.domObserver.flush();a=this.changedRange();this.markDirty(a);this.destroy();var b=this.state.selection;b=this.typeOver&&b instanceof ea.TextSelection&&!b.empty&&b.$head.sameParent(b.$anchor);!function(a,b,c,d,f){d=function(a,b,c){var d=a.docView.parseRange(c.from,c.to),f=d.node,e=d.fromOffset,g=d.toOffset;c=d.from;d=d.to;
var k=a.root.getSelection(),h=null,m=k.anchorNode;m&&a.dom.contains(1==m.nodeType?m:m.parentNode)&&(h=[{node:m,offset:k.anchorOffset}],Ab(k)||h.push({node:k.focusNode,offset:k.focusOffset}));b=b.doc;a=a.someProp("domParser")||ma.DOMParser.fromSchema(a.state.schema);k=b.resolve(c);b=null;f=a.parse(f,{topNode:k.parent,topMatch:k.parent.contentMatchAt(k.index()),topOpen:!0,from:e,to:g,preserveWhitespace:!k.parent.type.spec.code||"full",editableContent:!0,findPositions:h,ruleFromNode:E(a,k),context:k});
h&&null!=h[0].pos&&(e=h[0].pos,h=h[1]&&h[1].pos,null==h&&(h=e),b={anchor:e+c,head:h+c});return{doc:f,sel:b,from:c,to:d}}(a,c,d);var e=c.doc,g=function(a,b,c,d){var f=a.findDiffStart(b,c);if(null==f)return null;var e=a.findDiffEnd(b,c+a.size,c+b.size);c=e.a;e=e.b;c<f&&a.size<b.size?(e=(f-=d<=f&&d>=c?f-d:0)+(e-c),c=f):e<f&&(c=(f-=d<=f&&d>=e?f-d:0)+(c-e),e=f);return{start:f,endA:c,endB:e}}(e.slice(d.from,d.to).content,d.doc.content,d.from,c.selection.from);if(g){var k;f=d.doc.resolveNoCache(g.start-
d.from);var h=d.doc.resolveNoCache(g.endB-d.from);if(!(!f.sameParent(h)&&f.pos<d.doc.content.size&&(k=ea.Selection.findFrom(d.doc.resolve(f.pos+1),1,!0))&&k.head==h.pos&&a.someProp("handleKeyDown",function(b){return b(a,I(13,"Enter"))})||c.selection.anchor>g.start&&function(a,b,c,d,f){if(!d.parent.isTextblock||c-b<=f.pos-d.pos||la(d,!0,!1)<f.pos)return!1;b=a.resolve(b);if(b.parentOffset<b.parent.content.size||!b.parent.isTextblock)return!1;a=a.resolve(la(b,!0,!0));return!a.parent.isTextblock||a.pos>
c||la(a,!0,!1)<c?!1:d.parent.content.cut(d.parentOffset).eq(a.parent.content)}(e,g.start,g.endA,f,h)&&a.someProp("handleKeyDown",function(b){return b(a,I(8,"Backspace"))}))){var m,n,w=b.map(g.start),l=b.map(g.endA,-1);if(f.sameParent(h)&&f.parent.inlineContent)if(f.pos==h.pos){var t=a.state.tr.delete(w,l);var p=e.resolve(g.start).marksAcross(e.resolve(g.endA))}else if(g.endA==g.endB&&(n=e.resolve(g.start))&&(m=function(a,b){var c=a.firstChild.marks;var d=b.firstChild.marks;var f=c;for(var e=d,g=0;g<
d.length;g++)f=d[g].removeFromSet(f);for(d=0;d<c.length;d++)e=c[d].removeFromSet(e);if(1==f.length&&0==e.length){var k=f[0];c="add";f=function(a){return a.mark(k.addToSet(a.marks))}}else{if(0!=f.length||1!=e.length)return null;k=e[0];c="remove";f=function(a){return a.mark(k.removeFromSet(a.marks))}}e=[];for(d=0;d<b.childCount;d++)e.push(f(b.child(d)));if(ma.Fragment.from(e).eq(a))return{mark:k,type:c}}(f.parent.content.cut(f.parentOffset,h.parentOffset),n.parent.content.cut(n.parentOffset,g.endA-
n.start()))))t=a.state.tr,"add"==m.type?t.addMark(w,l,m.mark):t.removeMark(w,l,m.mark);else if(f.parent.child(f.index()).isText&&f.index()==h.index()-(h.textOffset?0:1)){var q=f.parent.textBetween(f.parentOffset,h.parentOffset);if(a.someProp("handleTextInput",function(b){return b(a,w,l,q)}))return;t=a.state.tr.insertText(q,w,l)}t||(t=a.state.tr.replace(w,l,d.doc.slice(g.start-d.from,g.endB-d.from)));d.sel&&(b=ka(a,t.doc,b,d.sel))&&t.setSelection(b);p&&t.ensureMarks(p);a.dispatch(t.scrollIntoView())}}else f?
(t=a.state,p=t.selection,a.dispatch(t.tr.replaceSelectionWith(t.schema.text(t.doc.textBetween(p.from,p.to)),!0).scrollIntoView())):d.sel&&(t=ka(a,a.state.doc,b,d.sel))&&!t.eq(a.state.selection)&&a.dispatch(a.state.tr.setSelection(t))}(this.view,this.mapping,this.state,a,b);this.view.docView.dirty&&this.view.updateState(this.view.state)}};sa.prototype.destroy=function(){clearTimeout(this.timeout);this.trackMappings.destroy();this.view.inDOMChange=null};sa.prototype.compositionEnd=function(){var a=
this;this.composing&&(this.composing=!1,this.timeout=setTimeout(function(){return a.finish()},50))};sa.start=function(a,b){return a.inDOMChange?b&&(clearTimeout(a.inDOMChange.timeout),a.inDOMChange.composing=!0):a.inDOMChange=new sa(a,b),a.inDOMChange};sa.commitTimeout=20;var Ya={thead:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},nb=null,ob={childList:!0,characterData:!0,attributes:!0,subtree:!0,characterDataOldValue:!0},
ub=X.ie&&11>=X.ie_version,ta=function(a){var b=this;this.view=a;this.observer=window.MutationObserver&&new window.MutationObserver(function(a){return b.registerMutations(a)});ub&&(this.onCharData=function(a){return b.registerMutation({target:a.target,type:"characterData",oldValue:a.prevValue})})};ta.prototype.start=function(){this.observer&&this.observer.observe(this.view.dom,ob);ub&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData)};ta.prototype.stop=function(){this.observer&&
(this.flush(),this.observer.disconnect());ub&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData)};ta.prototype.flush=function(){this.observer&&this.registerMutations(this.observer.takeRecords())};ta.prototype.registerMutations=function(a){for(var b=0;b<a.length;b++)this.registerMutation(a[b])};ta.prototype.registerMutation=function(a){if(this.view.editable){var b=this.view.docView.nearestDesc(a.target);if(("attributes"!=a.type||b!=this.view.docView&&"contenteditable"!=a.attributeName)&&
b&&!b.ignoreMutation(a)){if("childList"==a.type){var c=a.previousSibling&&a.previousSibling.parentNode==a.target?bb(a.previousSibling)+1:0;if(-1==c)return;c=b.localPosFromDOM(a.target,c,-1);var d=a.nextSibling&&a.nextSibling.parentNode==a.target?bb(a.nextSibling):a.target.childNodes.length;if(-1==d)return;d=b.localPosFromDOM(a.target,d,1)}else"attributes"==a.type?(c=b.posAtStart-b.border,d=b.posAtEnd+b.border):(c=b.posAtStart,d=b.posAtEnd,a.target.nodeValue==a.oldValue&&(sa.start(this.view).typeOver=
!0));sa.start(this.view).addRange(c,d)}}};var Fa={},Ga={keydown:function(a,b){16==b.keyCode&&(a.shiftKey=!0);a.inDOMChange||(a.someProp("handleKeyDown",function(c){return c(a,b)})||function(a,b){var c=b.keyCode,f="";b=(b.ctrlKey&&(f+="c"),b.metaKey&&(f+="m"),b.altKey&&(f+="a"),b.shiftKey&&(f+="s"),f);return 8==c||X.mac&&72==c&&"c"==b?d(a,-1)||F(a):46==c||X.mac&&68==c&&"c"==b?d(a,1)||l(a):13==c||27==c||(37==c?Z(a,-1)||F(a):39==c?Z(a,1)||l(a):38==c?u(a,-1)||F(a):40==c?u(a,1)||l(a):b==(X.mac?"m":"c")&&
(66==c||73==c||89==c||90==c))}(a,b)?b.preventDefault():a.selectionReader.poll())},keyup:function(a,b){16==b.keyCode&&(a.shiftKey=!1)},keypress:function(a,b){if(!(a.inDOMChange||!b.charCode||b.ctrlKey&&!b.altKey||X.mac&&b.metaKey))if(a.someProp("handleKeyPress",function(c){return c(a,b)}))b.preventDefault();else{var c=a.state.selection;if(!(c instanceof ea.TextSelection&&c.$from.sameParent(c.$to))){var d=String.fromCharCode(b.charCode);a.someProp("handleTextInput",function(b){return b(a,c.$from.pos,
c.$to.pos,d)})||a.dispatch(a.state.tr.insertText(d).scrollIntoView());b.preventDefault()}}}},pb={time:0,x:0,y:0},qb=pb,jb=X.mac?"metaKey":"ctrlKey";Fa.mousedown=function(a,b){var c=na(a),d=Date.now();var f=500<=d-pb.time||!da(b,pb)||b[jb]?"singleClick":600<=d-qb.time||!da(b,qb)?"doubleClick":"tripleClick";qb=pb;pb={time:d,x:b.clientX,y:b.clientY};(d=a.posAtCoords({left:b.clientX,top:b.clientY}))&&("singleClick"==f?a.mouseDown=new Aa(a,d,b,c):("doubleClick"==f?function(a,b,c,d){return Ea(a,"handleDoubleClickOn",
b,c,d)||a.someProp("handleDoubleClick",function(c){return c(a,b,d)})}:ra)(a,d.pos,d.inside,b)?b.preventDefault():a.selectionReader.poll("pointer"))};var Aa=function(a,b,c,d){var f=this;if(this.view=a,this.pos=b,this.event=c,this.flushed=d,this.selectNode=c[jb],this.allowDefault=c.shiftKey,-1<b.inside){var e=a.state.doc.nodeAt(b.inside);b=b.inside}else b=a.state.doc.resolve(b.pos),e=b.parent,b=b.depth?b.before():0;this.mightDrag=null;this.target=d?null:c.target;(e.type.spec.draggable&&!1!==e.type.spec.selectable||
a.state.selection instanceof ea.NodeSelection&&b==a.state.selection.from)&&(this.mightDrag={node:e,pos:b,addAttr:this.target&&!this.target.draggable,setUneditable:this.target&&X.gecko&&!this.target.hasAttribute("contentEditable")});this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(function(){return f.target.setAttribute("contentEditable","false")},
20),this.view.domObserver.start());a.root.addEventListener("mouseup",this.up=this.up.bind(this));a.root.addEventListener("mousemove",this.move=this.move.bind(this));a.selectionReader.poll("pointer")};Aa.prototype.done=function(){this.view.root.removeEventListener("mouseup",this.up);this.view.root.removeEventListener("mousemove",this.move);this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!1),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),
this.view.domObserver.start())};Aa.prototype.up=function(a){this.done();this.view.dom.contains(3==a.target.nodeType?a.target.parentNode:a.target)&&(this.allowDefault?this.view.selectionReader.poll("pointer"):La(this.view,this.pos.pos,this.pos.inside,a,this.selectNode)?a.preventDefault():this.flushed?(W(this.view,ea.Selection.near(this.view.state.doc.resolve(this.pos.pos)),"pointer"),a.preventDefault()):this.view.selectionReader.poll("pointer"))};Aa.prototype.move=function(a){!this.allowDefault&&(4<
Math.abs(this.event.x-a.clientX)||4<Math.abs(this.event.y-a.clientY))&&(this.allowDefault=!0);this.view.selectionReader.poll("pointer")};Fa.touchdown=function(a){na(a);a.selectionReader.poll("pointer")};Fa.contextmenu=function(a){return na(a)};Ga.compositionstart=Ga.compositionupdate=function(a){sa.start(a,!0)};Ga.compositionend=function(a,b){if(!a.inDOMChange){if(!b.data)return;sa.start(a,!0)}a.inDOMChange.compositionEnd()};Ga.input=function(a){a=sa.start(a);a.composing||a.finish()};var wa=X.ie&&
15>X.ie_version||X.ios;Fa.copy=Ga.cut=function(a,b){var c=a.state.selection,d="cut"==b.type;if(!c.empty){var f=wa?null:b.clipboardData,e=Ua(a,c.content());c=e.dom;e=e.text;f?(b.preventDefault(),f.clearData(),f.setData("text/html",c.innerHTML),f.setData("text/plain",e)):function(a,b){var c=b.ownerDocument,d=c.body.appendChild(c.createElement("div"));d.appendChild(b);d.style.cssText="position: fixed; left: -10000px; top: 10px";var f=getSelection(),e=c.createRange();e.selectNodeContents(b);a.dom.blur();
f.removeAllRanges();f.addRange(e);setTimeout(function(){c.body.removeChild(d);a.focus()},50)}(a,c);d&&a.dispatch(a.state.tr.deleteSelection().scrollIntoView())}};Ga.paste=function(a,b){var c=wa?null:b.clipboardData;c&&xa(a,c.getData("text/plain"),c.getData("text/html"),b)?b.preventDefault():function(a,b){var c=a.dom.ownerDocument,d=a.shiftKey||a.state.selection.$from.parent.type.spec.code,f=c.body.appendChild(c.createElement(d?"textarea":"div"));d||(f.contentEditable="true");f.style.cssText="position: fixed; left: -10000px; top: 10px";
f.focus();setTimeout(function(){a.focus();c.body.removeChild(f);d?xa(a,f.value,null,b):xa(a,f.textContent,f.innerHTML,b)},50)}(a,b)};var rb=function(a,b){this.slice=a;this.move=b},Gb=X.mac?"altKey":"ctrlKey",xb;for(xb in Fa.dragstart=function(a,b){var c=a.mouseDown;if(c&&c.done(),b.dataTransfer){var d=a.state.selection,f=d.empty?null:a.posAtCoords({left:b.clientX,top:b.clientY});if(!(f&&f.pos>=d.from&&f.pos<=d.to))if(c&&c.mightDrag)a.dispatch(a.state.tr.setSelection(ea.NodeSelection.create(a.state.doc,
c.mightDrag.pos)));else if(b.target&&1==b.target.nodeType){c=a.docView.nearestDesc(b.target,!0);if(!c||!c.node.type.spec.draggable||c==a.docView)return;a.dispatch(a.state.tr.setSelection(ea.NodeSelection.create(a.state.doc,c.posBefore)))}c=a.state.selection.content();f=Ua(a,c);d=f.dom;f=f.text;b.dataTransfer.clearData();b.dataTransfer.setData(wa?"Text":"text/html",d.innerHTML);wa||b.dataTransfer.setData("text/plain",f);a.dragging=new rb(c,!b[Gb])}},Fa.dragend=function(a){window.setTimeout(function(){return a.dragging=
null},50)},Ga.dragover=Ga.dragenter=function(a,b){return b.preventDefault()},Ga.drop=function(a,b){var c=a.dragging;if(a.dragging=null,b.dataTransfer){var d=a.state.doc.resolve(a.posAtCoords({left:b.clientX,top:b.clientY}).pos);if(d){var e=c&&c.slice||Ia(a,b.dataTransfer.getData(wa?"Text":"text/plain"),wa?null:b.dataTransfer.getData("text/html"),!1,d);if(e&&(b.preventDefault(),!a.someProp("handleDrop",function(d){return d(a,b,e,c&&c.move)}))){d=function(a,b){if(!a||!a.content.size)return b.pos;for(var c=
a.content,d=0;d<a.openStart;d++)c=c.firstChild.content;for(a=b.depth;0<=a;a--){d=a==b.depth?0:b.pos<=(b.start(a+1)+b.end(a+1))/2?-1:1;var f=b.index(a)+(0<d?1:0);if(b.node(a).canReplace(f,f,c))return 0==d?b.pos:0>d?b.before(a+1):b.after(a+1)}return b.pos}(e,a.state.doc.resolve(d.pos));var g=a.state.tr;c&&c.move&&g.deleteSelection();var h=g.mapping.map(d),k=0==e.openStart&&0==e.openEnd&&1==e.content.childCount;k?g.replaceRangeWith(h,h,e.content.firstChild):g.replaceRange(h,h,e);h=g.doc.resolve(h);k&&
ea.NodeSelection.isSelectable(e.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(e.content.firstChild)?g.setSelection(new ea.NodeSelection(h)):g.setSelection(f(a,h,g.doc.resolve(g.mapping.map(d))));a.focus();a.dispatch(g)}}}},Fa.focus=function(a){a.focused||(a.dom.classList.add("ProseMirror-focused"),a.focused=!0)},Fa.blur=function(a){a.focused&&(a.dom.classList.remove("ProseMirror-focused"),a.focused=!1)},Ga)Fa[xb]=Ga[xb];var db=function(a,b){(this.spec=b||Da,this.side=this.spec.side||0,
this.spec.raw)||(1!=a.nodeType&&(b=document.createElement("span"),b.appendChild(a),a=b),a.contentEditable=!1,a.classList.add("ProseMirror-widget"));this.widget=a};db.prototype.map=function(a,b,c,d){a=a.mapResult(b.from+d,0>this.side?-1:1);b=a.pos;return a.deleted?null:new va(b-c,b-c,this)};db.prototype.valid=function(){return!0};db.prototype.eq=function(a){return this==a||a instanceof db&&(this.widget==a.widget||this.spec.key)&&Sa(this.spec,a.spec)};var Ca=function(a,b){this.spec=b||Da;this.attrs=
a};Ca.prototype.map=function(a,b,c,d){var f=a.map(b.from+d,this.spec.inclusiveStart?-1:1)-c;a=a.map(b.to+d,this.spec.inclusiveEnd?1:-1)-c;return f>=a?null:new va(f,a,this)};Ca.prototype.valid=function(a,b){return b.from<b.to};Ca.prototype.eq=function(a){return this==a||a instanceof Ca&&Sa(this.attrs,a.attrs)&&Sa(this.spec,a.spec)};Ca.is=function(a){return a.type instanceof Ca};var sb=function(a,b){this.spec=b||Da;this.attrs=a};sb.prototype.map=function(a,b,c,d){var f=a.mapResult(b.from+d,1);if(f.deleted)return null;
a=a.mapResult(b.to+d,-1);return a.deleted||a.pos<=f.pos?null:new va(f.pos-c,a.pos-c,this)};sb.prototype.valid=function(a,b){var c=a.content.findIndex(b.from),d=c.index;c=c.offset;return c==b.from&&c+a.child(d).nodeSize==b.to};sb.prototype.eq=function(a){return this==a||a instanceof sb&&Sa(this.attrs,a.attrs)&&Sa(this.spec,a.spec)};var va=function(a,b,c){this.from=a;this.to=b;this.type=c},yb={spec:{}};va.prototype.copy=function(a,b){return new va(a,b,this.type)};va.prototype.eq=function(a){return this.type.eq(a.type)&&
this.from==a.from&&this.to==a.to};va.prototype.map=function(a,b,c){return this.type.map(a,this,b,c)};va.widget=function(a,b,c){return new va(a,a,new db(b,c))};va.inline=function(a,b,c,d){return new va(a,b,new Ca(c,d))};va.node=function(a,b,c,d){return new va(a,b,new sb(c,d))};yb.spec.get=function(){return this.type.spec};Object.defineProperties(va.prototype,yb);var fb=[],Da={},ia=function(a,b){this.local=a&&a.length?a:fb;this.children=b&&b.length?b:fb};ia.create=function(a,b){return b.length?fa(b,
a,0,Da):ha};ia.prototype.find=function(a,b,c){var d=[];return this.findInner(null==a?0:a,null==b?1E9:b,d,0,c),d};ia.prototype.findInner=function(a,b,c,d,f){for(var e=0;e<this.local.length;e++){var g=this.local[e];g.from<=b&&g.to>=a&&(!f||f(g.spec))&&c.push(g.copy(g.from+d,g.to+d))}for(e=0;e<this.children.length;e+=3)this.children[e]<b&&this.children[e+1]>a&&(g=this.children[e]+1,this.children[e+2].findInner(a-g,b-g,c,d+g,f))};ia.prototype.map=function(a,b,c){return this==ha||0==a.maps.length?this:
this.mapInner(a,b,0,0,c||Da)};ia.prototype.mapInner=function(b,c,d,f,e){for(var g,h=0;h<this.local.length;h++){var k=this.local[h].map(b,d,f);k&&k.type.valid(c,k)?(g||(g=[])).push(k):e.onRemove&&e.onRemove(this.local[h].spec)}return this.children.length?function(b,c,d,f,e,g,h){for(var k=b.slice(),m=function(a,b,c,d){for(var f=0;f<k.length;f+=3){var e=k[f+1],h=void 0;-1==e||a>e+g||(b>=k[f]+g?k[f+1]=-1:(h=d-c-(b-a))&&(k[f]+=h,k[f+1]+=h))}},n=0;n<d.maps.length;n++)d.maps[n].forEach(m);m=!1;for(n=0;n<
k.length;n+=3)if(-1==k[n+1]){var l=d.map(k[n]+g),t=l-e;if(0>t||t>=f.content.size)m=!0;else{var p=d.map(b[n+1]+g,-1)-e,w=f.content.findIndex(t),q=w.offset;(w=f.maybeChild(w.index))&&q==t&&q+w.nodeSize==p?(l=k[n+2].mapInner(d,w,l+1,k[n]+g+1,h),l!=ha?(k[n]=t,k[n+1]=p,k[n+2]=l):(k.splice(n,3),n-=3)):m=!0}}if(m){c=function(a,b,c,d,f){function e(a,d){for(var g=0;g<a.local.length;g++){var h=a.local[g].map(c,0,d);h?b.push(h):f.onRemove&&f.onRemove(a.local[g].spec)}for(g=0;g<a.children.length;g+=3)e(a.children[g+
2],a.children[g]+d+1)}for(var g=0;g<a.length;g+=3)-1==a[g+1]&&e(a[g+2],a[g]+d+1);return b}(k,c?Ta(c,e):[],d,g,h);f=fa(c,f,0,h);c=f.local;for(h=0;h<k.length;h+=3)-1==k[h+1]&&(k.splice(h,3),h-=3);for(b=h=0;h<f.children.length;h+=3){for(d=f.children[h];b<k.length&&k[b]<d;)b+=3;k.splice(b,0,f.children[h],f.children[h+1],f.children[h+2])}}return new ia(c&&c.sort(a),k)}(this.children,g,b,c,d,f,e):g?new ia(g.sort(a)):ha};ia.prototype.add=function(a,b){return b.length?this==ha?ia.create(a,b):this.addInner(a,
b,0):this};ia.prototype.addInner=function(b,c,d){var f,e=this,g=0;b.forEach(function(a,b){var h,k=b+d;if(h=ya(c,a,k)){for(f||(f=e.children.slice());g<f.length&&f[g]<b;)g+=3;f[g]==b?f[g+2]=f[g+2].addInner(a,h,k+1):f.splice(g,0,b,b+a.nodeSize,fa(h,a,k+1,Da));g+=3}});b=Ta(g?R(c):c,-d);return new ia(b.length?this.local.concat(b).sort(a):this.local,f||this.children)};ia.prototype.remove=function(a){return 0==a.length||this==ha?this:this.removeInner(a,0)};ia.prototype.removeInner=function(a,b){for(var c=
this.children,d=this.local,f=0;f<c.length;f+=3){for(var e=void 0,g=c[f]+b,h=c[f+1]+b,k=0,n=void 0;k<a.length;k++)(n=a[k])&&n.from>g&&n.to<h&&(a[k]=null,(e||(e=[])).push(n));e&&(c==this.children&&(c=this.children.slice()),e=c[f+2].removeInner(e,g+1),e!=ha?c[f+2]=e:(c.splice(f,3),f-=3))}if(d.length)for(b=0;b<a.length;b++)if(f=a[b])for(e=0;e<d.length;e++)d[e].type==f.type&&(d==this.local&&(d=this.local.slice()),d.splice(e--,1));return c==this.children&&d==this.local?this:d.length||c.length?new ia(d,
c):ha};ia.prototype.forChild=function(b,c){var d,f;if(this==ha)return this;if(c.isLeaf)return ia.empty;for(var e=0;e<this.children.length;e+=3)if(this.children[e]>=b){this.children[e]==b&&(d=this.children[e+2]);break}b+=1;c=b+c.content.size;for(e=0;e<this.local.length;e++){var g=this.local[e];if(g.from<c&&g.to>b&&g.type instanceof Ca){var h=Math.max(b,g.from)-b,k=Math.min(c,g.to)-b;h<k&&(f||(f=[])).push(g.copy(h,k))}}return f?(f=new ia(f.sort(a)),d?new Pa([f,d]):f):d||ha};ia.prototype.eq=function(a){if(this==
a)return!0;if(!(a instanceof ia)||this.local.length!=a.local.length||this.children.length!=a.children.length)return!1;for(var b=0;b<this.local.length;b++)if(!this.local[b].eq(a.local[b]))return!1;for(b=0;b<this.children.length&&this.children[b]==a.children[b]&&this.children[b+1]==a.children[b+1]&&this.children[b+2].eq(a.children[b+2]);b+=3);return!1};ia.prototype.locals=function(a){return c(this.localsInner(a))};ia.prototype.localsInner=function(a){if(this==ha)return fb;if(a.inlineContent||!this.local.some(Ca.is))return this.local;
a=[];for(var b=0;b<this.local.length;b++)this.local[b].type instanceof Ca||a.push(this.local[b]);return a};var ha=new ia;ia.empty=ha;ia.removeOverlap=c;var Pa=function(a){this.members=a};Pa.prototype.forChild=function(a,b){if(b.isLeaf)return ia.empty;for(var c=[],d=0;d<this.members.length;d++){var f=this.members[d].forChild(a,b);f!=ha&&(f instanceof Pa?c=c.concat(f.members):c.push(f))}return Pa.from(c)};Pa.prototype.eq=function(a){if(!(a instanceof Pa)||a.members.length!=this.members.length)return!1;
for(var b=0;b<this.members.length;b++)if(!this.members[b].eq(a.members[b]))return!1;return!0};Pa.prototype.locals=function(b){for(var d,f=!0,e=0;e<this.members.length;e++){var g=this.members[e].localsInner(b);if(g.length)if(d){f&&(d=d.slice(),f=!1);for(var h=0;h<g.length;h++)d.push(g[h])}else d=g}return d?c(f?d:d.sort(a)):fb};Pa.from=function(a){switch(a.length){case 0:return ha;case 1:return a[0];default:return new Pa(a)}};var ua=function(a,b){this._props=b;this.state=b.state;this.dispatch=this.dispatch.bind(this);
this._root=null;this.focused=!1;this.dom=a&&a.mount||document.createElement("div");a&&(a.appendChild?a.appendChild(this.dom):a.apply?a(this.dom):a.mount&&(this.mounted=!0));this.editable=Ja(this);this.cursorWrapper=null;Ba(this);this.docView=P(this.state.doc,Ha(this),K(this),this.dom,this);this.dragging=this.lastSelectedViewDesc=null;(function(a){a.shiftKey=!1;a.mouseDown=null;a.inDOMChange=null;a.domObserver=new ta(a);a.domObserver.start();a.eventHandlers=Object.create(null);var b=function(b){var c=
Fa[b];a.dom.addEventListener(b,a.eventHandlers[b]=function(b){!function(a,b){if(!b.bubbles)return!0;if(b.defaultPrevented)return!1;for(var c=b.target;c!=a.dom;c=c.parentNode)if(!c||11==c.nodeType||c.pmViewDesc&&c.pmViewDesc.stopEvent(b))return!1;return!0}(a,b)||Ra(a,b)||!a.editable&&b.type in Ga||c(a,b)})},c;for(c in Fa)b(c);H(a)})(this);this.selectionReader=new Va(this);this.pluginViews=[];this.updatePluginViews()},eb={props:{},root:{}};eb.props.get=function(){if(this._props.state!=this.state){var a=
this._props,b;for(b in this._props={},a)this._props[b]=a[b];this._props.state=this.state}return this._props};ua.prototype.update=function(a){a.handleDOMEvents!=this._props.handleDOMEvents&&H(this);this._props=a;this.updateState(a.state)};ua.prototype.setProps=function(a){var b={},c;for(c in this._props)b[c]=this._props[c];for(var d in b.state=this.state,a)b[d]=a[d];this.update(b)};ua.prototype.updateState=function(a){var b=this,c=this.state;if(this.state=a,c.plugins!=a.plugins&&H(this),this.domObserver.flush(),
!this.inDOMChange||!this.inDOMChange.stateUpdated(a)){var d=this.editable;this.editable=Ja(this);Ba(this);var f=K(this),e=Ha(this),h=c.config!=a.config?"reset":a.scrollToSelection>c.scrollToSelection?"to selection":"preserve",k=!this.docView.matchesNode(a.doc,e,f),n=k||!a.selection.eq(c.selection)||this.selectionReader.domChanged(),l="preserve"==h&&n&&function(a){for(var b,c,d=a.dom.getBoundingClientRect(),f=Math.max(0,d.top),e=a.dom.ownerDocument,g=(d.left+d.right)/2,h=f+1;h<Math.min(innerHeight,
d.bottom);h+=5){var k=a.root.elementFromPoint(g,h);if(k!=a.dom&&a.dom.contains(k)){var m=k.getBoundingClientRect();if(m.top>=f-20){b=k;c=m.top;break}}}d=[];for(a=a.dom;a&&(d.push({dom:a,top:a.scrollTop,left:a.scrollLeft}),a!=e.body);a=cb(a));return{refDOM:b,refTop:c,stack:d}}(this);n&&(this.domObserver.stop(),k&&(this.docView.update(a.doc,e,f,this)||(this.docView.destroy(),this.docView=P(a.doc,e,f,this.dom,this)),this.selectionReader.clearDOMState()),g(this),this.domObserver.start());d!=this.editable&&
this.selectionReader.editableChanged();this.updatePluginViews(c);"reset"==h?this.dom.scrollTop=0:"to selection"==h?this.someProp("handleScrollToSelection",function(a){return a(b)})||(a.selection instanceof ea.NodeSelection?T(this,this.docView.domAfterPos(a.selection.from).getBoundingClientRect()):T(this,this.coordsAtPos(a.selection.head))):l&&function(a){var b=a.refDOM,c=a.refTop;a=a.stack;b=b?b.getBoundingClientRect().top:0;c=0==b?0:b-c;for(b=0;b<a.length;b++){var d=a[b],f=d.dom,e=d.top;d=d.left;
f.scrollTop!=e+c&&(f.scrollTop=e+c);f.scrollLeft!=d&&(f.scrollLeft=d)}}(l)}};ua.prototype.destroyPluginViews=function(){for(var a;a=this.pluginViews.pop();)a.destroy&&a.destroy()};ua.prototype.updatePluginViews=function(a){var b=this.state.plugins;if(a&&a.plugins==b)for(b=0;b<this.pluginViews.length;b++){var c=this.pluginViews[b];c.update&&c.update(this,a)}else for(this.destroyPluginViews(),a=0;a<b.length;a++)c=b[a],c.spec.view&&this.pluginViews.push(c.spec.view(this))};ua.prototype.someProp=function(a,
b){var c,d=this._props&&this._props[a];if(null!=d&&(c=b?b(d):d))return c;if(d=this.state.plugins)for(var f=0;f<d.length;f++){var e=d[f].props[a];if(null!=e&&(c=b?b(e):e))return c}};ua.prototype.hasFocus=function(){return this.root.activeElement==this.dom};ua.prototype.focus=function(){this.domObserver.stop();g(this,!0);this.domObserver.start();this.editable&&this.dom.focus()};eb.root.get=function(){var a=this._root;if(null==a)for(var b=this.dom.parentNode;b;b=b.parentNode)if(9==b.nodeType||11==b.nodeType&&
b.host)return this._root=b;return a||document};ua.prototype.posAtCoords=function(a){a=U(this,a);return this.inDOMChange&&a&&(a.pos=this.inDOMChange.mapping.map(a),-1!=a.inside&&(a.inside=this.inDOMChange.mapping.map(a.inside))),a};ua.prototype.coordsAtPos=function(a){return this.inDOMChange&&(a=this.inDOMChange.mapping.invert().map(a)),ba(this,a)};ua.prototype.domAtPos=function(a){return this.inDOMChange&&(a=this.inDOMChange.mapping.invert().map(a)),this.docView.domFromPos(a)};ua.prototype.endOfTextblock=
function(a,b){return Y(this,b||this.state,a)};ua.prototype.destroy=function(){if(this.docView){for(var a in this.domObserver.stop(),this.inDOMChange&&this.inDOMChange.destroy(),this.eventHandlers)this.dom.removeEventListener(a,this.eventHandlers[a]);!0;this.destroyPluginViews();this.selectionReader.destroy();this.mounted?(this.docView.update(this.state.doc,[],K(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom);this.docView.destroy();this.docView=null}};
ua.prototype.dispatchEvent=function(a){Ra(this,a)||!Fa[a.type]||!this.editable&&a.type in Ga||Fa[a.type](this,a)};ua.prototype.dispatch=function(a){var b=this._props.dispatchTransaction;b?b(a):this.updateState(this.state.apply(a))};Object.defineProperties(ua.prototype,eb);p.EditorView=ua;p.Decoration=va;p.DecorationSet=ia;p.__serializeForClipboard=Ua;p.__parseFromClipboard=Ia},466:function(e,p,B){function M(e,p,B){return p.altKey&&(e="Alt-"+e),p.ctrlKey&&(e="Ctrl-"+e),p.metaKey&&(e="Meta-"+e),!1!==
B&&p.shiftKey&&(e="Shift-"+e),e}function T(e){var p=function(e){var p=Object.create(null),q;for(q in e){var v,z=v=void 0,A=void 0,C=void 0,B=q.split(/-(?!$)/),y=B[B.length-1];"Space"==y&&(y=" ");for(var G=0;G<B.length-1;G++){var P=B[G];if(/^(cmd|meta|m)$/i.test(P))v=!0;else if(/^a(lt)?$/i.test(P))C=!0;else if(/^(c|ctrl|control)$/i.test(P))A=!0;else if(/^s(hift)?$/i.test(P))z=!0;else{if(!/^mod$/i.test(P))throw Error("Unrecognized modifier name: "+P);ba?v=!0:A=!0}}v=(C&&(y="Alt-"+y),A&&(y="Ctrl-"+y),
v&&(y="Meta-"+y),z&&(y="Shift-"+y),y);p[v]=e[q]}return p}(e);return function(e,x){var q,v=U(x),z=1==v.length&&" "!=v,A=p[M(v,x,!z)];return A&&A(e.state,e.dispatch,e)||z&&(x.shiftKey||x.altKey||x.metaKey)&&(q=U.base[x.keyCode])&&q!=v&&(x=p[M(q,x,!0)])&&x(e.state,e.dispatch,e)?!0:!1}}Object.defineProperty(p,"__esModule",{value:!0});var G,U=(G=B(1582))&&"object"==typeof G&&"default"in G?G.default:G,aa=B(30),ba="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);p.keymap=function(e){return new aa.Plugin({props:{handleKeyDown:T(e)}})};
p.keydownHandler=T},782:function(e,p,B){function M(d){d=Error.call(this,d);return d.__proto__=M.prototype,d}function T(){throw Error("Override me");}function G(d,e,b){d=d.resolve(e);e=b-e;for(b=d.depth;0<e&&0<b&&d.indexAfter(b)==d.node(b).childCount;)b--,e--;if(0<e)for(d=d.node(b).maybeChild(d.indexAfter(b));0<e;){if(!d||d.isLeaf)return!0;d=d.firstChild;e--}return!1}function U(d){return{type:d,attrs:null}}function aa(d,e,b){d=d.resolve(e);if(d.parent.canReplaceWith(d.index(),d.index(),b))return e;
if(0==d.parentOffset)for(e=d.depth-1;0<=e;e--){var f=d.index(e);if(d.node(e).canReplaceWith(f,f,b))return d.before(e+1);if(0<f)return null}if(d.parentOffset==d.parent.content.size)for(e=d.depth-1;0<=e;e--){f=d.indexAfter(e);if(d.node(e).canReplaceWith(f,f,b))return d.after(e+1);if(f<d.node(e).childCount)return null}}function ba(d,e,b){for(var f=[],g=0;g<d.childCount;g++){var h=d.child(g);h.content.size&&(h=h.copy(ba(h.content,e,h)));h.isInline&&(h=e(h,b,g));f.push(h)}return A.Fragment.fromArray(f)}
function z(d,e,b,f){if(void 0===b&&(b=e),void 0===f&&(f=A.Slice.empty),e==b&&!f.size)return null;var g=d.resolve(e),h=d.resolve(b);if(x(g,h,f))return new F(e,b,f);f=function(b,d){d=function W(b,d,f,e){var g=A.Fragment.empty,h=0,l=f[d];b.depth>d&&(f=W(b,d+1,f,e||l),h=f.openEnd+1,g=A.Fragment.from(b.node(d+1).copy(f.content)));l&&(g=g.append(l.content),h=l.openEnd);e&&(g=g.append(b.node(d).contentMatchAt(b.indexAfter(d)).fillBefore(A.Fragment.empty,!0)),h=0);return{content:g,openEnd:h}}(b,0,d,!1);return new A.Slice(d.content,
b.depth,d.openEnd||0)}(g,function(b,d){b=new u(b);for(var f=1;d.size&&3>=f;f++)d=b.placeSlice(d.content,d.openStart,d.openEnd,f);for(;b.open.length;)b.closeNode();return b.placed}(g,f));var p=P(g,h,f);if(!p)return null;if(f.size!=p.size&&function(b,d,f){if(!d.parent.isTextblock)return!1;var e;if(f.openEnd){b=f.content;for(var g=1;g<f.openEnd;g++)b=b.lastChild.content;b=b.lastChild}else b=b.node(b.depth-(f.openStart-f.openEnd));if(!b.isTextblock)return!1;for(g=d.index();g<d.parent.childCount;g++)if(!b.type.allowsMarks(d.parent.child(g).marks))return!1;
f.openEnd?e=b.contentMatchAt(b.childCount):(e=b.contentMatchAt(b.childCount),f.size&&(e=e.matchFragment(f.content,f.openStart?1:0)));return(e=e.matchFragment(d.parent.content,d.index()))&&e.validEnd}(g,h,f)){for(var q=h.depth,r=h.after(q);1<q&&r==h.end(--q);)++r;if(d=P(g,d.resolve(r),f))return new l(e,r,b,h.end(),d,f.size)}return p.size||e!=b?new F(e,b,p):null}function Y(d,e,b,f,h,l,p){var g=d.childCount,t=g-(0<p?1:0),q=0>l?e:b.node(h);var r=0>l?q.contentMatchAt(t):1==g&&0<p?q.contentMatchAt(l?b.index(h):
b.indexAfter(h)):q.contentMatchAt(b.indexAfter(h)).matchFragment(d,0<g&&l?1:0,t);t=f.node(h);if(0<p&&h<f.depth){var E=t.content.cutByIndex(f.indexAfter(h)).addToStart(d.lastChild);E=r.fillBefore(E,!0);if(E&&E.size&&0<l&&1==g&&(E=null),E){var v=Y(d.lastChild.content,d.lastChild,b,f,h+1,1==g?l-1:-1,p-1);if(v)return f=d.lastChild.copy(v),E.size?d.cutByIndex(0,g-1).append(E).addToEnd(f):d.replaceChild(g-1,f)}}0<p&&(r=r.matchType((1==g&&0<l?b.node(h+1):d.lastChild).type));E=f.index(h);if(E==t.childCount&&
!t.type.compatibleContent(e.type))return null;e=r.fillBefore(t.content,!0,E);for(r=E;e&&r<t.content.childCount;r++)q.type.allowsMarks(t.content.child(r).marks)||(e=null);if(!e)return null;0<p&&(b=function na(b,d,f,e,g){var h=b.content,l=h.childCount;var t=0<=g?f.node(e).contentMatchAt(f.indexAfter(e)).matchFragment(h,0<g?1:0,l):b.contentMatchAt(l);0<d&&(d=na(h.lastChild,d-1,f,e+1,1==l?g-1:-1),h=h.replaceChild(l-1,d));return b.copy(h.append(t.fillBefore(A.Fragment.empty,!0)))}(d.lastChild,p-1,b,h+
1,1==g?l-1:-1),d=d.replaceChild(g-1,b));return d=d.append(e),f.depth>h&&(d=d.addToEnd(function W(b,d){var f=b.node(d),e=f.contentMatchAt(0).fillBefore(f.content,!0,b.index(d));b.depth>d&&(e=e.addToEnd(W(b,d+1)));return f.copy(e)}(f,h+1))),d}function P(d,e,b){if(d=Y(b.content,d.node(0),d,e,0,b.openStart,b.openEnd)){b=b.openStart;for(e=e.depth;0<b&&0<e&&1==d.childCount;)d=d.firstChild.content,b--,e--;e=new A.Slice(d,b,e)}else e=null;return e}function x(d,e,b){return!b.openStart&&!b.openEnd&&d.start()==
e.start()&&d.parent.canReplace(d.index(),e.index(),b.content)}function q(d,e,b){var f=d.content;1<e&&(f=q(d.firstChild,e-1,1==d.childCount?b-1:0),f=d.content.replaceChild(0,f));b=d.type.contentMatch.fillBefore(f,0==b);return d.copy(b.append(f))}function v(d,e,b,f,h){if(e<b){var g=d.firstChild;d=d.replaceChild(0,g.copy(v(g.content,e+1,b,f,g)))}return e>f&&(d=h.contentMatchAt(0).fillBefore(d,!0).append(d)),d}function Q(d,e){for(var b=[],f=Math.min(d.depth,e.depth);0<=f;f--){var g=d.start(f);if(g<d.pos-
(d.depth-f)||e.end(f)>e.pos+(e.depth-f)||d.node(f).type.spec.isolating||e.node(f).type.spec.isolating)break;g==e.start(f)&&b.push(f)}return b}Object.defineProperty(p,"__esModule",{value:!0});var A=B(38),C=Math.pow(2,16),ja=function(d,e,b){void 0===e&&(e=!1);void 0===b&&(b=null);this.pos=d;this.deleted=e;this.recover=b},y=function(d,e){void 0===e&&(e=!1);this.ranges=d;this.inverted=e};y.prototype.recover=function(d){var e=0,b=d&65535;if(!this.inverted)for(var f=0;f<b;f++)e+=this.ranges[3*f+2]-this.ranges[3*
f+1];return this.ranges[3*b]+e+(d-(d&65535))/C};y.prototype.mapResult=function(d,e){return void 0===e&&(e=1),this._map(d,e,!1)};y.prototype.map=function(d,e){return void 0===e&&(e=1),this._map(d,e,!0)};y.prototype._map=function(d,e,b){for(var f=0,g=this.inverted?2:1,h=this.inverted?1:2,l=0;l<this.ranges.length;l+=3){var p=this.ranges[l]-(this.inverted?f:0);if(p>d)break;var q=this.ranges[l+g],r=this.ranges[l+h],v=p+q;if(d<=v)return f=p+f+(0>(q?d==p?-1:d==v?1:e:e)?0:r),b?f:new ja(f,0>e?d!=p:d!=v,l/
3+(d-p)*C);f+=r-q}return b?d+f:new ja(d+f)};y.prototype.touches=function(d,e){var b=0;e&=65535;for(var f=this.inverted?2:1,g=this.inverted?1:2,h=0;h<this.ranges.length;h+=3){var l=this.ranges[h]-(this.inverted?b:0);if(l>d)break;var p=this.ranges[h+f];if(d<=l+p&&h==3*e)return!0;b+=this.ranges[h+g]-p}return!1};y.prototype.forEach=function(d){for(var e=this.inverted?2:1,b=this.inverted?1:2,f=0,h=0;f<this.ranges.length;f+=3){var l=this.ranges[f],p=l-(this.inverted?h:0);l+=this.inverted?0:h;var q=this.ranges[f+
e],r=this.ranges[f+b];d(p,p+q,l,l+r);h+=r-q}};y.prototype.invert=function(){return new y(this.ranges,!this.inverted)};y.prototype.toString=function(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)};y.offset=function(d){return 0==d?y.empty:new y(0>d?[0,-d,0]:[0,0,d])};y.empty=new y([]);var Z=function(d,e,b,f){this.maps=d||[];this.from=b||0;this.to=null==f?this.maps.length:f;this.mirror=e};Z.prototype.slice=function(d,e){return void 0===d&&(d=0),void 0===e&&(e=this.maps.length),new Z(this.maps,
this.mirror,d,e)};Z.prototype.copy=function(){return new Z(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)};Z.prototype.appendMap=function(d,e){this.to=this.maps.push(d);null!=e&&this.setMirror(this.maps.length-1,e)};Z.prototype.appendMapping=function(d){for(var e=0,b=this.maps.length;e<d.maps.length;e++){var f=d.getMirror(e);this.appendMap(d.maps[e],null!=f&&f<e?b+f:null)}};Z.prototype.getMirror=function(d){if(this.mirror)for(var e=0;e<this.mirror.length;e++)if(this.mirror[e]==
d)return this.mirror[e+(e%2?-1:1)]};Z.prototype.setMirror=function(d,e){this.mirror||(this.mirror=[]);this.mirror.push(d,e)};Z.prototype.appendMappingInverted=function(d){for(var e=d.maps.length-1,b=this.maps.length+d.maps.length;0<=e;e--){var f=d.getMirror(e);this.appendMap(d.maps[e].invert(),null!=f&&f>e?b-f-1:null)}};Z.prototype.invert=function(){var d=new Z;return d.appendMappingInverted(this),d};Z.prototype.map=function(d,e){if(void 0===e&&(e=1),this.mirror)return this._map(d,e,!0);for(var b=
this.from;b<this.to;b++)d=this.maps[b].map(d,e);return d};Z.prototype.mapResult=function(d,e){return void 0===e&&(e=1),this._map(d,e,!1)};Z.prototype._map=function(d,e,b){for(var f=!1,g=null,h=this.from;h<this.to;h++){var l=this.maps[h],p=g&&g[h];if(null!=p&&l.touches(d,p))d=l.recover(p);else{d=l.mapResult(d,e);if(null!=d.recover&&(l=this.getMirror(h),null!=l&&l>h&&l<this.to)){if(d.deleted){h=l;d=this.maps[l].recover(d.recover);continue}(g||(g=Object.create(null)))[l]=d.recover}d.deleted&&(f=!0);
d=d.pos}}return b?d:new ja(d,f)};M.prototype=Object.create(Error.prototype);M.prototype.constructor=M;M.prototype.name="TransformError";e=function(d){this.doc=d;this.steps=[];this.docs=[];this.mapping=new Z};B={before:{},docChanged:{}};B.before.get=function(){return this.docs.length?this.docs[0]:this.doc};e.prototype.step=function(d){d=this.maybeStep(d);if(d.failed)throw new M(d.failed);return this};e.prototype.maybeStep=function(d){var e=d.apply(this.doc);return e.failed||this.addStep(d,e.doc),e};
B.docChanged.get=function(){return 0<this.steps.length};e.prototype.addStep=function(d,e){this.docs.push(this.doc);this.steps.push(d);this.mapping.appendMap(d.getMap());this.doc=e};Object.defineProperties(e.prototype,B);var O=Object.create(null);B=function(){};B.prototype.apply=function(d){return T()};B.prototype.getMap=function(){return y.empty};B.prototype.invert=function(d){return T()};B.prototype.map=function(d){return T()};B.prototype.merge=function(d){return null};B.prototype.toJSON=function(){return T()};
B.fromJSON=function(d,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");var b=O[e.stepType];if(!b)throw new RangeError("No step type "+e.stepType+" defined");return b.fromJSON(d,e)};B.jsonID=function(d,e){if(d in O)throw new RangeError("Duplicate use of step JSON ID "+d);return O[d]=e,e.prototype.jsonID=d,e};var N=function(d,e){this.doc=d;this.failed=e};N.ok=function(d){return new N(d,null)};N.fail=function(d){return new N(null,d)};N.fromReplace=function(d,e,b,f){try{return N.ok(d.replace(e,
b,f))}catch(t){if(t instanceof A.ReplaceError)return N.fail(t.message);throw t;}};var F=function(d){function e(b,f,e,g){d.call(this);this.from=b;this.to=f;this.slice=e;this.structure=!!g}return d&&(e.__proto__=d),e.prototype=Object.create(d&&d.prototype),e.prototype.constructor=e,e.prototype.apply=function(b){return this.structure&&G(b,this.from,this.to)?N.fail("Structure replace would overwrite content"):N.fromReplace(b,this.from,this.to,this.slice)},e.prototype.getMap=function(){return new y([this.from,
this.to-this.from,this.slice.size])},e.prototype.invert=function(b){return new e(this.from,this.from+this.slice.size,b.slice(this.from,this.to))},e.prototype.map=function(b){var d=b.mapResult(this.from,1);b=b.mapResult(this.to,-1);return d.deleted&&b.deleted?null:new e(d.pos,Math.max(d.pos,b.pos),this.slice)},e.prototype.merge=function(b){if(!(b instanceof e)||b.structure!=this.structure)return null;if(this.from+this.slice.size!=b.from||this.slice.openEnd||b.slice.openStart){if(b.to!=this.from||this.slice.openStart||
b.slice.openEnd)return null;var d=0==this.slice.size+b.slice.size?A.Slice.empty:new A.Slice(b.slice.content.append(this.slice.content),b.slice.openStart,this.slice.openEnd);return new e(b.from,this.to,d,this.structure)}d=0==this.slice.size+b.slice.size?A.Slice.empty:new A.Slice(this.slice.content.append(b.slice.content),this.slice.openStart,b.slice.openEnd);return new e(this.from,this.to+(b.to-b.from),d,this.structure)},e.prototype.toJSON=function(){var b={stepType:"replace",from:this.from,to:this.to};
return this.slice.size&&(b.slice=this.slice.toJSON()),this.structure&&(b.structure=!0),b},e.fromJSON=function(b,d){if("number"!=typeof d.from||"number"!=typeof d.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new e(d.from,d.to,A.Slice.fromJSON(b,d.slice),!!d.structure)},e}(B);B.jsonID("replace",F);var l=function(d){function e(b,f,e,g,h,l,p){d.call(this);this.from=b;this.to=f;this.gapFrom=e;this.gapTo=g;this.slice=h;this.insert=l;this.structure=!!p}return d&&(e.__proto__=
d),e.prototype=Object.create(d&&d.prototype),e.prototype.constructor=e,e.prototype.apply=function(b){if(this.structure&&(G(b,this.from,this.gapFrom)||G(b,this.gapTo,this.to)))return N.fail("Structure gap-replace would overwrite content");var d=b.slice(this.gapFrom,this.gapTo);return d.openStart||d.openEnd?N.fail("Gap is not a flat range"):(d=this.slice.insertAt(this.insert,d.content))?N.fromReplace(b,this.from,this.to,d):N.fail("Content does not fit in gap")},e.prototype.getMap=function(){return new y([this.from,
this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])},e.prototype.invert=function(b){var d=this.gapTo-this.gapFrom;return new e(this.from,this.from+this.slice.size+d,this.from+this.insert,this.from+this.insert+d,b.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)},e.prototype.map=function(b){var d=b.mapResult(this.from,1),g=b.mapResult(this.to,-1),h=b.map(this.gapFrom,-1);b=b.map(this.gapTo,
1);return d.deleted&&g.deleted||h<d.pos||b>g.pos?null:new e(d.pos,g.pos,h,b,this.slice,this.insert,this.structure)},e.prototype.toJSON=function(){var b={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(b.slice=this.slice.toJSON()),this.structure&&(b.structure=!0),b},e.fromJSON=function(b,d){if("number"!=typeof d.from||"number"!=typeof d.to||"number"!=typeof d.gapFrom||"number"!=typeof d.gapTo||"number"!=typeof d.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");
return new e(d.from,d.to,d.gapFrom,d.gapTo,A.Slice.fromJSON(b,d.slice),d.insert,!!d.structure)},e}(B);B.jsonID("replaceAround",l);e.prototype.lift=function(d,e){var b=d.$from,f=d.$to,g=d.depth;d=b.before(g+1);for(var h=f.after(g+1),p=d,q=h,r=A.Fragment.empty,v=0,u=g,x=!1;u>e;u--)x||0<b.index(u)?(x=!0,r=A.Fragment.from(b.node(u).copy(r)),v++):p--;b=A.Fragment.empty;u=0;for(x=!1;g>e;g--)x||f.after(g+1)<f.end(g)?(x=!0,b=A.Fragment.from(f.node(g).copy(b)),u++):q++;return this.step(new l(p,q,d,h,new A.Slice(r.append(b),
v,u),r.size-v,!0))};e.prototype.wrap=function(d,e){for(var b=A.Fragment.empty,f=e.length-1;0<=f;f--)b=A.Fragment.from(e[f].type.create(e[f].attrs,b));f=d.start;d=d.end;return this.step(new l(f,d,f,d,new A.Slice(b,0,0),e.length,!0))};e.prototype.setBlockType=function(d,e,b,f){var g=this;if(void 0===e&&(e=d),!b.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var h=this.steps.length;return this.doc.nodesBetween(d,e,function(d,e){var p;if(p=d.isTextblock&&!d.hasMarkup(b,
f)){p=g.mapping.slice(h).map(e);p=g.doc.resolve(p);var t=p.index();p=p.parent.canReplaceWith(t,t+1,b)}if(p)return g.clearIncompatible(g.mapping.slice(h).map(e,1),b),t=g.mapping.slice(h),p=t.map(e,1),e=t.map(e+d.nodeSize,1),g.step(new l(p,e,p+1,e-1,new A.Slice(A.Fragment.from(b.create(f,null,d.marks)),0,0),1,!0)),!1}),this};e.prototype.setNodeMarkup=function(d,e,b,f){var g=this.doc.nodeAt(d);if(!g)throw new RangeError("No node at given position");e||(e=g.type);b=e.create(b,null,f||g.marks);if(g.isLeaf)return this.replaceWith(d,
d+g.nodeSize,b);if(!e.validContent(g.content))throw new RangeError("Invalid content for node type "+e.name);return this.step(new l(d,d+g.nodeSize,d+1,d+g.nodeSize-1,new A.Slice(A.Fragment.from(b),0,0),1,!0))};e.prototype.split=function(d,e,b){void 0===e&&(e=1);for(var f=this.doc.resolve(d),g=A.Fragment.empty,h=A.Fragment.empty,l=f.depth,p=f.depth-e,q=e-1;l>p;l--,q--){g=A.Fragment.from(f.node(l).copy(g));var r=b&&b[q];h=A.Fragment.from(r?r.type.create(r.attrs,h):f.node(l).copy(h))}return this.step(new F(d,
d,new A.Slice(g.append(h),e,e,!0)))};e.prototype.join=function(d,e){void 0===e&&(e=1);d=new F(d-e,d+e,A.Slice.empty,!0);return this.step(d)};var h=function(d){function e(b,e,g){d.call(this);this.from=b;this.to=e;this.mark=g}return d&&(e.__proto__=d),e.prototype=Object.create(d&&d.prototype),e.prototype.constructor=e,e.prototype.apply=function(b){var d=this,e=b.slice(this.from,this.to),g=b.resolve(this.from);g=g.node(g.sharedDepth(this.to));e=new A.Slice(ba(e.content,function(b,e){return e.type.allowsMarkType(d.mark.type)?
b.mark(d.mark.addToSet(b.marks)):b},g),e.openStart,e.openEnd);return N.fromReplace(b,this.from,this.to,e)},e.prototype.invert=function(){return new r(this.from,this.to,this.mark)},e.prototype.map=function(b){var d=b.mapResult(this.from,1);b=b.mapResult(this.to,-1);return d.deleted&&b.deleted||d.pos>=b.pos?null:new e(d.pos,b.pos,this.mark)},e.prototype.merge=function(b){if(b instanceof e&&b.mark.eq(this.mark)&&this.from<=b.to&&this.to>=b.from)return new e(Math.min(this.from,b.from),Math.max(this.to,
b.to),this.mark)},e.prototype.toJSON=function(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},e.fromJSON=function(b,d){if("number"!=typeof d.from||"number"!=typeof d.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new e(d.from,d.to,b.markFromJSON(d.mark))},e}(B);B.jsonID("addMark",h);var r=function(d){function e(b,e,g){d.call(this);this.from=b;this.to=e;this.mark=g}return d&&(e.__proto__=d),e.prototype=Object.create(d&&d.prototype),e.prototype.constructor=
e,e.prototype.apply=function(b){var d=this,e=b.slice(this.from,this.to);e=new A.Slice(ba(e.content,function(b){return b.mark(d.mark.removeFromSet(b.marks))}),e.openStart,e.openEnd);return N.fromReplace(b,this.from,this.to,e)},e.prototype.invert=function(){return new h(this.from,this.to,this.mark)},e.prototype.map=function(b){var d=b.mapResult(this.from,1);b=b.mapResult(this.to,-1);return d.deleted&&b.deleted||d.pos>=b.pos?null:new e(d.pos,b.pos,this.mark)},e.prototype.merge=function(b){if(b instanceof
e&&b.mark.eq(this.mark)&&this.from<=b.to&&this.to>=b.from)return new e(Math.min(this.from,b.from),Math.max(this.to,b.to),this.mark)},e.prototype.toJSON=function(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},e.fromJSON=function(b,d){if("number"!=typeof d.from||"number"!=typeof d.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new e(d.from,d.to,b.markFromJSON(d.mark))},e}(B);B.jsonID("removeMark",r);e.prototype.addMark=function(d,e,b){var f=
this,g=[],l=[],p=null,q=null;return this.doc.nodesBetween(d,e,function(f,t,v){if(f.isInline){var u=f.marks;if(!b.isInSet(u)&&v.type.allowsMarkType(b.type)){v=Math.max(t,d);f=Math.min(t+f.nodeSize,e);t=b.addToSet(u);for(var x=0;x<u.length;x++)u[x].isInSet(t)||(p&&p.to==v&&p.mark.eq(u[x])?p.to=f:g.push(p=new r(v,f,u[x])));q&&q.to==v?q.to=f:l.push(q=new h(v,f,b))}}}),g.forEach(function(b){return f.step(b)}),l.forEach(function(b){return f.step(b)}),this};e.prototype.removeMark=function(d,e,b){var f=this;
void 0===b&&(b=null);var g=[],h=0;return this.doc.nodesBetween(d,e,function(f,l){if(f.isInline){h++;var p=null;if(b instanceof A.MarkType){var t=b.isInSet(f.marks);t&&(p=[t])}else b?b.isInSet(f.marks)&&(p=[b]):p=f.marks;if(p&&p.length)for(f=Math.min(l+f.nodeSize,e),t=0;t<p.length;t++){for(var q=p[t],r=void 0,v=0;v<g.length;v++){var u=g[v];u.step==h-1&&q.eq(g[v].style)&&(r=u)}r?(r.to=f,r.step=h):g.push({style:q,from:Math.max(l,d),to:f,step:h})}}}),g.forEach(function(b){return f.step(new r(b.from,b.to,
b.style))}),this};e.prototype.clearIncompatible=function(d,e,b){void 0===b&&(b=e.contentMatch);var f=this.doc.nodeAt(d),g=[];d+=1;for(var h=0;h<f.childCount;h++){var l=f.child(h),p=d+l.nodeSize,q=b.matchType(l.type,l.attrs);if(q)for(b=q,q=0;q<l.marks.length;q++)e.allowsMarkType(l.marks[q].type)||this.step(new r(d,p,l.marks[q]));else g.push(new F(d,p,A.Slice.empty));d=p}b.validEnd||(e=b.fillBefore(A.Fragment.empty,!0),this.replace(d,d,new A.Slice(e,0,0)));for(e=g.length-1;0<=e;e--)this.step(g[e]);
return this};e.prototype.replace=function(d,e,b){void 0===e&&(e=d);void 0===b&&(b=A.Slice.empty);d=z(this.doc,d,e,b);return d&&this.step(d),this};e.prototype.replaceWith=function(d,e,b){return this.replace(d,e,new A.Slice(A.Fragment.from(b),0,0))};e.prototype.delete=function(d,e){return this.replace(d,e,A.Slice.empty)};e.prototype.insert=function(d,e){return this.replaceWith(d,d,e)};var u=function(d){this.open=[];for(var e=0;e<=d.depth;e++){var b=d.node(e),f=b.contentMatchAt(d.indexAfter(e));this.open.push({parent:b,
match:f,content:A.Fragment.empty,wrapper:!1,openEnd:0,depth:e})}this.placed=[]};u.prototype.placeSlice=function(d,e,b,f,h){if(0<e){var g=d.firstChild,l=this.placeSlice(g.content,Math.max(0,e-1),b&&1==d.childCount?b-1:0,f,g);l.content!=g.content&&(l.content.size?(d=d.replaceChild(0,g.copy(l.content)),e=l.openStart+1):(1==d.childCount&&(b=0),d=d.cutByIndex(1),e=0))}d=this.placeContent(d,e,b,f,h);if(2<f&&d.size&&0==e){for(e=0;e<d.content.childCount;e++)h=d.content.child(e),this.placeContent(h.content,
0,b&&e==d.content.childCount.length-1?b-1:0,f,h);d=A.Fragment.empty}return d};u.prototype.placeContent=function(d,e,b,f,h){for(var g=0;g<d.childCount;g++){for(var l=d.child(g),p=!1,t=g==d.childCount-1,r=this.open.length-1;0<=r;r--){var v=this.open[r],u=void 0;if(1<f&&(u=v.match.findWrapping(l.type))&&(!h||!u.length||u[u.length-1]!=h.type)){for(;this.open.length-1>r;)this.closeNode();for(var x=0;x<u.length;x++)v.match=v.match.matchType(u[x]),r++,v={parent:u[x].create(),match:u[x].contentMatch,content:A.Fragment.empty,
wrapper:!0,openEnd:0,depth:r+x},this.open.push(v)}x=v.match.matchType(l.type);if(!x){u=v.match.fillBefore(A.Fragment.from(l));if(!u){if(h&&v.match.matchType(h.type))break;continue}for(p=0;p<u.childCount;p++)x=u.child(p),this.addNode(v,x,0),x=v.match.matchFragment(x)}for(;this.open.length-1>r;)this.closeNode();l=l.mark(v.parent.type.allowedMarks(l.marks));e&&(l=q(l,e,t?b:0),e=0);this.addNode(v,l,t?b:0);v.match=x;t&&(b=0);p=!0;break}if(!p)break}return 1<this.open.length&&(0<g&&g==d.childCount||h&&this.open[this.open.length-
1].parent.type==h.type)&&this.closeNode(),new A.Slice(d.cutByIndex(g),e,b)};u.prototype.addNode=function(d,e,b){var f,g;d.content=(f=d.content,g=d.openEnd,g?f.replaceChild(f.childCount-1,function la(b,d){var e=b.content;1<d&&(e=la(b.lastChild,d-1),e=b.content.replaceChild(b.childCount-1,e));d=b.contentMatchAt(b.childCount).fillBefore(A.Fragment.empty,!0);return b.copy(e.append(d))}(f.lastChild,g)):f).addToEnd(e);d.openEnd=b};u.prototype.closeNode=function(){var d=this.open.pop();0==d.content.size||
(d.wrapper?this.addNode(this.open[this.open.length-1],d.parent.copy(d.content),d.openEnd+1):this.placed[d.depth]={depth:d.depth,content:d.content,openEnd:d.openEnd})};e.prototype.replaceRange=function(d,e,b){if(!b.size)return this.deleteRange(d,e);var f=this.doc.resolve(d),g=this.doc.resolve(e);if(x(f,g,b))return this.step(new F(d,e,b));var h=Q(f,this.doc.resolve(e));0==h[h.length-1]&&h.pop();var l=-(f.depth+1);h.unshift(l);for(var p=f.depth,q=f.pos-1;0<p;p--,q--){var r=f.node(p).type.spec;if(r.defining||
r.isolating)break;-1<h.indexOf(p)?l=p:f.before(p)==q&&h.splice(1,0,-p)}l=h.indexOf(l);p=[];q=b.openStart;var u=b.content;for(r=0;;r++){u=u.firstChild;if(p.push(u),r==b.openStart)break;u=u.content}0<q&&p[q-1].type.spec.defining&&f.node(l).type!=p[q-1].type?--q:2<=q&&p[q-1].isTextblock&&p[q-2].type.spec.defining&&f.node(l).type!=p[q-2].type&&(q-=2);for(r=b.openStart;0<=r;r--){u=(r+q+1)%(b.openStart+1);var y=p[u];if(y)for(var C=0;C<h.length;C++){var z=h[(C+l)%h.length],B=!0;0>z&&(B=!1,z=-z);var G=f.node(z-
1),P=f.index(z-1);if(G.canReplaceWith(P,P,y.type,y.marks))return this.replace(f.before(z),B?g.after(z):e,new A.Slice(v(b.content,0,b.openStart,u),u,b.openEnd))}}return this.replace(d,e,b)};e.prototype.replaceRangeWith=function(d,e,b){if(!b.isInline&&d==e&&this.doc.resolve(d).parent.content.size){var f=aa(this.doc,d,b.type);null!=f&&(d=e=f)}return this.replaceRange(d,e,new A.Slice(A.Fragment.from(b),0,0))};e.prototype.deleteRange=function(d,e){for(var b=this.doc.resolve(d),f=this.doc.resolve(e),g=
Q(b,f),h=0;h<g.length;h++){var l=g[h],p=h==g.length-1;if(p&&0==l||b.node(l).type.contentMatch.validEnd)return this.delete(b.start(l),f.end(l));if(0<l&&(p||b.node(l-1).canReplace(b.index(l-1),f.indexAfter(l-1))))return this.delete(b.before(l),f.after(l))}for(f=1;f<=b.depth;f++)if(d-b.start(f)==b.depth-f&&e>b.end(f))return this.delete(b.before(f),e);return this.delete(d,e)};p.Transform=e;p.TransformError=M;p.Step=B;p.StepResult=N;p.joinPoint=function(d,e,b){void 0===b&&(b=-1);d=d.resolve(e);for(var f=
d.depth;;f--){var g=void 0,h=void 0;if(f==d.depth?(g=d.nodeBefore,h=d.nodeAfter):0<b?(g=d.node(f+1),h=d.node(f).maybeChild(d.index(f)+1)):(g=d.node(f).maybeChild(d.index(f)-1),h=d.node(f+1)),g&&!g.isTextblock&&g&&h&&!g.isLeaf&&g.canAppend(h))return e;if(0==f)break;e=0>b?d.before(f):d.after(f)}};p.canJoin=function(d,e){d=d.resolve(e);e=d.index();var b=d.nodeBefore,f=d.nodeAfter;return b&&f&&!b.isLeaf&&b.canAppend(f)&&d.parent.canReplace(e,e+1)};p.canSplit=function(d,e,b,f){void 0===b&&(b=1);d=d.resolve(e);
e=d.depth-b;var g=f&&f[f.length-1]||d.parent;if(0>e||d.parent.type.spec.isolating||!d.parent.canReplace(d.index(),d.parent.childCount)||!g.type.validContent(d.parent.content.cutByIndex(d.index(),d.parent.childCount)))return!1;g=d.depth-1;for(b-=2;g>e;g--,b--){var h=d.node(g),l=d.index(g);if(h.type.spec.isolating)return!1;var p=h.content.cutByIndex(l,h.childCount),q=f&&f[b]||h;if(q!=h&&(p=p.replaceChild(0,q.type.create(q.attrs))),!h.canReplace(l+1,h.childCount)||!q.type.validContent(p))return!1}g=
d.indexAfter(e);f=f&&f[0];return d.node(e).canReplaceWith(g,g,f?f.type:d.node(e+1).type)};p.insertPoint=aa;p.dropPoint=function(d,e,b){d=d.resolve(e);if(!b.content.size)return e;e=b.content;for(var f=0;f<b.openStart;f++)e=e.firstChild.content;for(f=1;f<=(0==b.openStart&&b.size?2:1);f++)for(var g=d.depth;0<=g;g--){var h=g==d.depth?0:d.pos<=(d.start(g+1)+d.end(g+1))/2?-1:1,l=d.index(g)+(0<h?1:0);if(1==f?d.node(g).canReplace(l,l,e):d.node(g).contentMatchAt(l).findWrapping(e.firstChild.type))return 0==
h?d.pos:0>h?d.before(g+1):d.after(g+1)}return null};p.liftTarget=function(d){for(var e=d.parent.content.cutByIndex(d.startIndex,d.endIndex),b=d.depth;;--b){var f=d.$from.node(b),h=d.$from.index(b),l=d.$to.indexAfter(b);if(b<d.depth&&f.canReplace(h,l,e))return b;var p;(p=0==b||f.type.spec.isolating)||(p=!((0==h||f.canReplace(h,f.childCount))&&(l==f.childCount||f.canReplace(0,l))));if(p)break}};p.findWrapping=function(d,e,b,f){void 0===f&&(f=d);return(f=(d=function(b,d){var e=b.parent,f=b.startIndex;
b=b.endIndex;var g=e.contentMatchAt(f).findWrapping(d);return g?e.canReplaceWith(f,b,g.length?g[0]:d)?g:null:null}(d,e))&&function(b,d){var e=b.parent,f=b.startIndex;b=b.endIndex;var g=e.child(f);g=d.contentMatch.findWrapping(g.type);if(!g)return null;for(d=(g.length?g[g.length-1]:d).contentMatch;d&&f<b;f++)d=d.matchType(e.child(f).type);return d&&d.validEnd?g:null}(f,e))?d.map(U).concat({type:e,attrs:b}).concat(f.map(U)):null};p.StepMap=y;p.MapResult=ja;p.Mapping=Z;p.AddMarkStep=h;p.RemoveMarkStep=
r;p.ReplaceStep=F;p.ReplaceAroundStep=l;p.replaceStep=z},783:function(e,p,B){Object.defineProperty(p,"__esModule",{value:!0});var M=B(30),T=B(119),G=function(e,p){this.match=e;this.handler="string"==typeof p?function(e,v,x,A){var q=p;if(v[1]){var z=v[0].lastIndexOf(v[1]);q+=v[0].slice(z+v[1].length);var y=(x+=z)-A;0<y&&(q=v[0].slice(z-y,z)+q,x=A)}v=e.doc.resolve(x).marks();return e.tr.replaceWith(x,A,e.schema.text(q,v))}:p};e=new G(/--$/,"\u2014");B=new G(/\.\.\.$/,"\u2026");var U=new G(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,
"\u201c"),aa=new G(/"$/,"\u201d"),ba=new G(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"\u2018"),z=new G(/'$/,"\u2019"),Y=[U,aa,ba,z];p.InputRule=G;p.inputRules=function(e){var p=e.rules;return new M.Plugin({state:{init:function(){return null},apply:function(e,p){return e.getMeta(this)||(e.selectionSet||e.docChanged?null:p)}},props:{handleTextInput:function(e,v,x,A){var q=e.state,z=q.doc.resolve(v);if(z.parent.type.spec.code)return!1;z=z.parent.textBetween(Math.max(0,z.parentOffset-500),z.parentOffset,
null,"\ufffc")+A;for(var y=0;y<p.length;y++){var B=p[y].match.exec(z);if(B=B&&p[y].handler(q,B,v-(B[0].length-A.length),x))return e.dispatch(B.setMeta(this,{transform:B,from:v,to:x,text:A})),!0}return!1}},isInputRules:!0})};p.undoInputRule=function(e,p){for(var q=e.plugins,v=0;v<q.length;v++){var x=q[v],A=void 0;if(x.spec.isInputRules&&(A=x.getState(e))){if(p){q=e.tr;v=A.transform;for(x=v.steps.length-1;0<=x;x--)q.step(v.steps[x].invert(v.docs[x]));v=q.doc.resolve(A.from).marks();p(q.replaceWith(A.from,
A.to,e.schema.text(A.text,v)))}return!0}}return!1};p.emDash=e;p.ellipsis=B;p.openDoubleQuote=U;p.closeDoubleQuote=aa;p.openSingleQuote=ba;p.closeSingleQuote=z;p.smartQuotes=Y;p.wrappingInputRule=function(e,p,q,v){return new G(e,function(e,x,z,B){var y=q instanceof Function?q(x):q;e=e.tr.delete(z,B);y=(B=e.doc.resolve(z).blockRange())&&T.findWrapping(B,p,y);if(!y)return null;e.wrap(B,y);y=e.doc.resolve(z-1).nodeBefore;return y&&y.type==p&&T.canJoin(e.doc,z-1)&&(!v||v(x,y))&&e.join(z-1),e})};p.textblockTypeInputRule=
function(e,p,q){return new G(e,function(e,x,z,B){var v=e.doc.resolve(z);x=q instanceof Function?q(x):q;return v.node(-1).canReplaceWith(v.index(-1),v.indexAfter(-1),p)?e.tr.delete(z,B).setBlockType(z,z,p,x):null})}}}]);
