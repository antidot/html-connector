/*
 File: prosemirror-comments.js */
(window.webpackJsonp=window.webpackJsonp||[]).push([[206],{1909:function(f,c,b){function e(d){return d&&d.__esModule?d:{default:d}}function l(d,g){var b=g.id;if(d[b])return d[b];b={keymapping:{"Mod-Enter":function(){if(form)g.retrieve("commentManager").submit();else{var d=g.getElementsByClassName("commentEditDiv")[0],a=d.get("data-submit-button");d.getElementsByClassName(a)[0].click()}}},clearErrors:function(){var d=g.retrieve("FormManager:formManager");d&&d.clearIfError(g)}};var c=g.dataset.text;
c&&(b.doc=JSON.parse(c));d=function(d,b,g){var c=g.keymapping,e=g.clearErrors,k=g.doc;g=b.id;var f=JSON.parse(b.dataset.wikitags),l=(0,q.default)(n.standard_schema.schema,f);f=new h.default;var m=[f.handleKeyDown.bind(f)],p=[];e&&(m.unshift(e),e=new a.Plugin({props:{onBlur:function(d,a){return window.formManager.clearIfError(b),!0}}}),p.push(e));e=new r.default(m);p.push(e);c=(0,t.default)(b,l,c,p,k);k=new u.ProseMirrorEditorHandle(c,b,f);return c.dom.addClass("js-user-mention"),c.dom.addClass("js-comment-content"),
c.dom.dataset.editorId=g,d[g]=k,k}(d,g,b);return m.activateOnEditor(d),d}var a=b(30),n=b(95),h=e(b(240)),t=e(b(120)),r=e(b(526)),q=e(b(183)),u=b(241),m=function(d){if(d&&d.__esModule)return d;var a={};if(null!=d)for(var b in d)Object.prototype.hasOwnProperty.call(d,b)&&(a[b]=d[b]);return a.default=d,a}(b(527)),k={};f=Array.prototype.slice.call(document.querySelectorAll(".add-comment-form .prosemirror.eagerload"));c=Array.prototype.slice.call(document.querySelectorAll(".commentEditDiv .prosemirror.eagerload"));
f=f.concat(c).map(l.bind(null,k)).filter(function(d){return d.el.classList.contains("js-user-mention-editor")});initTextComplete(f.map(function(d){return d.editable}));window.editorMapping=k;window.prosemirrorComments={getOrCreateEditor:function(d){var a=d.id;if(k[a])return k[a];d=l(k,d);return d.el.classList.contains("js-user-mention-editor")&&initTextComplete(d.editable),d}}},526:function(f,c,b){Object.defineProperty(c,"__esModule",{value:!0});var e=b(30);c.default=function(b){return new e.Plugin({props:{handleKeyDown:function(){for(var a=
arguments.length,c=Array(a),h=0;h<a;h++)c[h]=arguments[h];return b.reduce(function(a,b){return a||b.apply(null,c)},!1)}}})}},527:function(f,c,b){function e(a,b){var c=function(a){var b=parseInt(a.getProperty("data-minimum"),10);a=parseInt(a.get("text"),10);return[b,a]}(a);c=l(c,2);var e=c[0],f=c[1];return function(c){c=b().replace(/\r\n?/,"\n").length;var h=f-c;h==f?(a.set("text",h),a.hide()):c<e?(a.set("text",_js("%1 too short",e-c)),a[0>c-e?"addClass":"removeClass"]("maxCharLength"),a.show()):0>
h?(a.set("text",_js("%1 too long",Math.abs(h))),a[0>h?"addClass":"removeClass"]("maxCharLength"),a.show()):(a.set("text",h),a[0>h?"addClass":"removeClass"]("maxCharLength"),a.show())}}Object.defineProperty(c,"__esModule",{value:!0});var l=function(){return function(a,b){if(Array.isArray(a))return a;if(Symbol.iterator in Object(a)){var c=[],e=!0,f=!1,l=void 0;try{for(var n,m=a[Symbol.iterator]();!(e=(n=m.next()).done)&&(c.push(n.value),!b||c.length!==b);e=!0);}catch(k){f=!0,l=k}finally{try{!e&&m.return&&
m.return()}finally{if(f)throw l;}}return c}throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();c.activateOnEditor=function(a){var b=a.el.getParent("form");if(b&&b.getElements(".maxCharacters")){var c=b.getElements(".maxCharacters").find(function(b){return b.getProperty("data-textarea-id")===a.el.id});c.hide();a.editable.addEvents({keyup:e(c,function(){return a.text}),focus:function(){a.editable.fireEvent("keyup");c.show()},blur:function(){c.hide()}})}}}},[[1909,0,1,2]]]);
